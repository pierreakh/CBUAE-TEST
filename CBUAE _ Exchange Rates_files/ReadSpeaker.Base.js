/*
2012 ReadSpeaker International B.v.
*/
ReadSpeaker.Common.Settings=function(){var a={form:{key:"data-rsform-key",prev:"data-rsform-prev",valyes:"data-rsform-trueval",valno:"data-rsform-falseval"}},b={},g=function(h){return rspkr.Common.cookie.readKey(rspkr.pub.Config.item("general.cookieName"),h)||rspkr.pub.Config.item("settings."+h)},m=function(h,a){var b=g(h);if(a!=b){var c=rspkr.c.cookie.updateKey(rspkr.cfg.item("general.cookieName"),h,a);rspkr.cfg.item("settings."+h,a);rspkr.devt("onSettingsChanged",window,[h,a,b]);return c}return null},
n={controls:{xp:function(h){return rspkr.st.r().expandPhrase(h)},helpButton:'<img src="'+rspkr.baseUrl+'img/help.png" alt="" border="0" />',select:function(h,l,b,c){var e=[],k="hl"!==h?!1:rspkr.cfg.isSentOnly&&rspkr.cfg.isSentOnly(rspkr.c.data.params.lang);e.push('<label for="',c,'">',this.xp(l.phrase),"</label>");e.push('<select id="',c,'" name="',c,'" ',a.form.prev,'="',b,'" ',a.form.key,'="',h,'">');for(var p=0,g=l.options.length;p<g;p++)if("hl"!==h||!k||/\bsent|none/i.test(l.options[p].value))"hl"===
h&&k&&"sent"===l.options[p].value&&"none"!==b&&(b="sent"),e.push('<option value="',l.options[p].value,'"',b==l.options[p].value?' selected="selected"':"",l.options[p].dims?' data-rsform-dims="'+l.options[p].dims.join(",")+'"':"",l.options[p].hides?' data-rsform-hides="'+l.options[p].hides.join(",")+'"':"",">",this.xp(l.options[p].phrase),"</option>");e.push("</select>");l.info&&(e.push('<button type="button" id="rstoggle_',c,'" class="rsform-info-toggle" data-rsform-toggles="rscontainer_',c,'" title="',
this.xp("ph_help"),": ",this.xp(l.phrase),'">'+this.helpButton+"</button>"),rspkr.cfg.item("custom.disablerlm")&&e.push("&rlm;"),e.push('<div id="rscontainer_',c,'" class="rsform-info-container" aria-live="polite">',this.xp(l.info),"</div>"),rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.info,context:rspkr.st.r().handlers,params:[c]}));rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.select,context:rspkr.st.r().handlers,params:[c]});return e.join("")},checkbox:function(h,l,b,c){var e=
b==l.options.truevalue;rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.checkbox,context:rspkr.st.r().handlers,params:[c]});return['<label for="'+c+'">',this.xp(l.phrase),'</label><input type="checkbox" id="',c,'" name="',c,'"',e?' checked="checked"':"",a.form.valyes,'="',l.options.truevalue,'" ',a.form.valno,'="',l.options.falsevalue,'" ',a.form.prev,'="',b,'" ',a.form.key,'="',h,'" />'].join("")},radio:function(h,l,b,c){var e=[];e.push('<fieldset class="rsform-radio-label" aria-level="2">');
e.push("<legend>",this.xp(l.phrase));l.info&&(e.push('<button id="rstoggle_',c,'" type="button" class="rsform-info-toggle" data-rsform-toggles="rscontainer_',c,'" title="',this.xp("ph_help"),": ",this.xp(l.phrase),'">'+this.helpButton+"</button>"),rspkr.cfg.item("custom.disablerlm")&&e.push("&rlm;"));e.push("</legend>");for(var k=0,p=l.options.length;k<p;k++)e.push('<input type="radio" id="',c,"_",k,'" name="',c,'" title="',this.xp(l.phrase),": ",this.xp(l.options[k].phrase),'" value="',l.options[k].value,
'"'),e.push(" ",a.form.prev,'="',b,'" ',a.form.key,'="',h,'"'),e.push(b==l.options[k].value?' checked="checked"':""),l.options[k].dims&&e.push(' data-rsform-dims="',l.options[k].dims.join(","),'"'),e.push(" />"),rspkr.cfg.item("custom.disablerlm")&&e.push("&lrm;"),e.push('<label for="',c,"_",k,'">',this.xp(l.options[k].phrase),"</label>");l.info&&(e.push('<div id="rscontainer_',c,'" class="rsform-info-container" aria-live="polite">',this.xp(l.info),"</div>"),rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.info,
context:rspkr.st.r().handlers,params:[c]}));e.push("</fieldset>");rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.radio,context:rspkr.st.r().handlers,params:[c,k]});return e.join("")},info:function(h,a){return['<div class="rsform-infotext">',this.xp(a.phrase),"</div>"].join("")},slider_h:function(h,l,f,c){rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.slider_h,context:rspkr.st.r().handlers,params:[l,c,f]});b[c]=l;return['<span class="rsform-slider-label">',this.xp(l.phrase),'</span><div id="',
c,'" class="rsform-slider rsimg" ',a.form.key,'="',h,'" ',a.form.prev,'="',f,'"></div>'].join("")},colorpicker:function(h,l,b,c){var e=[];e.push('<fieldset class="rsform-colorlist-label" aria-level="2">');e.push("<legend>",this.xp(l.phrase));l.info&&(e.push('<button type="button" id="rstoggle_',c,'" class="rsform-info-toggle" data-rsform-toggles="rscontainer_',c,'" title="',this.xp("ph_help"),": ",this.xp(l.phrase),'">'+this.helpButton+"</button>"),rspkr.cfg.item("custom.disablerlm")&&e.push("&rlm;"));
e.push("</legend>");e.push('<ul id="',c,'" class="rsform-colorlist" ',a.form.prev,'="',b,'" ',a.form.key,'="',h,'">');h=0;for(var k=l.options.length;h<k;h++){e.push("<li",b==l.options[h].value?' class="rsform-colorlist-active"':"",">");e.push('<a href="javascript: void(0);"');e.push(b==l.options[h].value?' tabIndex="0"':' tabIndex="-1"');e.push(' title="'+this.xp(l.phrase)+": "+this.xp(l.options[h].phrase)+'"');e.push(' data-rsform-value="',l.options[h].value,'"');if("underline"==l.options[h].value||
"none"==l.options[h].value)e.push(' class="'),"underline"==l.options[h].value&&e.push("rsform-colorlist-style-underline "),"none"==l.options[h].value&&e.push("rsform-colorlist-style-none "),e.push('"');e.push(' role="button"');e.push('><span class="rsform-colorlist-box"');"#"==l.options[h].value.substr(0,1)&&e.push(' style="background: ',l.options[h].value,';"');e.push("></span>");e.push('<span class="rsform-colorlist-label');"underline"==l.options[h].value?e.push('" style="text-decoration: underline;'):
/#/.test(l.options[h].value)&&e.push(" rsform-colorlist-style-color");e.push('">',this.xp(l.options[h].phrase),"</span></a>");e.push("</li>")}e.push("</ul>");e.push('<div style="clear: both;"></div>');l.info&&(e.push('<div id="rscontainer_',c,'" class="rsform-info-container" aria-live="polite">',this.xp(l.info),"</div>"),rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.info,context:rspkr.st.r().handlers,params:[c]}));e.push("</fieldset>");rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.colorpicker,
context:rspkr.st.r().handlers,params:[c]});return e.join("")},restore:function(h,a,b,c){rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.restore,context:rspkr.st.r().handlers,params:[c]});return["<div>",this.xp(a.phrase),'</div><input type="button" id="',c,'" value="',this.xp("ph_"+h),'" class="rsform-button" role="button"></input>'].join("")},infobox:function(h,a,b,c){h=[];h.push('<label for="',c,'">',this.xp(a.phrase),"</label>");a.info&&(h.push('<button type="button" id="rstoggle_',c,'" class="rsform-info-toggle" data-rsform-toggles="rscontainer_',
c,'" title="',this.xp("ph_help"),": ",this.xp(a.phrase),'">'+this.helpButton+"</button>"),h.push('<div id="rscontainer_',c,'" class="rsform-info-container" aria-live="polite">',this.xp(a.info),"</div>"),rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.info,context:rspkr.st.r().handlers,params:[c]}));return h.join("")}},handlers:{info:function(h){$rs.regEvent($rs.get("#rstoggle_"+h),"click",this.changed.info)},select:function(h){$rs.regEvent($rs.get("#"+h),"change",this.changed.select)},checkbox:function(h){$rs.regEvent($rs.get("#"+
h),"click",this.changed.checkbox)},radio:function(h,a){for(var b=0;b<a;b++)$rs.regEvent($rs.get("#"+h+"_"+b),"click",this.changed.radio)},slider_h:function(a,l,b){var c=new ReadSpeaker.ui.Slider,e={};if(a.options)for(var k in a.options)a.options.hasOwnProperty(k)&&(e[k]=rspkr.st.r().expandPhrase(a.options[k]));e.initval=a.converter?a.converter(b):b||0;e.start=function(){};e.drop=this.changed.slider_h;c.init($rs.get("#"+l),e)},colorpicker:function(a){$rs.regEvent("#"+a+" li a","keydown",function(a){var h=
$rs.closest(this,"li"),b;37==a.keyCode?b=h.previousSibling:39==a.keyCode&&(b=h.nextSibling);b&&(a=$rs.findIn(b,"a"),a.focus(),a.click());return!0});$rs.regEvent("#"+a+" li a","click",this.changed.colorpicker);$rs.css($rs.get("#"+a),"display","block")},restore:function(a){$rs.regEvent("#"+a,"click",function(){if(rs.cfg.defaultsettings){for(var a in rs.cfg.defaultsettings)if(rs.cfg.defaultsettings.hasOwnProperty(a)){var h=rs.cfg.defaultsettings[a];rspkr.st.r().handlers.updateSetting(a,h);var b=$rs.get("input[value='"+
h+"']");if($rs.isArray(b))if(b=$rs.get("select[data-rsform-key='"+a+"']"),$rs.isArray(b)){if(b=$rs.get("ul[data-rsform-key='"+a+"']"),!$rs.isArray(b)){var e=$rs.findIn(b,".rsform-colorlist-active");$rs.removeClass(e,"rsform-colorlist-active");h=$rs.findIn(b,"a[data-rsform-value='"+h+"']").parentNode;$rs.addClass(h,"rsform-colorlist-active")}}else b.value=h;else b.checked=!0}rspkr.Common.Settings.r().handlers.changed.afterdim()}})},changed:{dimmed:[],hidden:[],disable:function(a,l){l=l||"dimmed";var b=
$rs.findIn(a,"input, select, textarea, ul.rsform-colorlist");$rs.addClass(a,l);if("dimmed"==l)for(var c=0,e=b.length;c<e;c++)"ul"!=b[c].tagName.toLowerCase()&&(b[c].disabled=!0)},enable:function(a,l){l=l||"dimmed";var b=$rs.findIn(a,"input, select, textarea");$rs.removeClass(a,l);if("dimmed"==l)for(var c=0,e=b.length;c<e;c++)b[c].disabled=!1},add:function(a,l,b,c){a[l]||(a[l]=[]);for(var e=0,k=b.length;e<k;e++)this.disable($rs.get("#rscontrol_"+b[e]),c),a[l].push($rs.get("#rscontrol_"+b[e]))},release:function(a,
l,b){if(a[l]){for(var c=0,e=a[l].length;c<e;c++)this.enable(a[l][c],b);a[l]=[]}},dim:function(a,l){this.undim(a);this.add(this.dimmed,a,$rs.isArray(l)?l:[l],"dimmed")},undim:function(a){this.release(this.dimmed,a,"dimmed")},afterdim:function(){for(var a=$rs.get("#rslightbox_content .rsform-row"),l,b=0,c=a.length;b<c;b++)l=$rs.getAttr(a[b],"data-rsform-type"),l=this.dimmees[l]?this.dimmees[l](a[b]):null,"string"==typeof l?this.dim(a[b].id.replace("rscontrol_",""),l.split(",")):1===l&&this.undim(a[b].id.replace("rscontrol_",
""))},addButtonEvents:function(a){$rs.regEvent($rs.get("#rslightbox_buttons .rssettings-button-close"),"click",a.hide)},dimmees:{radio:function(a){a=$rs.findIn(a,'input[type="radio"]');for(var l,b=!1,c=0,e=a.length;c<e;c++)if(a[c].checked){l=a[c];break}l&&(b=$rs.getAttr(l,"data-rsform-dims")||1);return b},select:function(a){a=$rs.findIn(a,"option");for(var l,b=!1,c=0,e=a.length;c<e;c++)if(a[c].selected){l=a[c];break}l&&(b=$rs.getAttr(l,"data-rsform-dims")||1);return b}},info:function(a){$rs.hasClass(a.target.parentNode,
"dimmed")||$rs.hasClass(a.target.parentNode.parentNode,"dimmed")||(a=$rs.get("#"+$rs.getAttr(this,"data-rsform-toggles")),$rs.css(a,"display","none"==$rs.css(a,"display")?"block":"none"));return!1},select:function(h){this.value!==$rs.getAttr(this,a.form.prev)&&rspkr.st.r().handlers.updateSetting.apply(rspkr.st.r().handlers,[$rs.getAttr(this,a.form.key),this.value,this]);return!0},checkbox:function(h){h=this.checked?$rs.getAttr(this,a.form.valyes):$rs.getAttr(this,a.form.valno);h!==$rs.getAttr(this,
a.form.prev)&&rspkr.st.r().handlers.updateSetting.apply(rspkr.st.r().handlers,[$rs.getAttr(this,a.form.key),h,this]);return!0},radio:function(h){this.value!==$rs.getAttr(this,a.form.prev)&&(rspkr.st.r().handlers.updateSetting.apply(rspkr.st.r().handlers,[$rs.getAttr(this,a.form.key),this.value,this]),$rs.setAttr($rs.findIn(this.parentNode,'input[name="'+this.name+'"]'),a.form.prev,this.value));return!0},slider_h:function(h,l){var f=l.parent,c=b[l.rsid],c=c.converter?c.converter(parseInt(h)):parseInt(h),
e=$rs.getAttr(f,a.form.prev);c!==e&&rspkr.st.r().handlers.updateSetting.apply(rspkr.st.r().handlers,[$rs.getAttr(f,a.form.key),c,f])},colorpicker:function(h){h.originalEvent&&h.originalEvent.preventDefault&&h.originalEvent.preventDefault();var l=h.target.parentNode.parentNode,b=h.target.parentNode;if(!$rs.hasClass(h.target.parentNode.parentNode.parentNode,"dimmed")&&$rs.getAttr(h.target,"data-rsform-value")!==$rs.getAttr(l,a.form.prev)){$rs.removeClass($rs.findIn(l,"li"),"rsform-colorlist-active");
rspkr.st.r().handlers.updateSetting.apply(rspkr.st.r().handlers,[$rs.getAttr(l,a.form.key),$rs.getAttr(h.target,"data-rsform-value"),l]);$rs.addClass(b,"rsform-colorlist-active");for(var l=$rs.findIn(l,"a"),b=0,c;c=l[b];b++)$rs.setAttr(c,"tabIndex","-1");$rs.setAttr(h.target,"tabIndex",0)}}},updateSetting:function(h,l,b){rspkr.log("[rspkr.st] Setting updated: "+h+" | New value: "+l);m(h,l);if(b){h=$rs.closest(b,".rsform-row");var c=$rs.css(h,"background-color");rspkr.u.hl(h,function(){$rs.css(this,
"background-color",c)});$rs.setAttr($rs.get(b),a.form.prev,l)}}},expandPhrase:function(a){if("string"==typeof a&&"ph_"==a.substr(0,3)){a=a.substr(3);var l=rspkr.cfg.getPhrase(a);return void 0!==l?l:a}return a},row:function(a,l,b){if(/hlword|hltoggle/i.test(a)&&rspkr.cfg.isSentOnly&&rspkr.cfg.isSentOnly(rspkr.c.data.params.lang))return"";var c=rspkr.cfg.item("ui.settings.formrow").join("\n"),e={},k=ReadSpeaker.getID();b=this.controls[l.type](a,l,b,k);e.rsCONTROL_IDrs=a;e.rsCONTROLrs=b;e.rsCONTROL_TYPErs=
l.type;e.rsCONTROL_CLASSESrs=l.classes?l.classes.join(" "):"";return this.replaceTokens(c,e)},group:function(a){var b=rspkr.cfg.item("ui.settings.formsection").join("\n"),f={},c=[],e;for(e in a.items)a.items.hasOwnProperty(e)&&c.push(this.row(e,a.items[e],g(e)));f.rsSECTION_IDrs=ReadSpeaker.getID();f.rsSECTION_HEADINGrs=this.controls.xp(a.phrase);f.rsSECTION_ROWSrs=c.join("\n");return this.replaceTokens(b,f)},replaceTokens:function(a,b){var f=a,c;for(c in b)b.hasOwnProperty(c)&&(f=f.replace(new RegExp(c,
"igm"),b[c]));return f}};return{meta:{revision:"6672"},r:function(){return n},e:a,init:function(){for(var a=["ReadSpeakerHL","ReadSpeakerHLicon","ReadSpeakerHLspeed"],b=!1,f=0,c=a.length;f<c;f++){var e=rspkr.Common.cookie.read(a[f]);e&&(rspkr.Common.cookie.updateKey(rspkr.pub.Config.item("general.cookieName"),a[f].substr(11).toLowerCase(),e),b=!0,rspkr.Common.cookie.erase(a[f]))}b&&rspkr.log("[rspkr.st] Transferred legacy cookie.");rspkr.Common.dispatchEvent("onSettingsInitialized");rspkr.log("[rspkr.st] Initialized!");
rspkr.Common.addEvent("onSettingsLoaded",{func:rspkr.Common.Settings.r().handlers.changed.afterdim,context:rspkr.Common.Settings.r().handlers.changed,params:[]});rspkr.Common.addEvent("onSettingsChanged",{func:rspkr.Common.Settings.r().handlers.changed.afterdim,context:rspkr.Common.Settings.r().handlers.changed,params:[]})},get:function(a){return g(a)},getAll:function(){return rspkr.Common.cookie.readKeyAll(rspkr.pub.Config.item("general.cookieName"))},set:function(a,b){return m(a,b)},getHTML:function(){var a=
rspkr.cfg,b=[],f=a.item("ui.settings.form").join("\n"),c={},e=a.getSettingsConf(),k;for(k in e)e.hasOwnProperty(k)&&b.push(n.group(e[k]));e="";rspkr.ui.getActivePlayer()&&rspkr.cfg.item("ui.listenBtn")&&(e=document.createElement("div"),e.innerHTML=a.item("ui.listenBtn").join(""),a=rspkr.ui.getActivePlayer().getHref(),a=a.replace(/readid=[^&]+/gi,"readid=rslightbox_content"),a=a.replace(/&url=[^&]+/gi,""),$rs.setAttr($rs.findIn(e,".rsbtn_play"),"href",a),e=n.replaceTokens(e.innerHTML,{rsLISTENrs:n.controls.xp("ph_listen")}));
c.rsSETTINGS_HEADINGrs=n.controls.xp("ph_settings");c.rsLISTEN_BUTTONrs=rs.cfg.item("ui.settingsListenButton")&&"rsbtn"===rs.ui.rsbtnClass?e:"";c.rsSECTIONS_STARTrs="";c.rsSECTIONSrs=b.join("");c.rsSECTIONS_ENDrs="";return n.replaceTokens(f,c)},getButtons:function(){var a=rspkr.cfg.item("ui.settings.formbuttons").join("\n"),b={};b.rsSETTINGS_BUTTON_CLOSErs=n.controls.xp("ph_close");return n.replaceTokens(a,b)}}}();
ReadSpeaker.PlayerAPI=function(){var a={audioFormat:"flv",minver:8,check:function(){return rspkr.c.data.browser.flashVersion.split(",").shift()>=this.minver?!0:!1}},b={prioritize:!1,audioFormat:null,check:function(){return rspkr.c.data.browser.html5Support?(this.audioFormat=rspkr.c.data.browser.html5AudioFormat,this.prioritize=rspkr.c.data.browser.html5Priority,!0):!1}},g="",m=function(a,b){for(var f in b)a[f]=b[f]},n={meta:{revision:"6672"},init:function(){rspkr.log("[rspkr.pl] Initialized!");rspkr.Common.addEvent("onModsLoaded",
function(){rspkr.Common.Detect.init();rspkr.PlayerAPI.setAdapter()})},setAdapter:function(){g=b.check()&&a.check()?b.prioritize?"html5":"flash":b.check()?"html5":a.check()?"flash":"fallback";"html5"==g?(rspkr.log("[rspkr.pl] Using adapter "+g,1),m(n,rspkr.pl.html5.adapter)):"flash"==g?(rspkr.log("[rspkr.pl] Using adapter "+g,1),m(n,rspkr.pl.flash.adapter)):(rspkr.log("[rspkr.pl] No adapter detected - using fallback!",3),m(n,rspkr.pl.fallback.adapter))},getProduct:function(){return ReadSpeaker.HL?
ReadSpeaker.HL:ReadSpeaker.XP?ReadSpeaker.XP:!1}};return n}();
ReadSpeaker.PlayerAPI.flash=function(){return{init:function(){ReadSpeaker.log("PlayerAPI.flash heartbeat!")},adapter:{adapter:"flash",playerRef:null,timerCallBack:null,timerContext:null,loadTimer:null,progressStarted:!1,networkCheckCounter:0,play:function(){if(this.playerRef)try{this.playerRef.rs_player_play(),rspkr.devt("onAPIPlay",window)}catch(a){ReadSpeaker.log("error: "+a)}else this.initAdapter()},pause:function(){if(rspkr.pl.playerRef)try{this.playerRef.rs_player_pause(),rspkr.devt("onAPIPause",
window)}catch(a){rspkr.log("error: "+a,3)}},stop:function(){if(rspkr.pl.playerRef)try{this.playerRef.rs_player_stop(),rspkr.devt("onAPIStop",window)}catch(a){rspkr.log("error: "+a,3)}},volUp:function(){rspkr.pl.playerRef&&(this.playerRef.rs_player_volup(),rspkr.devt("onAPIVolumeUp",window))},volDown:function(){rspkr.pl.playerRef&&(this.playerRef.rs_player_voldown(),rspkr.devt("onAPIVolumeDown",window))},mute:function(){rspkr.pl.playerRef&&(this.playerRef.rs_player_mute(),rspkr.devt("onAPIMute",window))},
forward:function(){rspkr.pl.playerRef&&(this.playerRef.rs_player_jumpff(),rspkr.devt("onAPIFastForward",window))},rewind:function(){rspkr.pl.playerRef&&(this.playerRef.rs_player_jumpbb(),rspkr.devt("onAPIRewind",window))},setVolume:function(a){rspkr.log("[setVolume]",4);rspkr.pl.playerRef&&(this.playerRef.setVolume?(this.playerRef.setVolume(a),rspkr.devt("onAPISetVolume",window)):window.setTimeout(function(){rspkr.pl.setVolume(a)},10))},setProgress:function(a){if(rspkr.pl.playerRef)try{this.playerRef.setProgress(a),
rspkr.devt("onAPISetProgress",window)}catch(b){}},getProgress:function(a,b,g){rspkr.pl.playerRef&&(this.timerCallBack=b,this.timerContext=g||b,rspkr.pl.playerRef&&"function"==typeof rspkr.pl.playerRef.getProgress?(clearTimeout(this.loadTimer),rspkr.pl.playerRef.getProgress(a,"rspkr.pl.timer",500),this.progressStarted=!0):this.progressStarted||(this.loadTimer=window.setTimeout(function(){rspkr.pl.getProgress(a,b,g)},500)),rspkr.devt("onAPIGetProgress",window))},timer:function(a){a=a.split("|");if("function"==
typeof this.timerCallBack)try{this.timerCallBack.apply(this.timerContext,[a])}catch(b){}},checkNetworkStatus:function(){3<rspkr.pl.networkCheckCounter||setTimeout(function(){if(rspkr.pl.playerRef){rspkr.pl.networkCheckCounter++;try{rspkr.log("[rspkr.pl.checkNetworkStatus] "+rspkr.pl.playerRef.rs_player_networkStatus(),1)}catch(a){rs.pl.checkNetworkStatus();return}3===rspkr.pl.playerRef.rs_player_networkStatus()?(rspkr.log("[rspkr.pl] Cannot load audio!",3),rspkr.ui.showOverlay("loaderror"),rspkr.devt("onAudioLoadError",
window)):0===rs.PlayerAPI.playerRef.rs_player_networkStatus()&&rs.pl.checkNetworkStatus()}},rspkr.cfg.item("general.audioTimeout")||750)},initAdapter:function(){var a=encodeURIComponent(rspkr.c.data.getAudioLink({audioformat:"flv"}));this.progressStarted=!1;this.releaseAdapter();var b=document.getElementById("rs_player_holder");b||(b=document.createElement("div"),$rs.setAttr(b,"id","rs_player_holder"),document.body.appendChild(b));a=['<object id="readspeaker_flash_player" '+(document.selection?'classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"':
'type="application/x-shockwave-flash" data="'+ReadSpeaker.pub.Config.item("flash.flashSrc")+"?flv="+a+'&autoplay=1" ')+'style="height: 1px; width: 1px;">','<param name="movie" value="'+rspkr.cfg.item("flash.flashSrc")+"?flv="+a+'&autoplay=1" />','<param name="quality" value="high" />','<param name="autostart" value="true" />','<param name="allowScriptAccess" value="'+rspkr.cfg.item("flash.allowScriptAccess")+'" />','<param name="loop" value="false" /></object>'];b.innerHTML=a.join("\n");$rs.setAttr(b,
"style","position: fixed; bottom: 0px; right: 0px;");var g=function(a){4===a&&rspkr.pl.playerRef&&rspkr.pl.playerRef.setVolume&&(rspkr.pl.playerRef.setVolume(rspkr.st.get("hlvol")||"100"),document.attachEvent?$rs.get("#readspeaker_flash_player").detachEvent("onreadystatechange",g):document.addEventListener&&$rs.get("#readspeaker_flash_player").removeEventListener("load",function(){g(4)},!1))};document.attachEvent?($rs.get("#readspeaker_flash_player").attachEvent("onreadystatechange",g),rspkr.devt("onVolumeAdjusted",
window)):document.addEventListener&&$rs.get("#readspeaker_flash_player").addEventListener("load",function(){g(4)},!1);rspkr.pl.playerRef=document.getElementById("readspeaker_flash_player");rspkr.devt("onAPIInitAdapter",window);rspkr.pl.checkNetworkStatus()},releaseAdapter:function(){if(rspkr.pl.playerRef){try{rspkr.pl.playerRef.rs_player_stop(),rspkr.devt("onAPIStop",window)}catch(a){ReadSpeaker.log("error: "+a)}var b=$rs.get("#rs_player_holder");b.removeChild(rspkr.pl.playerRef);document.body.removeChild(b);
rspkr.pl.playerRef=null;rspkr.devt("onAPIReleaseAdapter",window)}},reloadAdapter:function(){this.initAdapter();rspkr.devt("onAPIReloadAdapter",window)}}}}();
ReadSpeaker.PlayerAPI.html5=function(){return{init:function(){ReadSpeaker.log("PlayerAPI.html5 heartbeat!")},adapter:{adapter:"html5",playerRef:null,timerCallBack:null,timerContext:null,bufferedTime:null,playbackStarted:!1,play:function(){ReadSpeaker.log("[rspkr.pl.play]");rspkr.HL.chunking.close();rspkr.HL.chunking.chunkEnded?(rspkr.HL.chunking.chunkEnded=!1,rspkr.c.dispatchEvent("onChunkResume",window)):!this.playerRef||rspkr.HL.newPlayback?(this.initAdapter(),rspkr.HL.newPlayback=!1):(rspkr.pl.playPromise(this.playerRef),
rspkr.devt("onAPIPlay",window))},mobilePause:function(a){!rspkr.pl.playbackStarted&&a.pause()},playPromise:function(a,b,g,m){rspkr.pl.playbackStarted=!m;var n=a.play();if(void 0!==n)n.then(function(){m?rs.pl.mobilePause(a):rspkr.pl.playbackStarted=!0;!m&&(a.muted=!1);var h=rspkr.ui.getActivePlayer(),l=h?h.getContainer():void 0;h&&l&&($rs.hasClass(l,"rspaused")?(h.pause(),$rs.removeClass($rs.findIn(l,".rsbtn_progress_container"),"rsloading")):$rs.hasClass(l,"rsstopped")?h.stop():$rs.hasClass(l,"rsexpanded")||
h.close());b&&"function"===typeof b&&b.call()})["catch"](function(a){rspkr.log("PlayPromise error: "+a,3);g&&"function"===typeof g&&g.call(a)});else"function"===typeof b&&(m?rs.pl.mobilePause(a):rspkr.pl.playbackStarted=!0,b.call())},pause:function(){this.playerRef&&(rspkr.pl.playerRef.pause(),rspkr.devt("onAPIPause",window))},stop:function(){rspkr.pl.playerRef&&(rspkr.pl.playerRef.pause(),0<rspkr.pl.playerRef.readyState&&(rspkr.pl.playerRef.currentTime=0),rspkr.devt("onAPIStop",window))},volUp:function(){this.playerRef&&
(this.playerRef.volume=Math.min(1,this.playerRef.volume+.2),rspkr.st.set("hlvol",100*this.playerRef.volume),rspkr.devt("onAPIVolumeUp",window))},volDown:function(){this.playerRef&&(this.playerRef.volume=Math.max(0,this.playerRef.volume-.2),rspkr.st.set("hlvol",100*this.playerRef.volume),rspkr.devt("onAPIVolumeDown",window))},mute:function(){this.playerRef&&(this.playerRef.volume=0,rspkr.devt("onAPIMute",window))},forward:function(){this.playerRef&&(this.playerRef.currentTime=this.playerRef.currentTime+
5<this.playerRef.duration?this.playerRef.currentTime+5:this.playerRef.duration,rspkr.devt("onAPIFastForward",window))},rewind:function(){this.playerRef&&(this.playerRef.currentTime=0<this.playerRef.currentTime-5?this.playerRef.currentTime-5:0,rspkr.devt("onAPIRewind",window))},setVolume:function(a){rspkr.log("[setVolume] "+a,4);this.playerRef&&(this.playerRef.volume=parseFloat(a/100),rspkr.devt("onAPISetVolume",window))},setProgress:function(a){if(this.playerRef&&!isNaN(this.playerRef.duration)){a=
parseInt(a);var b=parseInt(ReadSpeaker.PlayerAPI.getProduct().html5.handlers.totalTime());this.playerRef.currentTime=a<b&&a<this.playerRef.duration?a:this.playerRef.duration;rspkr.HL&&rspkr.HL.html5&&rspkr.HL.html5.lastcurrenttime&&(rspkr.HL.html5.lastcurrenttime=0);rspkr.devt("onAPISetProgress",window)}},getProgress:function(a,b,g){this.playerRef&&(0==a?rspkr.pl.playerRef.removeEventListener("timeupdate",rspkr.pl.timer,!1):(this.timerCallBack=b,this.timerContext=g||b,rspkr.pl.playerRef.addEventListener("timeupdate",
rspkr.pl.timer,!1),rspkr.devt("onAPIGetProgress",window)))},timer:function(){if(rspkr.pl.playerRef){var a=1E3*parseInt(rspkr.pl.playerRef.currentTime);rspkr.pl.bufferedTime=1E3*parseInt(ReadSpeaker.PlayerAPI.getProduct().html5.handlers.totalTime());var b=[a,rspkr.pl.bufferedTime];if(rspkr.hl.html5&&rspkr.hl.html5.synclist&&rspkr.hl.html5.synclist[rspkr.hl.html5.synclist.length-1]){var g=rspkr.hl.html5.synclist[rspkr.hl.html5.synclist.length-1][0];rspkr.pl.bufferedTime>g&&(b=[a,g])}if("function"==
typeof rspkr.pl.timerCallBack)try{rspkr.pl.timerCallBack.apply(rspkr.pl.timerContext,[b])}catch(m){rspkr.log("timeupdate error",2)}}},checkNetworkStatus:function(){var a=rs.pl.playerRef;rs.pl.errorCount=rs.pl.errorCount||0;rs.pl.networkStates=rs.pl.networkStates||[0,0,0,0];setTimeout(function(){if(a){rs.pl.networkStates[a.networkState]++;rs.pl.networkStates[4]=a.buffered&&a.buffered.length&&0<a.buffered.end(0)?a.buffered.end(0):!1;rs.pl.networkStates[5]=a.duration&&a.duration&&!isNaN(a.duration)&&
0<a.duration?a.duration:!1;if(3===a.networkState)rs.pl.errorCount++,10<rs.pl.errorCount&&!rs.pl.networkStates[4]&&!rs.pl.networkStates[5]?(rspkr.log("[rspkr.pl] Cannot load audio!",3),rspkr.ui.showOverlay("loaderror"),rspkr.devt("onAudioLoadError",window)):rspkr.pl.checkNetworkStatus();else if(2===a.networkState){rs.pl.errorCount=0;var b=0<a.buffered.length?a.buffered.end(a.buffered.length-1):0,g=a.duration||0;(0==g||b<g)&&rspkr.pl.checkNetworkStatus()}else rs.pl.errorCount=0;rspkr.log(rs.pl.networkStates,
5)}},rspkr.cfg.item("general.audioTimeout")||750)},initAdapter:function(){rspkr.devt("onAPIInitAdapter",window)},releaseAdapter:function(){if(rspkr.pl.playerRef){rspkr.pl.playerRef.pause();try{0<rspkr.pl.playerRef.readyState&&(rspkr.pl.playerRef.currentTime=0)}catch(a){}rspkr.pl.playerRef=null;rspkr.devt("onAPIReleaseAdapter",window)}},reloadAdapter:function(){this.releaseAdapter();this.initAdapter();rspkr.devt("onAPIReloadAdapter",window)}}}}();
rspkr.PlayerAPI.fallback=function(){return{init:function(){ReadSpeaker.log("PlayerAPI.fallback heartbeat!")},adapter:{adapter:"fallback"}}}();
rspkr.HL=function(){var a="",b={firstRun:0,previousWord:{},previousSent:{},lastWord:null,selectionRange:null,selectionHTML:null,selectedWordsRange:[],selectionDocument:null,processedDocument:null},g={oldWordHL:[],oldWordHLClass:[],oldSentHL:[],oldSentHLClass:[],sync:function(a,b){var f=!1,c=document.getElementById("sync"+b);0==(a&2)&&(f=0!=(a&1)?!0:!1);if(c){if(c&&c.className.replace("word","")!=c.className){if(!f&&0<this.oldWordHL.length){for(f=0;f<this.oldWordHLClass.length;f++)this.oldWordHL[f].className=
this.oldWordHLClass[f];this.oldWordHL=[];this.oldWordHLClass=[]}this.oldWordHLClass.push(c.className);this.oldWordHL.push(c);rspkr.HL.customHL&&rspkr.HL.customHL.active()&&rspkr.HL.customHL.wordHL(c,a);c.className=c.className.replace("sync_word","sync_word_highlighted")}else if(c&&c.className.replace("sent","")!=c.className){if(!f&&0<this.oldSentHL.length){for(f=0;f<this.oldSentHL.length;f++)this.oldSentHL[f].className=this.oldSentHLClass[f];this.oldSentHL=[];this.oldSentHLClass=[]}this.oldSentHLClass.push(c.className);
this.oldSentHL.push(c);rspkr.HL.customHL&&rspkr.HL.customHL.active()&&rspkr.HL.customHL.sentHL(c,a);c.className=c.className.replace("sync_sent","sync_sent_highlighted")}c&&rspkr.HL.Scroll.execScroll(c)}},preProcess:{setRestoreContent:function(){rspkr.log("[Servermarkup.preProcess.setRestoreContent] Called!");var a=rspkr.Common.data.getParam("readid"),a=document.getElementById(a).innerHTML;rspkr.Common.data.setRestoreContent(a)}},postProcess:{fullCleanUp:function(){rspkr.log("[Servermarkup.postProcess.fullCleanUp] Called!");
rspkr.HL.Restore.all()},lightCleanUp:function(){rspkr.log("[Servermarkup.postProcess.lightCleanUp] Called!");var a=rspkr.HL.serverMarkup.oldWordHL,b=rspkr.HL.serverMarkup.oldWordHLClass,f=rspkr.HL.serverMarkup.oldSentHL,c=rspkr.HL.serverMarkup.oldSentHLClass;if(a&&0<a.length){for(var e=0;e<a.length;e++)a[e].className=b[e];rspkr.HL.serverMarkup.oldWordHL=[];rspkr.HL.serverMarkup.oldWordHLClass=[]}if(f&&0<f.length){for(e=0;e<f.length;e++)f[e].className=c[e];rspkr.HL.serverMarkup.oldSentHL=[];rspkr.HL.serverMarkup.oldSentHLClass=
[]}e=rspkr.Common.data.browser.syncContainer.replace(/(:|\.|\[|\]|,)/g,"\\$1");a=$rs.get(e+".sync_sent,"+e+".sync_word,"+e+".sync_sent_highlighted,"+e+".sync_word_highlighted,"+e+".sync_user,"+e+".synctemp,"+e+'[class*="ffsent"]');a=$rs.isArray(a)?a:[a];for(e=a.length-1;-1<e;e--)a[e].className=a[e].className.replace("sync_sent_highlighted","sync_sent"),a[e].className=a[e].className.replace("sync_word_highlighted","sync_word"),-1!==a[e].className.toLowerCase().indexOf("sync_user")&&(a[e].className=
a[e].className.replace("sync_sent",""),a[e].className=a[e].className.replace("sync_word",""),a[e].removeAttribute("id"))}}},m=function(){rspkr.log("[rspkr.HL.addEvents]");var a=rspkr.Common.addEvent;a("onUIClosePlayer",rspkr.HL.sync.lightCleanUp);a("onUIClosePlayer",rspkr.HL.cleanUpHandler);a("onUIClosePlayer",function(){rspkr.hl.State.setState(rspkr.hl.State.READY)});a("onUIStop",function(){rspkr.hl.State.setState(rspkr.hl.State.STOPPED)});a("onUIBeforePlay",function(){rspkr.hl.Restore.checkContent()});
rspkr.PlayerAPI&&rspkr.PlayerAPI.adapter&&"html5"===rspkr.PlayerAPI.adapter&&(rspkr.evt("onAPIInitAdapter",rspkr.HL.html5.handlers.init),rspkr.evt("onAPIPlay",rspkr.HL.html5.handlers.play),rspkr.evt("onAPIPause",rspkr.HL.html5.handlers.pause),rspkr.evt("onAPIStop",rspkr.HL.html5.handlers.stop),rspkr.evt("onAPIRewind",rspkr.HL.html5.handlers.updateTime),rspkr.evt("onAPISetProgress",rspkr.HL.html5.handlers.updateTime),rspkr.evt("onAPIReleaseAdapter",rspkr.HL.html5.handlers.release));rspkr.evt("onAPIStop",
rspkr.HL.sync.lightCleanUp)},n={enums:{key:"readspeaker_inline_styles",sent:"sync_sent",sent_hl:"sync_sent_highlighted",word:"sync_word",word_hl:"sync_word_highlighted"},word_index:null,sent_index:null,hlChanged:!1,setHL:function(){var a=rspkr.pub.Config,b=rspkr.Common.Settings.get("hlword")||a.item("settings.hlword"),f=rspkr.Common.Settings.get("hlsent")||a.item("settings.hlsent"),a=rspkr.Common.Settings.get("hltext")||a.item("settings.hltext");this.updateHL("hlword",b,null);this.updateHL("hlsent",
f,null);this.updateHL("hltext",a,null)},updateHL:function(h,l,f){f=f||null;"hlspeed"===h&&l!==f&&(this.hlChanged=!0);l===f||"hl"!==h&&"hltoggle"!==h||(this.hlChanged=!0,rspkr.HL.sync.lightCleanUp());l!==f&&("hl"===h&&"none"!==l||"hltoggle"===h&&"hlon"===l)&&(this.setTextStyle("word",rspkr.Common.Settings.get("hlword")),this.setTextStyle("sent",rspkr.Common.Settings.get("hlsent")),this.setTextStyle("hltext",rspkr.Common.Settings.get("hltext")),this.hlChanged=!0,rspkr.HL.Type.CURRENT===rspkr.HL.Type.CLIENT_MARKUP&&
rspkr.PlayerAPI.releaseAdapter());/hltext|hlword|hlsent|hlscroll/i.test(h)&&l!=f&&("hlscroll"==h?rspkr.HL.Scroll.initScroll():(this.setTextStyle(h,l),"explorer"==a&&(b.selectionRange&&"wordsent"===rspkr.st.get("hl")&&"hlsent"==h&&(b.selectionRange.execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent")),b.selectionRange.execCommand("forecolor",0,rspkr.Common.Settings.get("hltext"))),b.lastWord&&("sent"==rspkr.st.get("hl")?b.lastWord.execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent")):
b.lastWord.execCommand("backcolor",0,rspkr.Common.Settings.get("hlword")),b.lastWord.execCommand("forecolor",0,rspkr.Common.Settings.get("settings.hltext"))))))},setTextStyle:function(a,b,f){var c=/word/.test(a)?"word":"sent",e="background-color";f=f||n.enums.key;/underline/.test(b)?(e="text-decoration",b+=" !important; background-color: none !important"):/none/.test(b)?(e="background",b+=" !important; text-decoration: none !important; background-color: none !important"):"hltext"===a?(a=b,b=this.getStyleString(rspkr.Common.Settings.get("hlsent"),
a),a=this.getStyleString(rspkr.Common.Settings.get("hlword"),a),rspkr.Common.css.replaceRule(f,"."+n.enums.word_hl,e+": "+a)):b+=" !important; text-decoration: none !important; color: "+rspkr.Common.Settings.get("hltext")+" !important";rspkr.Common.css.replaceRule(f,"."+n.enums[c+"_hl"],e+": "+b)},getStyleString:function(a,b){var f=/underline|none/i.test(a)?"none":a,c=/underline/i.test(a)?"underline":"none";return f+" !important; text-decoration: "+c+" !important; color: "+b+" !important"}};return{meta:{revision:"6672"},
init:function(){var h=rspkr.Common.addEvent;h("onAfterModsLoaded",function(){h("onAPIInitAdapter",rspkr.HL.Restore.setRestoreContent);rspkr.HL.addEvents();rspkr.HL.Scroll.initScroll();a=document.selection&&(9>rspkr.Common.data.browser.version||9>document.documentMode)?"explorer":"gecko";rspkr.log("[rspkr.hl] Using engine "+a);var l=rspkr.HL.engine[a].clientExtension,f;for(f in l)b[f]=l[f];window.addEventListener&&window.addEventListener("message",rspkr.HL.html5.receiveMessage,!1,!0)});h("onModsLoaded",
{func:n.setHL,context:n});h("onSettingsChanged",{func:n.updateHL,context:n});rspkr.HL.chunking={html5support:!!document.createElement("audio").canPlayType,close:function(){var a=$rs.get(".rsresume");$rs.isArray(a)||(a=[a]);for(var b=0,h;h=a[b];b++)h.parentElement.removeChild(h)},silence:function(){rspkr.HL.chunking.entracte&&rspkr.HL.chunking.entracte.src&&(rspkr.HL.chunking.entracte.pause(),rspkr.HL.chunking.entracte.currentTime&&(rspkr.HL.chunking.entracte.currentTime=0))},kill:function(){rspkr.HL.chunking.timer&&
clearTimeout(rspkr.HL.chunking.timer);rspkr.HL.chunking.continueHref=null;rspkr.HL.chunking.stall=null;rspkr.HL.chunking.chunkEnded=null;rspkr.HL.chunking.currentChunkNumber=1;rspkr.HL.chunking.entracte&&rspkr.HL.chunking.entracte.removeAttribute("src")},destroy:function(){rspkr.HL.chunking.silence();rspkr.HL.chunking.close();rspkr.HL.chunking.kill()}};rspkr.HL.chunking.currentChunkNumber=1;h("onChunkResume",function(){if(rspkr.HL.chunking.continueHref){rspkr.HL.chunking.silence();var a=rspkr.ui.getActivePlayer().getContainer();
if($rs.hasClass(a,"rsautopaused")||!$rs.hasClass(a,"rspaused"))if(rspkr.HL.chunking.stall)setTimeout(function(){rspkr.c.dispatchEvent("onChunkResume",window)},250);else{$rs.removeClass(a,"rsautopaused");clearTimeout(rspkr.HL.chunking.timer);var a=rspkr.HL.chunking.continueHref.replace("%{AUDIOFORMAT}",rspkr.Common.data.browser.html5AudioFormat),b=rspkr.HL.chunking.continueHref.replace("%{AUDIOFORMAT}","html5iframe");rspkr.HL.chunking.continueHref=void 0;rspkr.HL.html5.audioUrl=a.replace(/&amp;/g,
"&");rspkr.HL.html5.frameUrl=b.replace(/&amp;/g,"&");rspkr.HL.html5.initSyncFrame();rspkr.HL.html5.initAudio();rspkr.ui.getActivePlayer().play();rspkr.HL.chunking.currentChunkNumber++}}});rspkr.log("[rspkr.HL] Initialized!")},addEvents:function(){m()},cleanUpHandler:function(a){rspkr.log("[rspkr.HL.cleanUpHandler] String is: "+a);"userclick"===a||"nosel"===a?rspkr.HL.sync.fullCleanUp():rspkr.HL.sync.lightCleanUp()},clientMarkup:b,serverMarkup:g,markedUpHTML:[],html5:{States:{BEGIN:0,STOPPED:1,USER_START_NOT_READY:2,
USER_START_PLAYING:3,NOT_PLAYING:4,CURRENT:0,setState:function(a){rspkr.log("[rspkr.hl.html5.States.setState] Changing state from "+this.CURRENT+" to "+a,1);this.CURRENT=a}},Events:{canPlay:!1,durationChange:!1,syncReady:!1,eventTimer:null,onCanPlay:function(){rspkr.log("onCanPlay fired!",1);this.canPlay=!0;this.checkCompletion();this.eventTimer=setTimeout(function(){rspkr.log("[rspkr.hl.html5.Events] Timer triggered. Starting playback.",1);rspkr.hl.html5.Events.resetAll();rspkr.hl.html5.refresh()},
2500);return!1},checkCompletion:function(){this.canPlay&&this.durationChange&&this.syncReady&&(clearTimeout(this.eventTimer),this.eventTimer=null,rspkr.hl.html5.Events.resetAll(),rspkr.hl.html5.refresh())},onDurationChange:function(){rspkr.log("onDurationChange fired!",1);this.durationChange=!0;this.checkCompletion();this.eventTimer=setTimeout(function(){rspkr.log("[rspkr.hl.html5.Events] Timer triggered. Starting playback.",1);rspkr.hl.html5.Events.resetAll();rspkr.hl.html5.refresh()},2500)},onSyncReady:function(){rspkr.log("onSyncReady fired!",
1);this.syncReady=!0;this.checkCompletion();this.eventTimer=setTimeout(function(){rspkr.log("[rspkr.hl.html5.Events] Timer triggered. Starting playback.",1);rspkr.hl.html5.Events.resetAll();rspkr.hl.html5.refresh()},2500)},resetAll:function(){this.syncReady=this.durationChange=this.canPlay=!1},onEnded:function(){rs.HL.chunking.continueHref?window.rshlcontinue():window.rshlexit("false")}},lastcurrenttime:-1,currentsyncindex:0,lastevent:null,lastlastevent:null,lastlastlastevent:null,synclist:[],synclistindex:0,
audioUrl:null,backupUrl:null,frameUrl:null,timer:null,postMessageData:[],runningRefresh:!1,handlers:{init:function(){rspkr.log("[rspkr.HL.html5.handlers.init]");rspkr.HL.html5.cronologyCheck={proxyCallsDone:!1,errorOccured:!1,quarantine:[]};rspkr.HL.html5.rshlendCall=!1;var a=Math.random(),b={};b.audioformat=rspkr.Common.data.browser.html5AudioFormat;b.requestgrouptype="html5iframe";b.requestgroup=a;b.chunk=1;rspkr.HL.html5.backupUrl=rspkr.Common.data.getAudioLink(b);(!0===rspkr.cfg.item("general.usePost")||
0<rspkr.Common.data.selectedText.length||0<rspkr.Common.data.selectedHTML.length)&&"iOS"!==rspkr.Common.data.browser.OS&&"Android"!==rspkr.Common.data.browser.OS&&"Windows Phone"!==rspkr.Common.data.browser.OS?rspkr.HL.html5.timer=setTimeout(function(){rspkr.HL.html5.initSyncFrame(b);rspkr.HL.html5.initAudio();clearTimeout(rspkr.HL.html5.timer)},2E3):(rspkr.log("Normal audio init!"),rspkr.HL.html5.initSyncFrame(b),rspkr.HL.html5.initAudio())},play:function(){rspkr.log("[rspkr.HL.html5.handlers.play]");
rspkr.HL.Type.CURRENT==rspkr.HL.Type.CLIENT_MARKUP&&rspkr.hl.html5.States.CURRENT==rspkr.hl.html5.States.STOPPED?(rspkr.hl.html5.States.setState(rspkr.hl.html5.States.BEGIN),rspkr.PlayerAPI.playerRef.pause(),rspkr.HL.html5.handlers.runPostMessages()):rspkr.HL.Type.CURRENT==rspkr.HL.Type.SERVER_MARKUP&&rspkr.hl.html5.States.CURRENT==rspkr.hl.html5.States.STOPPED?rspkr.hl.State.setState(rspkr.hl.State.RELOAD)?this.init():(rspkr.hl.html5.States.setState(rspkr.hl.html5.States.BEGIN),rspkr.PlayerAPI.playerRef.pause(),
rspkr.HL.html5.handlers.runPostMessages()):(rspkr.hl.html5.States.CURRENT=rspkr.hl.html5.States.USER_START_PLAYING,rspkr.hl.html5.refresh())},pause:function(){rspkr.hl.html5.States.setState(rspkr.hl.html5.States.NOT_PLAYING);rspkr.hl.html5.lastcurrenttime=0},release:function(){rspkr.log("[rspkr.HL.html5.handlers.release]");rspkr.HL.html5.synclist=[];rspkr.HL.html5.synclistindex=0;rspkr.HL.html5.currentsyncindex=0;rspkr.HL.html5.lastcurrenttime=-1;rspkr.HL.html5.audioUrl=null;rspkr.HL.html5.backupUrl=
null;rspkr.HL.html5.frameUrl=null;rspkr.HL.html5.postMessageData=[];rspkr.HL.html5.Events.resetAll();rspkr.PlayerAPI.playerRef&&rspkr.PlayerAPI.playerRef.removeEventListener("ended",rshlexit,!1);rspkr.PlayerAPI.playerRef=null;var a=document.getElementById("ReadSpeaker_sync_iframe");a&&(a.src="about:blank")},stop:function(){rspkr.hl.html5.States.setState(rspkr.hl.html5.States.STOPPED);rspkr.HL.html5.lastcurrenttime=-1;rspkr.HL.html5.currentsyncindex=0},updateTime:function(){rspkr.log("[rspkr.HL.html5.handlers.updateTime]");
rspkr.hl.html5.States.setState(rspkr.hl.html5.States.NOT_PLAYING);rspkr.HL.html5.lastcurrenttime=rspkr.PlayerAPI.playerRef.currentTime;rspkr.HL.html5.currentsyncindex=0;rspkr.HL.html5.handlers.setCurrentSyncIndex();rspkr.hl.html5.States.setState(rspkr.hl.html5.States.USER_START_PLAYING)},runPostMessages:function(){rspkr.log("[rspkr.HL.html5.handlers.runPostMessages]");var a=rspkr.HL.html5.postMessageData,b;for(b in a)null!==a[b-1]&&"rshlsetContent"==a[b]?rspkr.HL.sync.setContent(rspkr.Common.base64.decode(a[b-
1])):null!==a[b-1]&&"rshlsetId"==a[b]?rspkr.HL.sync.setId(a[b-1]):"rshlinit"==a[b]&&(rspkr.HL.sync.init(),rspkr.pl.playPromise(rspkr.PlayerAPI.playerRef),rspkr.HL.html5.refresh())},clearPostMessages:function(){rspkr.log("[rspkr.HL.html5.handlers.clearPostMessages]");rspkr.HL.html5.postMessageData=[]},setCurrentSyncIndex:function(){if(0<rspkr.HL.html5.synclist.length&&rspkr.HL.html5.synclist[rspkr.HL.html5.currentsyncindex])for(;rspkr.HL.html5.synclist[rspkr.HL.html5.currentsyncindex]&&20>=1*rspkr.HL.html5.synclist[rspkr.HL.html5.currentsyncindex][0]-
1E3*rspkr.PlayerAPI.playerRef.currentTime;)rspkr.HL.html5.currentsyncindex++},totalTime:function(){var a=rspkr.PlayerAPI.playerRef;if(a)if("Opera"!==rspkr.Common.data.browser.name&&a.buffered&&a.buffered.end)try{return 0<a.buffered.length?a.buffered.end(a.buffered.length-1):a.buffered.end(0)}catch(b){return a.duration&&"infinity"!==a.duration.toString().toLowerCase()&&"NaN"!==a.duration?a.duration:a.currentTime+15}else return a.duration&&"infinity"!==a.duration.toString.toLowerCase()&&"NaN"!==a.duration?
a.duration:a.currentTime+15}},initAudio:function(){if(!rspkr.HL.html5.audioUrl||rspkr.HL.newPlayback)rspkr.HL.html5.audioUrl=rspkr.HL.html5.backupUrl;rspkr.log("[rspkr.html5.initAudio] Audio URL: "+rspkr.HL.html5.audioUrl,1);(/windows phone|ios|android/i.test(rspkr.c.data.browser.OS)||/safari/i.test(rspkr.c.data.browser.name))&&"object"===typeof window.rspkr.audio&&null!==window.rspkr.audio?(rspkr.audio.src=rspkr.HL.html5.audioUrl,rspkr.PlayerAPI.playerRef=rspkr.audio,rspkr.log("[rs.hl.initAudio] Reusing existing audio element.",
4)):rspkr.PlayerAPI.playerRef=new Audio(rspkr.HL.html5.audioUrl);var a=rspkr.PlayerAPI.playerRef;a.loop=!1;a.preload="auto";a.volume=parseFloat((rspkr.st.get("hlvol")||100)/100);rspkr.devt("onVolumeAdjusted",window);(/ios|android|windows phone/i.test(rspkr.c.data.browser.OS)||/safari/i.test(rspkr.c.data.browser.name))&&rspkr.pl.playPromise(rspkr.pl.playerRef,void 0,void 0,!0);a.addEventListener("canplay",function(){rspkr.hl.html5.Events.onCanPlay()},!1);a.addEventListener("durationchange",function(){rspkr.log("[rspkr.hl.html5.initAudio] Durationchange occurred",
1);1==rspkr.HL.html5.handlers.totalTime()&&1==rspkr.PlayerAPI.playerRef.paused?rspkr.HL.html5.initAudio():(0===rspkr.HL.html5.handlers.totalTime()&&rspkr.pl.playPromise(rspkr.pl.playerRef),rspkr.hl.html5.Events.onDurationChange())},!1);rspkr.PlayerAPI.playerRef.addEventListener("ended",function(){rspkr.log("[rspkr.hl.html5.initAudio] Ended occurred",1);rs.HL.chunking.continueHref?window.rshlcontinue():window.rshlexit("false")},!1);rspkr.pl.checkNetworkStatus();rspkr.hl.html5.States.setState(rspkr.hl.html5.States.BEGIN)},
initSyncFrame:function(a){if("none"!=rspkr.Common.data.sync){var b=null;document.getElementById("ReadSpeaker_sync_iframe")?b=document.getElementById("ReadSpeaker_sync_iframe"):(b=document.createElement("iframe"),b.setAttribute("id","ReadSpeaker_sync_iframe"),b.setAttribute("title","ReadSpeaker_sync_iframe"),b.setAttribute("aria-hidden","true"),b.setAttribute("sandbox","allow-same-origin allow-scripts"),b.height=0,b.width=0,b.style.display="none",document.body.appendChild(b));!rspkr.HL.html5.frameUrl&&
(!0===rspkr.cfg.item("general.usePost")||0<rspkr.Common.data.selectedText.length||0<rspkr.Common.data.selectedHTML.length)?rspkr.HL.html5.frameUrl=rspkr.HL.html5.backupUrl+"sync":rspkr.HL.html5.frameUrl||(a.audioformat="html5iframe",rspkr.HL.html5.frameUrl=rspkr.Common.data.getAudioLink(a));rspkr.log("[rspkr.HL.html5.initSyncFrame] Audio URL: "+rspkr.HL.html5.frameUrl);rspkr.HL.html5.frameUrl&&(b.src=rspkr.HL.html5.frameUrl,b.type="text/javascript")}else rspkr.hl.html5.States.setState(rspkr.hl.html5.States.USER_START_PLAYING),
rspkr.pl.playPromise(rspkr.pl.playerRef)},removeSyncFrame:function(){var a=document.getElementById("ReadSpeaker_sync_iframe");a&&a.parentNode.removeChild(a)},receiveMessage:function(a){var b=!0;rspkr.cfg.item("general.servercall")&&(b=document.createElement("a"),$rs.setAttr(b,"href",rspkr.cfg.item("general.servercall")),b=!a.origin.match(b.hostname));var f=document.createElement("a");f.href=a.origin;var f=f.hostname,c=["\\.readspeaker\\.com$","^79\\.136\\.80\\.([0-9][0-9]?[0-9?])$","^173\\.205\\.5\\.(19[3-9]|2[0-4][0-9]|25[0-4])$",
"^2001\\:668\\:1F\\:2A","^2001\\:9b0\\:2\\:703","\\."+rspkr.cfg.item("general.domain").replace(".","\\\\.")+"$"],c=new RegExp("("+c.join("|")+")","gi");!f.match(c)&&b||"string"!==typeof a.data||rspkr.HL.html5.parseMessage(a)},parseMessage:function(a){rspkr.HL.html5.postMessageData.push(a.data);/android|ios|windows phone/i.test(rspkr.Common.data.browser.OS)||"rshlfinished"!=a.data||(rspkr.HL.html5.timer&&clearTimeout(rspkr.HL.html5.timer),rspkr.HL.html5.initSyncFrame(),rspkr.HL.html5.initAudio());
if("rshlend"===a.data)rspkr.hl.html5.lastevent&&rspkr.hl.html5.lastevent.data&&!isNaN(rspkr.hl.html5.lastevent.data)&&(rspkr.HL.html5.synclist[rspkr.HL.html5.synclistindex]=[rspkr.HL.html5.lastevent.data,"rshlend",0],rspkr.HL.html5.synclistindex++),rspkr.HL.html5.rshlendCall=!0,rspkr.c.post.removeIframe(),rspkr.HL.html5.removeSyncFrame();else{if("rshlaudio"===a.data){a=rs.cfg.item("general.customProxy")?rs.cfg.item("general.customProxy")+encodeURIComponent(rspkr.HL.html5.lastevent.data):rspkr.HL.html5.lastevent.data;
rspkr.HL.html5.audioUrl=a;return}if("rshlhtml5sync"===a.data){a=rspkr.HL.html5.lastevent.data;var b=document.createElement("a");b.href=a;if("http:"!==b.protocol&&"https:"!==b.protocol)return;a=rs.cfg.item("general.customProxy")?rs.cfg.item("general.customProxy")+encodeURIComponent(a):a;rspkr.HL.html5.frameUrl=a;return}if("rshlaudio"==a.data)return;null!=rspkr.HL.html5.lastevent&&"rshlsetContent"==a.data?(rspkr.HL.html5.synclist=[],rspkr.HL.html5.synclistindex=0,rspkr.HL.sync.setContent(rspkr.Common.base64.decode(rspkr.HL.html5.lastevent.data))):
null!=rspkr.HL.html5.lastevent&&"rshlsetId"==a.data?rspkr.HL.sync.setId(rspkr.HL.html5.lastevent.data):null!=rspkr.HL.html5.lastevent&&"rshlReplace"==a.data?(rspkr.HL.html5.lastevent.data.match(/class=[^&|,]+/gi)&&(b=rspkr.HL.html5.lastevent.data.match(/class=[^&|,]+/gi)[0].replace("class=",""),rspkr.HL.sync.setClass(b)),rspkr.HL.html5.lastevent.data.match(/id=[^&|,]+/gi)&&(b=rspkr.HL.html5.lastevent.data.match(/id=[^&|,]+/gi)[0].replace("id=",""),rspkr.HL.sync.setId(b))):"rshlinit"==a.data?(rspkr.HL.sync.init(),
rspkr.hl.html5.Events.onSyncReady()):null!=rspkr.HL.html5.lastlastlastevent&&null!=rspkr.HL.html5.lastlastevent&&null!=rspkr.HL.html5.lastevent&&"rshlsync"==a.data?(rspkr.HL.html5.synclist[rspkr.HL.html5.synclistindex]=[rspkr.HL.html5.lastlastlastevent.data,rspkr.HL.html5.lastlastevent.data,rspkr.HL.html5.lastevent.data],rspkr.HL.html5.synclistindex++):null!=rspkr.HL.html5.lastevent&&"rshlcontinue"==a.data?(rs.HL.chunking.continueHref=rspkr.HL.html5.lastevent.data,rs.HL.chunking.continueTime=rspkr.HL.html5.lastlastevent&&
!isNaN(rspkr.HL.html5.lastlastevent.data)?rspkr.HL.html5.lastlastevent.data:-1,/ios|android|windows phone/i.test(rspkr.c.data.browser.OS)&&(rspkr.HL.chunking.continueTime=-1)):"rshlresume"==a.data&&(rspkr.HL.html5.synclist.length=0,rspkr.HL.html5.synclistindex=0,rspkr.HL.html5.currentsynclistindex=0,rspkr.HL.html5.currentsyncindex=0)}rspkr.HL.html5.lastlastlastevent=rspkr.HL.html5.lastlastevent;rspkr.HL.html5.lastlastevent=rspkr.HL.html5.lastevent;rspkr.HL.html5.lastevent=a},refresh:function(){var a=
rspkr.PlayerAPI.playerRef,b=rspkr.HL.html5;if(a&&b.States.CURRENT!=b.States.STOPPED)if(b.States.CURRENT==b.States.NOT_PLAYING&&setTimeout(function(){b.refresh()},500),0<a.currentTime&&parseInt(b.lastcurrenttime)>parseInt(Math.ceil(a.currentTime)))rspkr.log("[rspkr.hl.html5.refresh] An error has occurred. Player is stopped.",2),rspkr.ui.getActivePlayer().stop(),b.runningRefresh=!1;else if(b.lastcurrenttime=a.currentTime,b.runningRefresh=!0,b.States.CURRENT==b.States.BEGIN)rspkr.hl.html5.States.setState(b.States.USER_START_NOT_READY),
setTimeout(function(){b.refresh()},200);else if(b.States.CURRENT==b.States.USER_START_NOT_READY)0<b.handlers.totalTime()&&(rspkr.HL.html5.rshlendCall||b.synclist[b.currentsyncindex]&&b.synclist[b.currentsyncindex][0]<1E3*b.handlers.totalTime())?(rspkr.hl.html5.States.setState(b.States.USER_START_PLAYING),rspkr.pl.playPromise(a),setTimeout(function(){b.refresh()},50)):0===b.handlers.totalTime()?(rspkr.pl.playPromise(a),setTimeout(function(){b.refresh()},250)):b.synclist[b.currentsyncindex]?20>=1*b.synclist[b.currentsyncindex][0]-
1E3*a.currentTime?setTimeout(function(){b.refresh()},0):(a=1*b.synclist[b.currentsyncindex][0]-1E3*a.currentTime-20,75<a?setTimeout(function(){b.refresh()},75):0>a?setTimeout(function(){b.refresh()},0):setTimeout(function(){b.refresh()},a)):setTimeout(function(){b.refresh()},75);else{if(b.States.CURRENT==b.States.USER_START_PLAYING){if(b.currentsyncindex===b.synclist.length-1&&0<b.synclist[b.currentsyncindex].length&&"rshlend"===b.synclist[b.currentsyncindex][1]){var f=b.synclist[b.currentsyncindex][0]-
1E3*a.currentTime;0>f&&(f=0);window.setTimeout(rspkr.hl.html5.Events.onEnded,f);b.currentsyncindex++}b.synclist[b.currentsyncindex]&&1*b.synclist[b.currentsyncindex][0]-20<1E3*a.currentTime&&(rspkr.HL.sync.execute(b.synclist[b.currentsyncindex][1],b.synclist[b.currentsyncindex][2]),b.currentsyncindex++);b.synclist[b.currentsyncindex]?20>=1*b.synclist[b.currentsyncindex][0]-1E3*a.currentTime?setTimeout(function(){b.refresh()},0):(a=1*b.synclist[b.currentsyncindex][0]-1E3*a.currentTime-20,75<a?setTimeout(function(){b.refresh()},
75):0>a?setTimeout(function(){b.refresh()},0):setTimeout(function(){b.refresh()},a)):setTimeout(function(){b.refresh()},75)}}else rspkr.log("[rspkr.hl.html5.refresh] Audio is undefined or player is stopped",2),b.runningRefresh=!1}},Preserve:{cls:".rs_preserve",testElem:null,elementShelter:[],formShelter:[],formData:function(a,b,f,c,e){this.name=a;this.type=b;this.value=f;this.checked=c;this.selectedIndex=e;this.selectedOptions=[]},moveToShelter:function(a){rspkr.HL.Preserve.cls=rspkr.cfg.item("general.preserveElements")?
rspkr.cfg.item("general.preserveElements"):rspkr.HL.Preserve.cls;rspkr.log("[rspkr.HL.Preserve.moveToShelter]");var b=[],f=[],c=null,e=[];if(a.childNodes){for(var k=$rs.findIn(a,rspkr.HL.Preserve.cls),k=$rs.isArray(k)?k:[k],c=0;c<k.length;c++)for(var p=c+1;p<k.length;p++)$rs.isArray($rs.findIn(k[c],k[p]))?$rs.isArray($rs.findIn(k[p],k[c]))||(k.splice(c,1),c--,p=k.length):(k.splice(p,1),p--);for(c=0;c<k.length;c++)e.push(k[c])}k=0;for(p=e.length;k<p;k++)c=$rs.get(e[k]).cloneNode(!1),e[k].parentNode.insertBefore(c,
e[k]),b.push($rs.detach(e[k]));rspkr.log("[rspkr.hl.Preserve] Moved "+k+" nodes to the shelter.");a=$rs.findIn(a,"input, select");for(k=0;k<a.length;k++){e=new rspkr.HL.Preserve.formData(a[k].name,a[k].type,a[k].value,a[k].checked,a[k].selectedIndex);if("select-multiple"==a[k].type){for(var c=a[k].options,p=[],g=0;g<c.length;g++)p.push(c[g].selected);e.selectedOptions=p}f.push(e)}rspkr.HL.Preserve.elementShelter.push(b);rspkr.HL.Preserve.formShelter.push(f)},restoreFromShelter:function(a){var b=[],
f,c;rspkr.log("[rspkr.HL.Preserve.restoreFromShelter]");if(rspkr.HL.Preserve.elementShelter.length&&(c=rspkr.HL.Preserve.elementShelter.shift(),c.length)){if(a.childNodes){var e=$rs.findIn(a,rspkr.HL.Preserve.cls),e=$rs.isArray(e)?e:[e];for(f=0;f<e.length;f++)for(var g=f+1;g<e.length;g++)$rs.isArray($rs.findIn(e[f],e[g]))?$rs.isArray($rs.findIn(e[g],e[f]))||(e.splice(f,1),f--,g=e.length):(e.splice(g,1),g--);for(f=0;f<e.length;f++)b.push(e[f])}e=0;for(g=b.length;e<g;e++)f=c.shift(),b[e].parentNode.insertBefore(f,
b[e]),b[e].parentNode.removeChild(b[e])}if(rspkr.HL.Preserve.formShelter.length&&(a=$rs.findIn(a,"input, select"),b=rspkr.HL.Preserve.formShelter.shift(),a.length&&b.length&&a.length===b.length))for(e=0;e<a.length;e++)if(a[e].name===b[e].name)switch(a[e].type){case "text":a[e].value=b[e].value;break;case "password":a[e].value=b[e].value;break;case "radio":!0===b[e].checked&&(a[e].checked=!0);break;case "checkbox":a[e].checked=b[e].checked;break;case "select-one":a[e].selectedIndex=b[e].selectedIndex;
break;case "select-multiple":for(c=a[e].options,f=0;f<c.length;f++)c[f].selected=b[e].selectedOptions[f]}},clearShelter:function(){rspkr.log("[rspkr.HL.Preserve.clearShelter]");rspkr.HL.Preserve.elementShelter=[];rspkr.HL.Preserve.formShelter=[]}},Restore:{Storage:{readClass:[],readId:[],restoreContent:[]},all:function(){rspkr.log("[rspkr.HL.Restore.all]");var a=rspkr.HL.Restore.Storage,b=[],f=null;if(!rspkr.cfg.item("general.premarkup")){rspkr.c.dispatchEvent("onBeforeContentChange",window);if(a.readId.length||
a.restoreContent.length||a.readClass.length){var f=$rs.flatten(a.readClass),c=$rs.flatten(a.readId);f&&(f=1<f.length||0===f.length?f:f[0].split(","));c&&(c=1<c.length||0===c.length?c:c[0].split(","));f=f.length?("."+f.join(",.")).split(","):[];f=c.length?f.concat(("#"+c.join(",#")).split(",")):f;if(rspkr.cfg.item("general.readidOrder")&&rspkr.cfg.item("general.usePost"))for(var c=0,e=f.length;c<e;c++)b.push($rs.get(f[c]));else b=$rs.get(f.join(","));b=$rs.flatten(b);$rs.isArray(b)||(b=[b]);for(c=
0;f=b[c];c++)!0===/sync_(word|sent)/gi.test(f.innerHTML)&&(rspkr.HL.Preserve.moveToShelter(f),f.innerHTML=a.restoreContent[c],rspkr.HL.Preserve.restoreFromShelter(f))}else rspkr.log("No stored content exists!",2);rspkr.c.dispatchEvent("onAfterContentChange",window)}a.readId.length=0;a.readClass.length=0},checkContent:function(){rspkr.log("[rspkr.hl.Restore.checkContent]",1);!1===this.hasMarkup()&&rspkr.hl.State.CURRENT==rspkr.hl.State.STOPPED&&rspkr.HL.Type.CURRENT==rspkr.HL.Type.SERVER_MARKUP&&(this.clearRestoreContent(),
this.setRestoreContent(),rspkr.pl.releaseAdapter(),rspkr.hl.State.setState(rspkr.hl.State.RELOAD))},hasMarkup:function(){var a=rspkr.HL.Restore.Storage,b=[],f=null,f=$rs.flatten(a.readClass),c=$rs.flatten(a.readId);f&&(f=1<f.length||0===f.length?f:f[0].split(","));c&&(c=1<c.length||0===c.length?c:c[0].split(","));f=f.length?("."+f.join(",.")).split(","):[];f=c.length?f.concat(("#"+c.join(",#")).split(",")):f;if(rspkr.cfg.item("general.readidOrder")&&rspkr.cfg.item("general.usePost"))for(c=0;c<f.length;c++){var e=
$rs.get(f[c]);$rs.isArray(e)&&0<e.length?b.concat(e):$rs.isArray(e)||b.push(e)}else b=$rs.get(f.join(","));$rs.isArray(b)||(b=[b]);if(b.length&&a.restoreContent.length)for(c=0;f=b[c];c++)if(/sync_(word|sent)/gi.test(f.innerHTML))return!0;return!1},clearRestoreContent:function(){rspkr.log("[rspkr.HL.Restore.clearRestoreContent] Called!")},setRestoreContent:function(){rspkr.log("[rspkr.HL.Restore.setRestoreContent] Called!");if("Explorer"===rs.c.data.browser.name&&9>=rs.c.data.browser.version)for(var a=
document.body.getElementsByTagName("style"),b=0,f;f=a[b];b++){f.parentNode.removeChild(f);document.getElementsByTagName("head")[0].appendChild(f);var c=f.innerHTML;if(-1!=c.indexOf("@import")){for(var e=c.split("\n"),g,p=0;c=e[p];p++)if("@import"===c.substring(0,7)){p=c.replace(/;/g,"").replace("@import ","").replace("url(","").replace(")","").replace(/\"/g,"").replace(/\'/g,"").split(" ");for(e=0;e<p.length;e++){var m=p[e].replace(/ /g,"");if(m){g=m;break}}break}f=f.sheet?f.sheet:f.styleSheet;f.insertRule?
f.insertRule(c,0):f.addImport&&f.addImport(g)}}a=rspkr.HL.Restore.Storage;b=[];g=a.restoreContent;0===a.readClass.length&&0===a.readId.length&&rspkr.HL.Restore.getReadData();if(0==a.readClass.length&&0==a.readId.length)rspkr.log("ERR: Could not set restore content or find the read area data",3);else{f=$rs.flatten(a.readClass);c=$rs.flatten(a.readId);f&&(f=1<f.length||0===f.length?f:f[0].split(","));c&&(c=1<c.length||0===c.length?c:c[0].split(","));f=f.length?("."+f.join(",.")).split(","):[];f=c.length?
f.concat(("#"+c.join(",#")).split(",")):f;if(rspkr.cfg.item("general.readidOrder")&&rspkr.cfg.item("general.usePost"))for(c=0,p=f.length;c<p;c++)b.push($rs.get(f[c]));else b=$rs.get(f.join(","));b=$rs.flatten(b);$rs.isArray(b)||(b=[b]);a.restoreContent=[];for(p=0;f=b[p];p++)!1===/sync_(word|sent|user)/gi.test(f.innerHTML)?a.restoreContent.push(f.innerHTML):0<g.length&&g[p]?a.restoreContent.push(g[p]):a.restoreContent.push(f.innerHTML)}},getReadData:function(){rspkr.log("[rspkr.HL.Restore.getReadData]");
var a=rspkr.HL.Restore.Storage,b;b=rspkr.ui.getActivePlayer()?$rs.findIn(rspkr.ui.getActivePlayer().getContainer(),".rsbtn_play"):$rs.findIn($rs.get("."+rs.ui.rsbtnClass),".rsbtn_play");$rs.isArray(b)||(b=[b]);for(var f=0,c=b.length;f<c;f++){var e=b[f].getAttribute("href").match(/readspeaker.?.com\/cgi-bin\/.*rsent/gi);rspkr.cfg.item("general.servercall")&&(e=e?e:-1<b[f].getAttribute("href").indexOf(rspkr.cfg.item("general.servercall")));b[f].getAttribute("href")&&-1!==(b[f].getAttribute("href").indexOf(rspkr.cfg.item("general.domain")+
"/cgi-bin/"+rspkr.cfg.item("general.rsent"))||e)&&"rsSaveBtn"!==b[f].id&&"rs_selimg"!==b[f].id&&(-1!==b[f].getAttribute("href").search(/readclass=/)&&(e=b[f].getAttribute("href").match(/readclass=[^&]+/gi)[0].replace("readclass=",""),e=e.split(","),rspkr.HL.Restore.Storage.readClass.push(e)),-1!==b[f].getAttribute("href").search(/readid=/)&&(e=b[f].getAttribute("href").match(/readid=[^&]+/gi)[0].replace("readid=",""),e=e.split(","),rspkr.HL.Restore.Storage.readId.push(e)))}0===a.readClass.length&&
0===a.readId.length&&(rspkr.c.data.params.hasOwnProperty("readid")&&rspkr.c.data.params.readid.length&&a.readId.push([rspkr.c.data.params.readid]),rspkr.c.data.params.hasOwnProperty("readclass")&&rspkr.c.data.params.readclass.length&&a.readClass.push([rspkr.c.data.params.readclass]))}},Scroll:{currentSpan:null,timer:null,useScroll:!1,userScrollTimer:null,stopped:!0,getScrollY:function(){var a=0;"number"==typeof document.pageYOffset?a=document.pageYOffset:document.documentElement&&document.documentElement.scrollTop&&
0<document.documentElement.scrollTop?a=document.documentElement.scrollTop:document.body&&document.body.scrollTop&&(a=document.body.scrollTop);return a},getWindowHeight:function(){var a=0;"number"==typeof window.innerHeight?a=window.innerHeight:document.documentElement&&document.documentElement.clientHeight&&0<document.documentElement.clientHeight?a=document.documentElement.clientHeight:document.body&&document.body.clientHeight&&(a=document.body.clientHeight);return a+30},userScroll:function(){rspkr.HL.Scroll.timer&&
(clearTimeout(rspkr.HL.Scroll.timer),rspkr.HL.Scroll.timer=null);rspkr.HL.Scroll.userScrollTimer&&clearTimeout(rspkr.HL.Scroll.userScrollTimer);rspkr.HL.Scroll.userScrollTimer=setTimeout(function(){rspkr.HL.Scroll.userScrollTimer=null},5E3)},stopTimer:function(){rspkr.log("[rspkr.Hl.Scroll.stopTimer] Called!");rspkr.HL.Scroll.timer&&(clearTimeout(rspkr.HL.Scroll.timer),rspkr.HL.Scroll.timer=null);rspkr.HL.Scroll.stopped=!0},initScroll:function(){"scrollon"==rspkr.Common.Settings.get("hlscroll")?(rspkr.log("[rspkr.HL.Sroll.initScroll] Scroll initiated!"),
rspkr.HL.Scroll.useScroll=!0,rspkr.evt("onUIClosePlayer",rspkr.HL.Scroll.stopTimer),rspkr.evt("onUIStop",rspkr.HL.Scroll.stopTimer),rspkr.evt("onUIPause",rspkr.HL.Scroll.stopTimer),rspkr.evt("onUISliderMove",rspkr.HL.Scroll.userScroll),rspkr.evt("onFocusIn",rspkr.HL.Scroll.userScroll),rspkr.evt("onFocusOut",rspkr.HL.Scroll.userScroll),document.addEventListener?document.addEventListener("scroll",function(){setTimeout(function(){rspkr.HL.Scroll.userScroll()},0)},!1):document.attachEvent?document.attachEvent("onscroll",
rspkr.HL.Scroll.userScroll):document.onscroll=rspkr.HL.Scroll.userScroll):this.useScroll=!1},execScroll:function(a){this.useScroll&&(this.currentSpan=a,!0===this.stopped&&(this.stopped=!1),this.timer||(rspkr.log("[rspkr.hl.Scroll] execScroll"),this.timer=setTimeout(function(){rspkr.HL.Scroll.timer=null;rspkr.HL.Scroll.triggerScroll(rspkr.HL.Scroll.currentSpan)},500)))},triggerScroll:function(a){rspkr.log("[rspkr.HL.Scroll.triggerScroll] timer: "+rspkr.hl.Scroll.userScrollTimer+", stopped: "+rspkr.HL.Scroll.stopped);
rspkr.HL.Scroll.userScrollTimer||!1!==rspkr.HL.Scroll.stopped||rspkr.u.scroll.scrollToElm(a)}},State:{CURRENT:1,READY:1,STOPPED:2,PLAYING:3,RELOAD:4,setState:function(a){rspkr.log("[rspkr.hl.html5.States.setState] Changing state from "+this.CURRENT+" to "+a,1);this.CURRENT=a}},sync:{init:function(){rspkr.c.dispatchEvent("onBeforeSyncInit",window);n.hlChanged=!1;if(0<rspkr.Common.data.selectedText.length||0<rspkr.Common.data.selectedHTML.length)rspkr.log("[rspkr.HL._sync.init] client markup"),rspkr.HL.Type.CURRENT=
rspkr.HL.Type.CLIENT_MARKUP,b.firstRun=1,"explorer"==a?document.selection.empty():(rspkr.HL.clientMarkup.processedDocument=rspkr.HL.clientMarkup.selectionDocument,b.preProcess.identifyElementsReplacementNode(rspkr.HL.clientMarkup.processedDocument.body||document.body));else if(rspkr.log("[rspkr.HL._sync.init] server markup"),rspkr.HL.Type.CURRENT=rspkr.HL.Type.SERVER_MARKUP,"none"!=rspkr.Common.data.sync){var g=[],l=[],f=[];rspkr.c.data.params.hasOwnProperty("readid")&&rspkr.c.data.params.readid.length&&
(f=f.concat(("#"+rspkr.c.data.params.readid.split(",").join(",#")).split(",")));rspkr.c.data.params.hasOwnProperty("readclass")&&rspkr.c.data.params.readclass.length&&(f=f.concat(("."+rspkr.c.data.params.readclass.split(",").join(",.")).split(",")));if(rspkr.cfg.item("general.readidOrder")&&rspkr.cfg.item("general.usePost"))for(var c=0;c<f.length;c++){var e=$rs.get(f[c]);$rs.isArray(e)&&0<e.length?g.concat(e):$rs.isArray(e)||g.push(e)}else g=$rs.get(f.join(","));$rs.isArray(g)||(g=[g]);if("flash"==
rspkr.PlayerAPI.adapter&&rspkr.HL.markedUpHTML.length!==g.length)for(f=rspkr.HL.markedUpHTML.join("").split("\x3c!--RSPEAK_STOP--\x3e"),c=0;f[c];c++);else f=rspkr.HL.markedUpHTML;for(c=0;e=g[c];c++)e=e.nodeName&&"TABLE"==e.nodeName?document.createElement("TABLE"):document.createElement("DIV"),e.innerHTML=f[c],l.push(e);rspkr.log("[rspkr.HL.sync.init] readElements length: "+g.length);if(!rspkr.cfg.item("general.premarkup")){rspkr.c.dispatchEvent("onBeforeContentChange",window);for(c=0;c<g.length;c++)rspkr.HL.Preserve.moveToShelter(g[c]),
g[c].innerHTML=l[c].innerHTML,rspkr.HL.Preserve.restoreFromShelter(g[c]);rspkr.c.dispatchEvent("onAfterContentChange",window);rspkr.HL.Preserve.clearShelter()}}rspkr.HL.markedUpHTML.length=0;rspkr.c.post.removeIframe();rspkr.c.dispatchEvent("onAfterSyncInit",window)},lightCleanUp:function(){rspkr.HL.customHL&&rspkr.HL.customHL.active()&&rspkr.HL.customHL.cleanUp();rspkr.log("[rspkr.HL._sync.lightCleanUp] Called! "+rspkr.HL.Type.CURRENT);rspkr.HL.Type.CURRENT==rspkr.HL.Type.CLIENT_MARKUP&&!0===n.hlChanged?
b.postProcess.settingsCleanUp():rspkr.HL.Type.CURRENT==rspkr.HL.Type.CLIENT_MARKUP&&!1===n.hlChanged||0<rspkr.Common.data.selectedText.length?b.postProcess.lightCleanUp():rspkr.HL.Type.CURRENT==rspkr.HL.Type.SERVER_MARKUP&&g.postProcess.lightCleanUp();rspkr.HL.html5.frameUrl=""},fullCleanUp:function(){rspkr.log("[rspkr.HL._sync.fullCleanUp] Called!");rspkr.HL.customHL&&rspkr.HL.customHL.active()&&rspkr.HL.customHL.cleanUp();rspkr.HL.Type.CURRENT==rspkr.HL.Type.CLIENT_MARKUP&&b.postProcess.fullCleanUp();
g.postProcess.fullCleanUp();rspkr.HL.clientMarkup.processedDocument=null},setId:function(a){rspkr.log("[rspkr.HL._sync.setId] Called!")},setClass:function(a){rspkr.log("[rspkr.HL._sync.setClass] Called!")},setContent:function(a){rspkr.log("[rspkr.HL._sync.setContent] Called!");rspkr.HL.markedUpHTML.push(a)},execute:function(a,b){var f=rspkr.Common.Settings;if("none"!==f.get("hl")&&"hloff"!==f.get("hltoggle")){if(rspkr.HL.Type.CURRENT==rspkr.HL.Type.SERVER_MARKUP){var c=$rs.hasClass($rs.get("#sync"+
b),"sync_sent")?"sent":"word";if("sent"===f.get("hl")&&"word"===c||"word"===f.get("hl")&&"sent"===c)return}rspkr.c.dispatchEvent("onBeforeSync",window,[a,b]);rspkr.HL.Type.CURRENT==rspkr.HL.Type.CLIENT_MARKUP?(f=rspkr.cfg.item("general.selectionEngine"),!f||"new"!==f&&"newcontent"!==f?rspkr.HL.clientMarkup.sync(a,b):rspkr.HL.clientMarkup.syncNew(a,b)):rspkr.HL.serverMarkup.sync(a,b);rspkr.c.dispatchEvent("onAfterSync",window,[a,b])}}},settings:n,Type:{CURRENT:0,DEFAULT:0,SERVER_MARKUP:1,CLIENT_MARKUP:2}}}();
rspkr.HL.engine||(rspkr.HL.engine={});
rspkr.HL.engine.explorer=function(){return{clientExtension:{firstRun:0,previousWord:{},previousSent:{},selectionRange:null,selectionHTML:null,selectedWordsRange:[],wordsRangeClasses:[],originalParentContent:"",originalParent:null,preProcess:{bookMarkIndex:1,endNode:null,endOffset:null,excludednodes:"table tr select option textarea ul ol dl thead tbody tfoot colgroup script map optgroup style noscript".split(" "),firstRun:0,inc:0,numberOfSelections:0,startNode:null,startOffset:null,init:function(){this.numberOfSelections++;
var a;a="new"===rspkr.cfg.item("general.selectionEngine")||"newcontent"===rspkr.cfg.item("general.selectionEngine")?this.buildMarkupNew(rspkr.Common.data.selectedRange):this.buildMarkup(rspkr.Common.data.selectedRange);a.replace(/  +/g," ");rspkr.Common.data.selectedHTML=a;rspkr.hl.clientMarkup.originalParent=rspkr.c.data.selectedRange.parentElement();rspkr.hl.clientMarkup.originalParentContent=rspkr.c.data.selectedRange.parentElement().innerHTML},buildMarkup:function(a){for(var b=rspkr.c.data.getParam("lang"),
g=!1,m=null,n=rspkr.cfg.item("general.sentOnlyLang"),h=0;h<n.length;h++)if(b&&b.toLowerCase()===n[h]){g=!0;break}var b=a.duplicate(),h=0,n="",l=1,f=0,c=0,e="",k="",p=null;a.moveStart("word",-1);a.moveStart("word",1);b.isEqual(a)||a.moveStart("word",-1);b=a.duplicate();a.moveEnd("word",1);a.moveEnd("word",-1);b.isEqual(a)||a.moveEnd("word",1);rspkr.HL.clientMarkup.selectionRange=a.duplicate();var r=a.parentElement(),v=a.duplicate();v.collapse(!1);b=a.duplicate();b.collapse();for(g&&(m=a.text.split(new RegExp(decodeURIComponent("%e3%80%81")+
"|"+decodeURIComponent("%e3%80%82")+"|"+decodeURIComponent("%DB%94")+"|"+decodeURIComponent("%D8%8C"))));a.inRange(b)&&0!=a.compareEndPoints("EndToEnd",b);){c++;h++;if(1E4<h)break;if(g)if(b=a.duplicate(),m[c-1])b.findText(m[c-1]);else break;else b.collapse(!1),b.expand("word",1);k=e="";v.collapse(!1);var q=b.duplicate();q.collapse(!1);if(0==v.compareEndPoints("StartToStart",q)&&0==v.compareEndPoints("EndToEnd",q)&&q.htmlText==v.htmlText&&/\W/.test(q.text)){f++;if(2>f)b.move("character",1);else if(4>
f)b.move("character",2);else if(6>f)b.move("word",1);else if(8>f)b.move("word",2);else if(10>f)b.move("sentence",1);else if(12>f)b.move("sentence",2);else break;b.collapse(!1)}else{f=0;if(-1===c)return b;rspkr.HL.clientMarkup.selectedWordsRange[c]=b.duplicate();v=b.text;q=b.htmlText;b.collapse(!1);var x;1===l?(p=b.duplicate(),x=this.iterateParentTree(p.parentElement(),document.body,r,0)):x=this.iterateParentTree(b.parentElement(),p.parentElement(),r,0);for(var w=this.iterateParentTree(p.parentElement(),
b.parentElement(),r,0),t=b.parentElement(),u=0;u<x&&20>u;u++)t.className.match("sync_")||(e=t.outerHTML.match("<[^>]*>")[0]+e),t=t.parentElement;t=p.parentElement();for(u=0;u<w&&20>u;u++)t.className.match("sync_")||(k+="</"+t.tagName+">"),t=t.parentElement;if(0!=x||0!=w)p=b.duplicate();1===l?(n+=e,l=0):n+=k+e;""!=q.replace("sync_sent_highlighted","")&&(e=c,k=$rs.get("#sync"+c),$rs.isArray(k)&&0<k.length&&(e=Math.floor(1E3*Math.random()+1E3)),n+="<"+rspkr.Common.data.browser.syncContainer+' class="sync_user" id="sync'+
e+'">'+v+"</"+rspkr.Common.data.browser.syncContainer+">");v=b.duplicate()}}n+="\x3c!-- f --\x3e";w=this.iterateParentTree(p.parentElement(),document.body,r,0);t=p.parentElement();for(u=0;u<w;u++)t.className.match("sync_")||(n+="</"+t.tagName+">"),t=t.parentElement;b.collapse();return n},buildMarkupNew:function(a){for(var b=rspkr.c.data.getParam("lang"),g=!1,m=rspkr.cfg.item("general.sentOnlyLang"),n=0;n<m.length;n++)if(b&&b.toLowerCase()===m[n]){g=!0;break}var b=a.duplicate(),m="",h=1,l=0,f=0,c=
"",e="",k="",p=null,n=0;rspkr.HL.clientMarkup.selectionRange=a.duplicate();var r=a.parentElement(),v=a.duplicate(),k=a.duplicate();v.collapse(!1);b.collapse();var q=[],x=k.duplicate(),c=k.duplicate();k.moveStart("sentence",-1);k.moveStart("sentence",1);x.isEqual(k)||k.moveStart("sentence",-1);x=k.duplicate();k.moveEnd("sentence",1);k.moveEnd("sentence",-1);x.isEqual(k)||k.moveEnd("sentence",1);x=k.duplicate();c.collapse(!0);for(k.collapse(!0);x.inRange(k)&&0!=x.compareEndPoints("EndToEnd",k);){c.expand("sentence",
1);if(!0===c.isEqual(k)||0===c.compareEndPoints("EndToEnd",k))break;k.expand("sentence",1);q.push(c.duplicate())}for(;!1===a.inRange(q[0])&&0!=a.compareEndPoints("StartToStart",q[0]);)q[0].moveStart("word",1);for(;!1===a.inRange(q[q.length-1])&&0!=a.compareEndPoints("EndToEnd",q[q.length-1]);)q[q.length-1].moveEnd("word",-1);for(x=0;x<q.length;x++){for(k="";q[x].inRange(b)&&0!=q[x].compareEndPoints("EndToEnd",b);){f++;n++;if(1E4<n)break;g?(b=a.duplicate(),b.findText(null[f-1])):(b.collapse(!1),b.expand("word",
1));e=c="";v.collapse(!1);var w=b.duplicate();w.collapse(!1);if(0==v.compareEndPoints("StartToStart",w)&&0==v.compareEndPoints("EndToEnd",w)&&w.htmlText==v.htmlText){l++;if(2>l)b.move("character",1);else if(4>l)b.move("character",2);else if(6>l)b.move("word",1);else if(8>l)b.move("word",2);else if(10>l)b.move("sentence",1);else if(12>l)b.move("sentence",2);else break;b.collapse(!1)}else{l=0;if(-1===f)return b;rspkr.HL.clientMarkup.selectedWordsRange[f]=b.duplicate();rspkr.HL.clientMarkup.wordsRangeClasses[f]=
"word";v=b.text;w=b.htmlText;b.collapse(!1);var t;1===h?(p=b.duplicate(),t=this.iterateParentTree(p.parentElement(),document.body,r,0)):t=this.iterateParentTree(b.parentElement(),p.parentElement(),r,0);for(var u=this.iterateParentTree(p.parentElement(),b.parentElement(),r,0),y=b.parentElement(),z=0;z<t&&20>z;z++)y.className.match("sync_")||(c=y.outerHTML.match("<[^>]*>")[0]+c),y=y.parentElement;y=p.parentElement();for(z=0;z<u&&20>z;z++)y.className.match("sync_")||(e+="</"+y.tagName+">"),y=y.parentElement;
if(0!=t||0!=u)p=b.duplicate();1===h?(k+=c,h=0):k+=e+c;""!=w.replace("sync_sent_highlighted","")&&(c=f,e=$rs.get("#sync"+f),$rs.isArray(e)&&0<e.length&&(c=Math.floor(1E3*Math.random()+1E3)),k+="<"+rspkr.Common.data.browser.syncContainer+' class="sync_user sync_word" id="sync'+c+'">'+v+"</"+rspkr.Common.data.browser.syncContainer+">");v=b.duplicate()}}f++;rspkr.HL.clientMarkup.selectedWordsRange[f]=q[x];rspkr.HL.clientMarkup.wordsRangeClasses[f]="sent";c=f;e=$rs.get("#sync"+f);$rs.isArray(e)&&0<e.length&&
(c=Math.floor(1E3*Math.random()+1E3));m+="<"+rspkr.Common.data.browser.syncContainer+' class="sync_user sync_sent" id="sync'+c+'">';m+=k;m+="</"+rspkr.Common.data.browser.syncContainer+">\n"}u=this.iterateParentTree(p.parentElement(),document.body,r,0);y=p.parentElement();for(z=0;z<u;z++)y.className.match("sync_")||(m+="</"+y.tagName+">"),y=y.parentElement;b.collapse();return m},iterateParentTree:function(a,b,g,m){for(var n=b;null!==n;){if(a==g||a==n)return m;n=n.parentElement}m++;return this.iterateParentTree(a.parentElement,
b,g,m)}},postProcess:{lightCleanUp:function(){rspkr.log("[clientMarkup.postProcess.lightCleanUp] called!");for(var a=rspkr.Common.data.browser.syncContainer.replace(/(:|\.|\[|\]|,)/g,"\\$1"),b=$rs.get(a+".sync_sent,"+a+".sync_word,"+a+".sync_sent_highlighted,"+a+".sync_word_highlighted,"+a+".sync_user,"+a+".synctemp,"+a+'[class*="ffsent"]'),b=$rs.isArray(b)?b:[b],a=b.length-1;-1<a;a--)b[a].className=b[a].className.replace("sync_sent_highlighted","sync_sent"),b[a].className=b[a].className.replace("sync_word_highlighted",
"sync_word"),-1===b[a].className.toLowerCase().indexOf("sync_user")&&(b[a].removeAttribute("id"),b[a].removeAttribute("color"));var b=rspkr.HL.clientMarkup.previousWord.range,g=rspkr.HL.clientMarkup.previousWord.forecolor,m=rspkr.HL.clientMarkup.previousWord.backcolor,n=rspkr.HL.clientMarkup.previousSent.range,h=rspkr.HL.clientMarkup.previousSent.forecolor,l=rspkr.HL.clientMarkup.previousSent.backcolor;if(b&&0<b.length)for(var a=0,f=b.length;a<f;a++)null!==m[a]&&(b[a].execCommand("backcolor",0,m[a]),
null!==g[a]&&b[a]&&b[a].execCommand("forecolor",0,g[a]));if(b&&0<n.length)for(a=0,f=n.length;a<f;a++)null!==l[a]&&(n[a].execCommand("backcolor",0,l[a]),null!==h[a]&&n[a]&&n[a].execCommand("forecolor",0,h[a]));rspkr.hl.clientMarkup.lastWord=null},settingsCleanUp:function(){this.lightCleanUp()},fullCleanUp:function(){rspkr.log("[ClientMarkup.postProcess.fullCleanUp] called!");if(null===rspkr.hl.clientMarkup.originalParent)this.lightCleanUp();else{var a=rspkr.hl.clientMarkup.originalParent;rspkr.hl.Preserve.moveToShelter(a);
a.innerHTML=rspkr.hl.clientMarkup.originalParentContent;rspkr.hl.Preserve.restoreFromShelter(a)}rspkr.hl.clientMarkup.selectedWordsRange=[];rspkr.hl.clientMarkup.selectionRange=null;rspkr.hl.clientMarkup.originalParentContent="";rspkr.hl.clientMarkup.originalParent=null;rspkr.hl.clientMarkup.lastWord=null}},sync:function(a,b){var g=!1,m;0===(a&2)&&(g=0!=(a&1)?!0:!1);1===this.firstRun&&(this.previousWord.range=[],this.previousWord.backcolor=[],this.previousWord.forecolor=[],this.previousSent.range=
[],this.previousSent.backcolor=[],this.previousSent.forecolor=[]);m=this.selectedWordsRange[b];if(1===this.firstRun){this.firstRun=0;if(0<this.previousSent.range.length){for(var n=0,h=this.previousSent.range.length;n<h;n++)this.previousSent.range[n].execCommand("backcolor",0,this.previousSent.backcolor[n]),null!==this.previousSent.forecolor[n]&&this.previousSent.range[n].execCommand("forecolor",0,this.previousSent.forecolor[n]);this.previousSent.range=[];this.previousSent.backcolor=[];this.previousSent.forecolor=
[]}rspkr.HL.clientMarkup.selectionRange&&"wordsent"===rspkr.st.get("hl")&&(this.previousSent.range.push(rspkr.HL.clientMarkup.selectionRange),this.previousSent.backcolor.push(rspkr.HL.clientMarkup.selectionRange.queryCommandValue("backcolor")),this.previousSent.forecolor.push(rspkr.HL.clientMarkup.selectionRange.queryCommandValue("forecolor")),this.selectionRange.execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent")),this.selectionRange.execCommand("forecolor",0,rspkr.Common.Settings.get("hltext")))}if(!g&&
0<this.previousWord.range.length){for(n=0;n<this.previousWord.range.length;n++)"word"==rspkr.st.get("hl")||"sent"==rspkr.st.get("hl")?this.previousWord.range[n].execCommand("backcolor",0,this.previousWord.backcolor[n]):this.previousWord.range[n].execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent")),this.previousWord.range[n].execCommand("forecolor",0,this.previousWord.forecolor[n]);this.previousWord.range=[];this.previousWord.backcolor=[];this.previousWord.forecolor=[]}this.previousWord.backcolor.push(m.queryCommandValue("backcolor"));
this.previousWord.forecolor.push(m.queryCommandValue("forecolor"));this.previousWord.range.push(m);"sent"==rspkr.st.get("hl")?(rspkr.HL.customHL&&rspkr.HL.customHL.active()&&rspkr.HL.customHL.sentHL(m,a),m.execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent"))):(rspkr.HL.customHL&&rspkr.HL.customHL.active()&&rspkr.HL.customHL.wordHL(m,a),m.execCommand("backcolor",0,rspkr.Common.Settings.get("hlword")));this.lastWord=m;rspkr.HL.customHL&&rspkr.HL.customHL.active();m.execCommand("forecolor",
0,rspkr.Common.Settings.get("hltext"))},syncNew:function(a,b){var g=!1;0===(a&2)&&(g=0!=(a&1)?!0:!1);1===this.firstRun&&(this.previousWord.range=[],this.previousWord.backcolor=[],this.previousWord.forecolor=[],this.previousSent.range=[],this.previousSent.backcolor=[],this.previousSent.forecolor=[],this.firstRun=0);var m=this.selectedWordsRange[b];if(m&&"word"===this.wordsRangeClasses[b]&&("word"==rspkr.st.get("hl")||"wordsent"==rspkr.st.get("hl"))){if(0<this.previousWord.range.length&&!g){for(g=0;g<
this.previousWord.range.length;g++)"word"==rspkr.st.get("hl")||"sent"==rspkr.st.get("hl")?this.previousWord.range[g].execCommand("backcolor",0,this.previousWord.backcolor[g]):this.previousWord.range[g].execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent")),this.previousWord.range[g].execCommand("forecolor",0,this.previousWord.forecolor[g]);this.previousWord.range=[];this.previousWord.backcolor=[];this.previousWord.forecolor=[]}this.previousWord.backcolor.push(m.queryCommandValue("backcolor"));
this.previousWord.forecolor.push(m.queryCommandValue("forecolor"));this.previousWord.range.push(m);m.execCommand("backcolor",0,rspkr.Common.Settings.get("hlword"));this.lastWord=m;m.execCommand("forecolor",0,rspkr.Common.Settings.get("hltext"))}else if(m&&"sent"===this.wordsRangeClasses[b]&&("sent"==rspkr.st.get("hl")||"wordsent"==rspkr.st.get("hl"))){if(0<this.previousWord.range.length){for(g=0;g<this.previousWord.range.length;g++)this.previousWord.range[g].execCommand("backcolor",0,this.previousWord.backcolor[g]),
this.previousWord.range[g].execCommand("forecolor",0,this.previousWord.forecolor[g]);this.previousWord.range=[];this.previousWord.backcolor=[];this.previousWord.forecolor=[]}if(0<this.previousSent.range.length){for(g=0;g<this.previousSent.range.length;g++)this.previousSent.range[g].execCommand("backcolor",0,this.previousSent.backcolor[g]),this.previousSent.range[g].execCommand("forecolor",0,this.previousSent.forecolor[g]);this.previousSent.range=[];this.previousSent.backcolor=[];this.previousSent.forecolor=
[]}this.previousSent.backcolor.push(m.queryCommandValue("backcolor"));this.previousSent.forecolor.push(m.queryCommandValue("forecolor"));this.previousSent.range.push(m);m.execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent"));m.execCommand("forecolor",0,rspkr.Common.Settings.get("hltext"))}}}}}();
rspkr.HL.engine.gecko=function(){return{clientExtension:{preProcess:{bookMarkIndex:1,endNode:null,endOffset:null,excludednodes:"table tr select option textarea ul ol dl thead tbody tfoot colgroup script map optgroup style noscript".split(" "),firstRun:0,inc:0,numberOfSelections:0,startNode:null,startOffset:null,init:function(){this.numberOfSelections++;var a="",a=rspkr.Common.data.selectedRange;this.startNode=a.startContainer;this.endNode=a.endContainer;this.startOffset=this.modifyOffsetStartOfWord(this.startNode,
a.startOffset);this.endOffset=this.modifyOffsetEndOfWord(this.endNode,a.endOffset);a=this.buildMarkup(a.commonAncestorContainer);a.replace(/  +/g," ");window.getSelection().removeAllRanges();rspkr.Common.data.selectedHTML=a},buildMarkup:function(a){this.firstRun=1;var b="",g=this.inc;if(3==a.nodeType)b+=this.textMarkup(a);else{var m,n="";if(a.hasChildNodes())for(m=0;m<a.childNodes.length;m++){var h=a.childNodes.item(m);h==this.startNode&&(this.inc=1);a==this.startNode&&m==this.startOffset&&(this.inc=
1);8!=h.nodeType&&(n+=this.buildMarkup(h));if(a==this.endNode&&m==this.endOffset){this.inc=0;break}if(h==this.endNode){this.inc=0;break}}m=!0;null!=$rs.getAttr(a,"id")&&(m=$rs.getAttr(a,"id").replace("sync")===$rs.getAttr(a,"id"));(g||this.inc)&&(!a.className||"string"===typeof a.className&&a.className.replace("sync")===a.className&&m)?(g=document.createElement("div"),g.appendChild(a.cloneNode(!0)),tempdivtag=g.innerHTML.match("<[^>]*>"),null!==tempdivtag&&0<tempdivtag.length?(b+=tempdivtag[0],b=
b+n+("</"+a.nodeName+">")):b+=n):b+=n;if(a.hasChildNodes())for(m=0;m<a.childNodes.length;m++){if(a===this.endNode&&m===this.endOffset){this.inc=0;break}if(h===this.endNode){this.inc=0;break}}}return b},textMarkup:function(a){var b=!0,g="",m,n="",h="",l=a.nodeValue;a===this.startNode&&-1!==this.startOffset&&a===this.endNode&&-1!==this.endOffset?(n=a.nodeValue.substring(0,this.startOffset),l=a.nodeValue.substring(this.startOffset,this.endOffset),h=a.nodeValue.substring(this.endOffset),this.inc=1):a===
this.startNode&&-1!==this.startOffset?(n=a.nodeValue.substring(0,this.startOffset),l=a.nodeValue.substring(this.startOffset),this.inc=1):a===this.endNode&&-1!==this.endOffset&&(l=a.nodeValue.substring(0,this.endOffset),h=a.nodeValue.substring(this.endOffset),this.inc=1);if(!this.inc)return"";for(m=0;m<this.excludednodes.length;m++)if(a.parentNode&&a.parentNode.nodeName.toLowerCase()===this.excludednodes[m]){b=!1;g=this.htmlencode(l);break}b&&(g=rspkr.cfg.item("general.selectionEngine"),g=!g||"new"!==
g&&"newcontent"!==g?this.markupSentences(this.htmlencode(l),null):this.markupSentencesNew(this.htmlencode(l),null));a===this.endNode&&-1!==this.endOffset&&(this.inc=0);if(rs.cfg.item("general.enableSkipAlways")){m=a;for(var f=!1;m.parentNode;){if(/rs_skip_always/i.test(m.className)){f=!0;break}m=m.parentNode}f&&(g='<span class="rs_skip_always">'+g+"</span>")}b&&null!==a.parentNode&&""!==l&&(b=this.createreplacementnode(n+g+h,getComputedStyle(a.parentNode,null)),a.parentNode.insertBefore(b,a),a.parentNode.removeChild(a));
return g},markupSentencesNew:function(a){a=this.splitString(a,[", ",". ","! ","? ",decodeURIComponent("%e3%80%81"),decodeURIComponent("%e3%80%82"),decodeURIComponent("%DB%94"),decodeURIComponent("%D8%8C")]);if(!a)return"";for(var b="",g="",m=!1,n=0;n<a.length;n++)b+="<"+rspkr.Common.data.browser.syncContainer+' class="sync_user sync_sent cj'+this.numberOfSelections+'" ',b+='id="sync'+this.bookMarkIndex++ +'">',this.endsWithSpace(a[n])?(m=!0,g=a[n].slice(0,-1)):g=a[n],b+=this.markupWords(g),b+="</"+
rspkr.Common.data.browser.syncContainer+">",!0===m&&(b+=" "),m=!1;return b},markupSentences:function(a){a=this.splitString(a,[", ",". ","! ","? ",decodeURIComponent("%e3%80%81"),decodeURIComponent("%e3%80%82"),decodeURIComponent("%DB%94"),decodeURIComponent("%D8%8C")]);if(!a)return"";for(var b="",g="",m=!1,n=0;n<a.length;n++)b+="<"+rspkr.Common.data.browser.syncContainer+' class="ffsent'+this.numberOfSelections+" cj"+this.numberOfSelections+'" ',b+='id="sync'+this.bookMarkIndex++ +'">',this.endsWithSpace(a[n])?
(m=!0,g=a[n].slice(0,-1)):g=a[n],b+=this.markupWords(g),!0===m&&(b+=" "),b+="</"+rspkr.Common.data.browser.syncContainer+">",m=!1;return b},markupWords:function(a){a=this.splitString(a," ");if(!a)return"";for(var b="",g="",m=!1,n=0;n<a.length;n++)b+="<"+rspkr.Common.data.browser.syncContainer+' class="sync_user sync_word ck'+this.numberOfSelections+'"',b+=' id="sync'+this.bookMarkIndex++ +'">',this.endsWithSpace(a[n])?(m=!0,g=a[n].slice(0,-1)):g=a[n],b+=g,b+="</"+rspkr.Common.data.browser.syncContainer+
">",!0===m&&(b+=" "),m=!1;return b},trim:function(a){return a.replace(/^\s+|\s+$/g,"")},htmlencode:function(a){var b=rspkr.HL.clientMarkup.processedDocument||document,g=b.createElement("div");a=b.createTextNode(a);g.appendChild(a);return g.innerHTML},identifyElementsReplacementNode:function(a){a.tagName&&a.tagName.toLowerCase()==rspkr.Common.data.browser.syncContainer&&a.id&&(rspkr.HL.clientMarkup.selectedWordsRange[a.id]=a);if(a.hasChildNodes())for(var b=0;b<a.childNodes.length;b++)this.identifyElementsReplacementNode(a.childNodes[b])},
createreplacementnode:function(a,b){var g=(rspkr.HL.clientMarkup.processedDocument||document).createElement(rspkr.Common.data.browser.syncContainer);g.innerHTML=a;g.setAttribute("class","synctemp cl"+this.numberOfSelections);return g},modifyOffsetStartOfWord:function(a,b){for(var g=[" ",", ",". ","! ","? ",decodeURIComponent("%e3%80%81"),decodeURIComponent("%e3%80%82"),decodeURIComponent("%DB%94"),decodeURIComponent("%D8%8C")];a.nodeValue&&0!=b;){for(var m=0;m<g.length;m++)if(breakstr=g[m],0==a.nodeValue.substring(b).indexOf(breakstr))return b;
b--}return b},modifyOffsetEndOfWord:function(a,b){for(var g=[" ",", ",". ","! ","? ",decodeURIComponent("%e3%80%81"),decodeURIComponent("%e3%80%82"),decodeURIComponent("%DB%94"),decodeURIComponent("%D8%8C")];a.nodeValue&&b!=a.nodeValue.length;){for(var m=0;m<g.length;m++)if(breakstr=g[m],0==a.nodeValue.substring(b-1).indexOf(breakstr))return b;b++}return b},returnClassArraySubstring:function(a){return(rspkr.HL.clientMarkup.processedDocument||document).querySelectorAll("."+a)},splitString:function(a,
b){for(var g=[""],m=0,n=0;n<a.length;n++){for(var h=0;h<b.length;h++){for(var l=b[h],f=!0,c=0;c<l.length;c++)if(0>a.length-(n+c)||l[l.length-c-1]!=a[n-c-1]){f=!1;break}f&&(m++,g[m]="")}g[m]+=a[n]}return g},endsWithSpace:function(a){return-1!==a.indexOf(" ",a.length-1)}},postProcess:{cleanUpSpans:function(){rspkr.log("[ClientMarkup.postProcess.cleanUpSpans] called!");var a=rspkr.Common.data.browser.syncContainer.replace(/(:|\.|\[|\]|,)/g,"\\$1"),a=(rspkr.HL.clientMarkup.processedDocument||document).querySelectorAll(a+
".sync_sent,"+a+".sync_word,"+a+".sync_sent_highlighted,"+a+".sync_word_highlighted,"+a+".sync_user,"+a+".synctemp,"+a+'[class*="ffsent"]'),b;for(i=a.length-1;-1<i;i--)b=document.createDocumentFragment(),b.textContent=a[i].textContent,a[i].parentNode.replaceChild(b,a[i])},lightCleanUp:function(){rspkr.log("[ClientMarkup.postProcess.lightCleanUp] called!!");var a=rspkr.Common.data.browser.syncContainer.replace(/(:|\.|\[|\]|,)/g,"\\$1"),a=(rspkr.HL.clientMarkup.processedDocument||document).querySelectorAll(a+
".sync_sent,"+a+".sync_word,"+a+".sync_sent_highlighted,"+a+".sync_word_highlighted,"+a+".sync_user,"+a+".synctemp,"+a+'[class*="ffsent"]');for(i=a.length-1;-1<i;i--)rspkr.HL.chunking.continueHref||(a[i].className=a[i].className.replace("sync_sent_highlighted","sync_sent")),a[i].className=a[i].className.replace("sync_word_highlighted","sync_word"),rspkr.HL.chunking.continueHref||-1!==a[i].className.toLowerCase().indexOf("sync_user")||a[i].removeAttribute("id")},settingsCleanUp:function(){rspkr.log("[ClientMarkup.postProcess.settingsCleanUp] called!");
var a=rspkr.HL.clientMarkup.previousWord.element,b=rspkr.HL.clientMarkup.previousWord.className,g=rspkr.HL.clientMarkup.previousSent.element,m=rspkr.HL.clientMarkup.previousSent.className;if(0<a.length){for(var n in a)a[n].className=b[n];rspkr.HL.clientMarkup.previousWord.element=[];rspkr.HL.clientMarkup.previousWord.className=[]}if(0<g.length){for(n in g)g[n].className=m[n];rspkr.HL.clientMarkup.previousSent.element=[];rspkr.HL.clientMarkup.previousSent.className=[]}},fullCleanUp:function(){rspkr.log("[ClientMarkup.postProcess.fullCleanUp] called!");
var a=rspkr.HL.clientMarkup.previousWord.element,b=rspkr.HL.clientMarkup.previousWord.className,g=rspkr.HL.clientMarkup.previousSent.element,m=rspkr.HL.clientMarkup.previousSent.className;if("undefined"!==typeof a&&"undefined"!==typeof b&&"undefined"!==typeof g&&"undefined"!==typeof m){if(0<a.length){for(var n in a)a[n].className=b[n];rspkr.HL.clientMarkup.previousWord.element=[];rspkr.HL.clientMarkup.previousWord.className=[]}if(0<g.length){for(n in g)g[n].className=m[n];rspkr.HL.clientMarkup.previousSent.element=
[];rspkr.HL.clientMarkup.previousSent.className=[]}this.cleanUpSpans();rspkr.Common.data.selectedHTML=""}}},sync:function(a,b){var g=!1,m;0==(a&2)&&(g=0!=(a&1)?!0:!1);1==this.firstRun&&(this.previousWord.element=[],this.previousWord.className=[],this.previousSent.element=[],this.previousSent.className=[]);if(m=this.selectedWordsRange["sync"+b]){if(m.className.replace("word","")!=m.className){rspkr.log("inside");if(0<this.previousWord.element.length&&0<this.previousWord.className.length&&!g){for(g=
0;g<this.previousWord.element.length;g++)this.previousWord.element[g].className=this.previousWord.className[g];this.previousWord.element=[];this.previousWord.className=[]}this.previousWord.element.push(m);this.previousWord.className.push(m.className);"sent"===rspkr.st.get("hl")?m.className=m.className.replace("sync_sent","sync_user sync_sent_highlighted"):(rspkr.HL.customHL&&rspkr.HL.customHL.active()&&rspkr.HL.customHL.wordHL(m,a),m.className=m.className.replace("sync_word","sync_user sync_word_highlighted"))}m&&
rspkr.HL.Scroll.execScroll(m);if(1==this.firstRun){this.firstRun=0;if(0<this.previousSent.element.length){for(g=0;g<this.previousSent.element.length;g++)this.previousSent.element[g].className=this.previousSent.className[g];this.previousSent.element=[];this.previousSent.className=[]}if("wordsent"==rspkr.st.get("hl"))for(m=this.preProcess.returnClassArraySubstring("ffsent"+this.preProcess.numberOfSelections+" "),g=0;g<m.length;g++)this.previousSent.element[g]=m[g],this.previousSent.className[g]=m[g].className,
m[g].className="ffsent"+this.preProcess.numberOfSelections+" sync_sent_highlighted"}}},syncNew:function(a,b){var g;1==this.firstRun&&(this.previousWord.element=[],this.previousWord.className=[],this.previousSent.element=[],this.previousSent.className=[],this.firstRun=0);g=(rspkr.HL.clientMarkup.processedDocument||document).getElementById("sync"+b);if(g.className.replace("word","")!=g.className&&("word"===rspkr.st.get("hl")||"wordsent"===rspkr.st.get("hl"))){if(0<this.previousWord.element.length&&
0<this.previousWord.className.length){for(var m=0;m<this.previousWord.element.length;m++)this.previousWord.element[m].className=this.previousWord.className[m];this.previousWord.element=[];this.previousWord.className=[]}this.previousWord.element.push(g);this.previousWord.className.push(g.className);g.className="sync_user sync_word_highlighted"}else if(g.className.replace("sent","")!=g.className&&("sent"===rspkr.st.get("hl")||"wordsent"===rspkr.st.get("hl"))){if(0<this.previousSent.element.length&&
0<this.previousSent.className.length){for(m=0;m<this.previousSent.element.length;m++)this.previousSent.element[m].className=this.previousSent.className[m];this.previousSent.element=[];this.previousSent.className=[]}this.previousSent.element.push(g);this.previousSent.className.push(g.className);g.className=g.className.replace("sync_sent","sync_user sync_sent_highlighted")}g&&rspkr.HL.Scroll.execScroll(g)}}}}();
ReadSpeaker.ui=function(){var a=null,b=[],g=[],m=!1,n=function(a){a=a||window.event;a.returnValue=!1;if(a=a.originalEvent)a.cancelBubble=!0,a.returnValue=!1;a&&a.preventDefault&&a.preventDefault();a&&a.stopPropagation&&a.stopPropagation()},h=function(){rspkr.log("[rspkr.ui] Attempting to add click events.");var a=$rs.get("."+rspkr.ui.rsbtnClass+" .rsbtn_play"),b=null;$rs.isArray(a)||(a=[a]);for(var c=0,e=a.length;c<e;c++)if($rs.unregEvent(a[c],"click",ReadSpeakerDefer.clickhandler),b=a[c]?$rs.getAttr(a[c],
"data-rsevent-id"):"_bogus_",rspkr.l.f.eq.store[b]&&rspkr.l.f.eq.store[b].click)rspkr.log("[rspkr.ui] Click event already existed on "+a[c],2);else{$rs.regEvent(a[c],"click",function(a){n(a);window.readpage(this)});rspkr.ui.addFocusHandler(a[c],!0,a[c].parentNode);rspkr.log("[rspkr.ui] Added click event to: "+a[c],1);try{$rs.getAttr(a[c],"role")||$rs.setAttr(a[c],"role","button")}catch(f){rspkr.log("[rspkr.ui] Could not add role attribute.",2)}}},l=function(a){for(var b=$rs.get("a"),c=0,e=b.length;c<
e;c++)if(b[c].href&&b[c].href==a)return b[c];return!1},f=function(a){for(var c in b)if(b[c]&&b[c].getContainer&&b[c].getContainer()==a)return b[c];a=new rspkr.ui.Player(a);b.push(a);return a},c=function(){rspkr.log("[rspkr.ui] Initiating global callbacks");rspkr.ui.rsbtnClass=rspkr.cfg.item("ui.rsbtnClass")||"rsbtn";window.readpage=function(a,b){if(rspkr.ui.initrun){if(/android|windows phone/i.test(window.navigator.userAgent)){var c=window.rspkr;c.audio=new Audio;rspkr.pl.playPromise(c.audio,void 0,
void 0,!0)}rspkr.ui.showPlayer(a,b)}};window.rshlexit=function(b){rspkr.HL.chunking.destroy();void 0!==b&&"false"!==b||a.stop();setTimeout(function(){rspkr.c.dispatchEvent("onAfterSyncExit",window)},1E3)};window.rshlinit=A().sync.init;window.rshlsetContent=A().sync.setContent;window.rshlsetId=A().sync.setId;window.rshlsync=function(a,b){for(var c=a.split(","),e=b.split(","),f=0,D=a.length;f<D;f++)A().sync.execute(c[f],e[f])};window.rshlcontinue=function(){function a(b){if(!rspkr.HL.chunking.entracte.src){b=
encodeURIComponent(decodeURIComponent(rs.cfg.getPhrase(b)));var c={noads:1},e;for(e in rspkr.c.data.params)rspkr.c.data.params.hasOwnProperty(e)&&(c[e]=rspkr.c.data.params[e]);e=rspkr.Common.data.selectedText;var f=rspkr.Common.data.selectedHTML;rspkr.Common.data.selectedText=b;rspkr.Common.data.selectedHTML="";c.text=b;c.output="audio";b=rspkr.c.buildReadSpeakerCall(c);rspkr.HL.chunking.entracte.src=b;rspkr.Common.data.selectedText=e;rspkr.Common.data.selectedHTML=f}rspkr.HL.chunking.entracte.volume=
parseFloat((rspkr.st.get("hlvol")||100)/100);rspkr.pl.playPromise(rspkr.HL.chunking.entracte)}if(rspkr.HL.chunking){rspkr.log("[rspkr.ui.rshlcontinue]");rspkr.HL.chunking.chunkEnded=!0;var b=$rs.get("#sync"+rspkr.HL.html5.synclist[rspkr.HL.html5.synclist.length-2][2]);$rs.isArray(b)&&!b.length?(b=0,document.body&&document.body.scrollTop?b=document.body.scrollTop:document.documentElement&&document.documentElement.scrollTop?b=document.documentElement.scrollTop:window.pageYOffset&&(b=window.pageYOffset),
b={left:rs.ui.viewport.width/2,top:rs.ui.viewport.height/2+b}):b=$rs.offset(b);if(rspkr.HL.chunking.continueHref){var c=rspkr.cfg.item("cb.chunking.pause",void 0,!0);if(-1==rspkr.HL.chunking.continueTime)if(rspkr.log("[rspkr.ui.rshlcontinue] Waiting for user interaction"),rs.ui.getActivePlayer().pause(),$rs.addClass(rspkr.ui.getActivePlayer().getContainer(),"rsautopaused"),a("chunkcontinue"),c&&"function"==typeof c)rspkr.log("[rspkr.ui.rshlcontinue] Running custom callback",3),c();else{rspkr.log("[rspkr.ui.rshlcontinue] Showing default continue button");
c=document.createElement("div");c.innerHTML=rspkr.cfg.item("ui.popupbutton").join("");$rs.addClass(c,rspkr.ui.rsbtnClass+" rspopup rsresume");var e=$rs.findIn(c,"a");e.removeAttribute("href");$rs.regEvent(e,"click",function(a){rspkr.c.dispatchEvent("onChunkResume",window)});$rs.findIn(e,".rsbtn_text").innerHTML="<span>"+rs.cfg.getPhrase("chunkbutton")+"</span>";document.body.appendChild(c);c.style.display="block";b.left+=15;e=b.left+$rs.width(c)-$rs.width(window);0<e&&(b.left-=e);c.style.left=b.left+
"px";c.style.top=b.top+15+"px"}else 0==rspkr.HL.chunking.continueTime?(rspkr.log("[rspkr.ui.rshlcontinue] Autoplay"),rspkr.c.dispatchEvent("onChunkResume",window)):isNaN(rspkr.HL.chunking.continueTime)?rspkr.log("[rshlcontinue] Invalid time parameter!",3):(rspkr.log("[rspkr.ui.rshlcontinue] Autoplay with "+rspkr.HL.chunking.continueTime+" seconds delay"),5<=rspkr.HL.chunking.continueTime&&a("chunkwait"),c&&"function"==typeof c&&c(rspkr.HL.chunking.continueTime),rspkr.HL.chunking.stall=!0,setTimeout(function(){rspkr.HL.chunking.stall=
!1},1E3*rspkr.HL.chunking.continueTime),rspkr.HL.chunking.timer=setTimeout(function(){rspkr.c.dispatchEvent("onChunkResume",window)},1E3*rspkr.HL.chunking.continueTime))}else rspkr.log("[rshlcontinue] No continue href found!")}};var b=[];b.push(document);if(rspkr.cfg.item("iframeReading"))for(var c=document.getElementsByTagName("iframe"),e=0;e<c.length;e++)if(null!==c[e]&&void 0!==c[e])try{null!==c[e].contentWindow&&null!==c[e].contentWindow.document&&b.push(c[e].contentWindow.document)}catch(f){rspkr.log("Error accessing iframe"+
f,"3")}var g=rspkr.c.data.browser;if(g&&(/iphone|ipad|ios|android|windows phone/i.test(g.OS)||"android"==g.name.toLowerCase()))$rs.regEvent(document.body,"touchstart",function(a){rspkr.ui.setPointerPos(a);return!0}),$rs.regEvent(document.body,"touchend",function(a){rspkr.ui.setPointerPos(a);rspkr.c.data.setSelectedText(a);return!0}),$rs.regEvent(document,"selectionchange",function(a){rspkr.c.data.setSelectedText(a);return!0});else for(c=0;c<b.length;c++)e=b[c],$rs.regEvent(e.body,"mousedown",function(a){rspkr.ui.setPointerPos(a);
return!0}),$rs.regEvent(e.body,"mouseup",function(a){"opera"===g.name.toLowerCase()?setTimeout(function(){rspkr.c.data.setSelectedText(a)},50):rspkr.c.data.setSelectedText(a);return!0}),$rs.regEvent(window,"mouseup",function(a){"opera"===g.name.toLowerCase()?setTimeout(function(){rspkr.c.data.setSelectedText(a)},50):rspkr.c.data.setSelectedText(a);return!0}),$rs.regEvent(e.body,"keydown",rspkr.ui.setPointerPos),$rs.regEvent(e.body,"keyup",function(a){rspkr.c.data.setSelectedText(a);return!0})},e=
function(){document.removeEventListener?document.removeEventListener("click",window.ReadSpeakerDefer.clickhandler,!1):document.detachEvent&&document.detachEvent("onclick",window.ReadSpeakerDefer.clickhandler);if(ReadSpeakerDefer.deferred){var a=ReadSpeakerDefer.deferred,b=null;if("a"!=a.tagName.toLowerCase()){for(b=a;"body"!=b.tagName.toLowerCase()&&(b=b.parentNode,"a"!=b.tagName.toLowerCase()););a=b}ReadSpeakerDefer.isRSLink(a)&&(rspkr.log("[rspkr.ui] Activating deferred element: "+a),$rs.removeClass(a.parentNode,
"rsdeferred"),rspkr.ui.showPlayer(a));ReadSpeakerDefer.deferred=null}},k=function(b,c,e){rspkr.log("[rspkr.ui.showPlayer]");e=e||!1;var g="string"==typeof b?l(b):b,p=g?$rs.closest(g,".rsexpanded"):void 0;if((p=$rs.hasClass(p,"pre-expanded")?void 0:p)&&!$rs.isArray(p)&&rspkr.ui.getActivePlayer()&&1==rspkr.HL.chunking.currentChunkNumber&&rspkr.ui.getActivePlayer().getContainer()==p)rspkr.HL.newPlayback=!1,rspkr.log("Player already active, calling Player.restart() instead"),rspkr.ui.getActivePlayer().restart();
else{rspkr.HL.lpSelection&&rspkr.HL.sync.fullCleanUp();0<rspkr.c.data.selectedText.length?(rspkr.HL.lpSelection=!0,rspkr.HL.newPlayback=!0,rspkr.HL.sync.lightCleanUp()):rspkr.HL.lpSelection?(rspkr.HL.lpSelection=!1,rspkr.HL.newPlayback=!0):(rspkr.HL.lpSelection=!1,rspkr.HL.newPlayback=!1);rspkr.HL.chunking.destroy();rspkr.HL.chunking&&rspkr.HL.chunking.html5support&&(rspkr.HL.chunking.entracte=new Audio,/safari|ios|ipad|iphone|ipod|android|windows phone/i.test(window.navigator.userAgent)&&rspkr.pl.playPromise(rspkr.HL.chunking.entracte,
void 0,void 0,!0));rspkr.c.dispatchEvent("onBeforeParamsSet",window,[g]);var p="string"==typeof b?b:$rs.getAttr(g,"href"),h=null;"string"==typeof b&&(h=p.match(/readid=[^&]+/gi),b=p.match(/readclass=[^&]+/gi),h&&0<h.length&&rspkr.HL.Restore.Storage.readId.push(h[0].replace("readid=","").split(",")),b&&0<b.length&&rspkr.HL.Restore.Storage.readClass.push(b[0].replace("readclass=","").split(",")));rspkr.c.data.selectedHTML="";rspkr.c.data.setParams(p);void 0!==$rs.getAttr(g,"data-target")&&null!==$rs.getAttr(g,
"data-target")&&(h=$rs.getAttr(g,"data-target"),h=$rs.get(h),"object"===typeof h&&(c=h));c&&!e?(h=$rs.get(c),$rs.addClass(h,rspkr.ui.rsbtnClass+" rsfloating"),rspkr.basicMode&&($rs.removeClass(h,"rshidden"),$rs.addClass(h,rspkr.ui.rsbtnClass+" rsvisible"))):h=$rs.closest(g,"div."+rspkr.ui.rsbtnClass);if(!0===rspkr.cfg.item("survey.allowed")){c=rspkr.c.cookie;e=rspkr.cfg.item("survey.cookieName")||"rspkrsurvey";g=rspkr.cfg.item("survey.cookieLifetime")||15552E6;b=rspkr.c.data.params;if("1"===c.readKey(e,
"nmbrdisplays")){rspkr.ui.Lightbox.show(rspkr.cfg.item("survey.url")+"?customerid="+b.customerid+"&lang="+b.lang,rspkr.st.r().replaceTokens(rspkr.cfg.item("ui.survey.buttons").join(),{rsSURVEY_BUTTON_CLOSErs:rspkr.cfg.getPhrase("close")}),!0,function(a){$rs.regEvent($rs.get("#rssurvey_button_close"),"click",rspkr.u.Lightbox.hide)},500);rspkr.log(c.updateKey(e,"nmbrdisplays","displayed",g),4);return}void 0===c.readKey(e,"nmbrdisplays")&&rspkr.log(c.updateKey(e,"nmbrdisplays","1",g),4)}c=f(h);if(a&&
a!=c||a&&p!==a.getHref())a.close(!0),rspkr.c.dispatchEvent("onUIClosePlayer",a.getContainer(),[0<rspkr.c.data.selectedText.length?"textsel":"nosel"]);e=(e=a)?e.getID():null;rspkr.c.dispatchEvent("onUIShowPlayer",window,[e,c.getID()]);c.setHref(p);a=c;c.show();return a}},p=function(b,c){c=c||a.getContainer();var e=$rs.findIn(c,".rsbtn_status");0===e.length&&(e=document.createElement("span"),e.className="rsbtn_status_overlay",e.innerHTML='<span class="rsbtn_status"></span>',$rs.findIn(c,".rsbtn_exp").appendChild(e),
e=$rs.findIn(c,".rsbtn_status"));$rs.css($rs.findIn(c,".rsbtn_status_overlay"),"display","block");if("nosound"===b)b='<a class="rsbtn_nosound">'+rspkr.cfg.getPhrase("nosound")+"</a>",e.innerHTML=b,(e=$rs.findIn(c,".rsbtn_nosound"))&&$rs.regEvent(e,"click",function(b){return a.nosound()});else if("loaderror"===b){var f=rspkr.c.data.getSaveData("link"),g=document.createElement("a");g.className="rsbtn_loaderror";g.innerHTML=rspkr.cfg.getPhrase("nosoundlink")||"[?]";g.href=f;$rs.regEvent(g,"click",function(a){rspkr.ui.Lightbox.show("<iframe src='"+
g.href+"' style='height:100%'></iframe>",null,!1,null,300);n(a)});e.innerHTML=rspkr.cfg.getPhrase("loaderror")||"An error has occurred, try again";e.appendChild(g)}else e.innerHTML=b},r=function(a,b,c){c=c||a;void 0===b&&(b=!0);$rs.focusIn&&"function"==typeof $rs.focusIn&&($rs.focusIn(a,function(){$rs.addClass(c,"rsfocus");!0===b&&(v=a);rspkr.Common.dispatchEvent("onFocusIn",window,[a,c])}),$rs.focusOut(a,function(){$rs.removeClass(c,"rsfocus");rspkr.Common.dispatchEvent("onFocusOut",window,[a,c])}))},
v=null,q=function(){v&&$rs.isVisible(v)&&(rspkr.log("[rspkr.ui.updateFocus] "+v.outerHTML),x(v))},x=function(a){$rs.focus&&"function"==typeof $rs.focus&&a&&$rs.focus(a)},w=function(a){if("iconon"==rspkr.st.get("hlicon")&&!m){var b=g.push(new u)-1;g[b].id=b;g[b].show(a);m=!0}},t=function(a){"iconon"==rspkr.st.get("hlicon")&&m&&(g.pop().hide(),m=!1)},u=function(){var a=0,b=0,c=null,e=52,f=null,p=null,h=null,l=function(a){a=a||c;$rs.addClass(a,rspkr.ui.rsbtnClass+" rspopup");rspkr.cfg.item("general.useCompactPopupButton")&&
$rs.addClass(a,"rscompact")},k=function(a){$rs.unregEvent(c,"mouseout",r);window.clearTimeout(f);var b,e=c.clientWidth+10,g;p=rspkr.ui.showPlayer(h,c,!0);g=p.getWidth();b=parseInt($rs.offset(c).left);(b=rspkr.ui.viewport.width+$rs.scrollLeft(document)-b)<g&&(b=parseInt($rs.css(c,"left"))-(g-(e-10)),$rs.css(c,"left",b+"px"));m=!1;$rs.unregEvent(h,"click",k);$rs.regEvent(h,"click",function(a){n(a);return p.restart()});n(a);return!1},r=function(a){f||(f=window.setTimeout(function(){x()},rspkr.cfg.item("general.popupCloseTime")||
2E3))},q=function(a){f&&(window.clearTimeout(f),f=null)},v=function(a,b){$rs.css(c,{top:b+"px",left:a+"px",width:e+"px"})},x=function(){$rs.css(c,{display:"none",top:0,left:0});q();g.splice(null,1);m=!1;c.parentElement.removeChild(c)};(function(){var a=rspkr.c.findFirstRSButton();c=document.createElement("div");c.id=rspkr.getID();c.innerHTML=rspkr.cfg.item("ui.popupbutton").join("");l();h=$rs.findIn(c,".rsbtn_play");$rs.setAttr(h,"href",a?$rs.getAttr(a,"href"):null);(a=rspkr.cfg.item("general.popupHref"))&&
$rs.setAttr(h,"href",a);var a=$rs.getAttr(h,"href").match(/lang=([^&;]*)/i).pop(),b=$rs.findIn($rs.get(c),".rsbtn_play span.rsbtn_text span");b&&(b.textContent=b.innerText=rspkr.cfg.getPhrase("listen",a,"en_us"));$rs.setAttr(h,"title",rspkr.cfg.getPhrase("listentoselectedtext",a,"en_us"));$rs.regEvent(h,"click",k);document.body.appendChild(c)})();return{setPos:v,show:function(f){q(f);if(f&&"none"==$rs.css(c,"display")){var g=c.cloneNode(!0);g.id=rspkr.getID();$rs.css(g,{display:"block",position:"absolute",
top:0,left:0});document.body.appendChild(g);e=$rs.outerWidth(g)+3;document.body.removeChild(g);g=f.pageX||f.clientX+document.body.scrollLeft||rspkr.ui.pointerX;f=f.pageY||f.clientY+document.body.scrollTop||rspkr.ui.pointerY;b=f>rspkr.ui.pointerY?f-$rs.scrollTop(document)+36>rspkr.ui.viewport.height-46?f-66:f+30:10>f-$rs.scrollTop(document)-66?f+30:f-51;a=10>g-$rs.scrollLeft(document)?g+10:g-$rs.scrollLeft(document)>rspkr.ui.viewport.width-(e+10)?rspkr.ui.viewport.width+$rs.scrollLeft(document)-(e+
10):g+0;v(a,b)}$rs.regEvent(c,"mouseout",r);$rs.regEvent(c,"mouseover",q);r(null);l();$rs.css(c,"display","block")},hide:x,id:null}},y={update:function(b,c,e){"hlspeed"===b&&c!==e&&(b=b.replace("hl",""),rspkr.c.converter[b]&&"function"==typeof rspkr.c.converter[b]&&(c=rspkr.c.converter[b](c)),rspkr.c.data[b]=c,a&&a.stop(),rspkr.pl.releaseAdapter())}},z=function(a,b,c,e,f,g){$rs.css(a,"background-color","rgb("+b+","+c+","+e+")");e<f?(e+=10,window.setTimeout(function(){z(a,b,c,e,f,g)},50)):g&&"function"===
typeof g&&g.apply(a,[])},A=function(){return rspkr.XP?rspkr.XP:rspkr.HL};_expand=function(a){"string"==typeof a&&(a=$rs.get(a));$rs.isArray(a)||(a=[a]);for(var b=0;b<a.length;b++)rspkr.ui.Player(a[b]).show(!0)};_animate=function(){var a=rs.cfg.item("ui.animate");if(a){var b,c=15,e=500;"object"==typeof a?(a.id&&(b=$rs.get(a.id)),a.count&&(c=a.count),a.interval&&(e=a.interval)):"string"===typeof a&&(b=$rs.get(a));if("boolean"===typeof a&&a||$rs.isArray(b)&&0==b.length||!b)b=$rs.get("."+rs.ui.rsbtnClass);
$rs.isArray(b)||(b=[b]);var f=c,g=setInterval(function(){0==f&&($rs.removeClass(b,"rsanimate"),clearInterval(g));1==f--%2?$rs.addClass(b,"rsanimate"):$rs.removeClass(b,"rsanimate")},e)}};return{meta:{revision:"6672"},initrun:!1,init:function(){var a=rspkr.Common.addEvent;a("onAfterModsLoaded",c);a("onReady",h);a("onReady",e);a("onReady",_animate);a("onSelectedText",w);a("onDeselectedText",t);a("onSettingsChanged",y.update);a("onAfterSyncInit",q);this.initrun=!0;rspkr.Common.dispatchEvent("onUIInitialized");
rspkr.log("[rspkr.ui] Initialized!")},addFocusHandler:function(a,b,c){r(a,b,c)},focus:function(a){x(a)},updateFocus:function(){q()},showOverlay:function(a,b){p(a,b)},settings:y,rsbtnClass:"",addClickEvents:function(){h()},initGlobalCallbacks:function(){c()},showPopupIcon:function(a){w(a)},processDeferred:function(){e()},showPlayer:function(a,b,c){return k(a,b,c)},expand:function(a){_expand(a)},pointerX:0,pointerY:0,setPointerPos:function(a){a.pageX&&(rspkr.ui.pointerX=a.pageX);a.pageY&&(rspkr.ui.pointerY=
a.pageY);a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches[0]&&a.originalEvent.touches[0].pageX&&(rspkr.ui.pointerX=a.originalEvent.touches[0].pageX);a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches[0]&&a.originalEvent.touches[0].pageY&&(rspkr.ui.pointerY=a.originalEvent.touches[0].pageY);return!0},viewport:{width:$rs.width(window),height:$rs.height(window)},popups:g,hl:function(a,b){window.setTimeout(function(){z(a,255,255,100,255,b)},200)},scroll:{INTERVAL:null,
STEPS:25,scrollToElm:function(a){$rs.isVisible(a)&&this.initScroll(a)},scrollToAnchor:function(a){for(var b=$rs.get("a"),c=null,e=0;e<b.length;e++){var f=b[e];if(f.name&&f.name==a){c=f;break}}this.initScroll(c)},initScroll:function(a){if(a){if(rspkr.cfg.item("ui.extendedAutoScroll"))for(var b=a.parentElement;b!==document.body;){if(b.scrollHeight>b.clientHeight){var c="Explorer"==rspkr.c.data.browser.name&&7>=rspkr.c.data.browser.version?a.offsetTop:a.offsetTop-b.offsetTop;if(b.scrollTop>c||c+a.offsetHeight>
b.clientHeight){var e=b.scrollTop,f=c-e,g;if(window.requestAnimationFrame)window.requestAnimationFrame(function E(a){g||(g=a);a-=g;var c=Math.min(a/1E3,1);b.scrollTop=e+f*c;1E3>a&&window.requestAnimationFrame(E)});else{clearInterval(rspkr.u.scroll.INTERVAL);var p=b.scrollTop,h=(c-p)/rspkr.u.scroll.STEPS,l=0;rspkr.u.scroll.INTERVAL=setInterval(function(){b.scrollTop=p+l*h;l++;l>=rspkr.u.scroll.STEPS&&(b.scrollTop=c,clearInterval(rspkr.u.scroll.INTERVAL))},10)}}if(b.clientHeight<$rs.height(window))rspkr.u.scroll.scrollToElm(b);
else break;return}b=b.parentElement}for(var k=a.offsetTop,m=a;m.offsetParent&&m.offsetParent!=document.body;)m=m.offsetParent,k+=m.offsetTop;k-=50;rs.cfg.item("ui.autoscrollOffset")&&!isNaN(rs.cfg.item("ui.autoscrollOffset"))&&(k-=rs.cfg.item("ui.autoscrollOffset"));clearInterval(rspkr.u.scroll.INTERVAL);var m=rspkr.u.scroll.getCurrentYPos(),n=parseInt((k-m)/rspkr.u.scroll.STEPS);rspkr.u.scroll.INTERVAL=setInterval(function(){rspkr.u.scroll.scrollWindow(n,k,a)},10)}else document.location.hash=a},
getCurrentYPos:function(){return document.body&&document.body.scrollTop?document.body.scrollTop:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:window.pageYOffset?window.pageYOffset:0},scrollWindow:function(a,b,c){b=Math.max(b,0);var e=rspkr.u.scroll.getCurrentYPos(),f=e<b,g=!1;if("iOS"===rspkr.c.data.browser.OS){var p=document.body.getBoundingClientRect(),h=p.width==screen.width?screen.height:screen.width;b>p.height-h&&(b=p.height-h,g=!0)}window.scrollTo(0,
e+a);a=rspkr.u.scroll.getCurrentYPos();if(f!=a<b||e==a||g)window.scrollTo(0,b),clearInterval(rspkr.u.scroll.INTERVAL),"string"==typeof c&&(location.hash=c)}},activePlayer:a,getActivePlayer:function(){return a}}}();
ReadSpeaker.ui.Slider=function(){var a=this,b={handleClass:"",width:0,height:0,left:0,top:0,steps:-1,stepsize:-1,dir:"h",initval:-1,drop:null,start:null,dragging:null,click:null,labelDragHandle:"",labelStart:"",labelEnd:"",nudge:1},g={rsid:void 0,parent:void 0,ref:void 0},m=void 0,n=void 0,h=void 0,l=void 0,f=void 0,c=!1,e=0,k=function(a){a=a||window.event;a.returnValue=!1;if(a=a.originalEvent)a.cancelBubble=!0,a.returnValue=!1;a&&a.preventDefault&&a.preventDefault();a&&a.stopPropagation&&a.stopPropagation()};
this.initElement=function(a){if(!c){"string"==typeof a&&(a=document.getElementById(a));a.innerHTML+='<a href="javascript:void(0);" role="slider" class="keyLink" style="display:block; border:0;">&#160;</a>';var f=a.getElementsByTagName("a"),f=f[f.length-1],h=-1<b.steps?b.steps:100;f.relatedElement=a;$rs.setAttr(f,"title",b.labelDragHandle);try{$rs.setAttr(f,"aria-label",b.labelDragHandle),$rs.setAttr(f,"aria-orientation","h"==b.dir?"horizontal":"vertical"),$rs.setAttr(f,"aria-valuemin",0),$rs.setAttr(f,
"aria-valuemax",h),$rs.setAttr(f,"aria-valuenow",b.initval||0)}catch(l){}e=b.initval;$rs.regEvent(a,"mousedown",this.startDragMouse);$rs.regEvent(f,"click",function(a){k(a)});$rs.regEvent(f,"keyup",this.startDragKeys);$rs.regEvent(f,"dragstart",function(a){k(a)});$rs.regEvent(a,"touchstart",this.touchStart);$rs.regEvent(g.parent,"mousedown",this.mouseClick)}};this.mouseClick=function(e){if(!c&&!$rs.hasClass(g.ref,"dragged")){var f=a.findPos(e.target),k=e.clientX-(f.left-b.left);e=e.clientY-(f.top-
b.top);h=f.left;l=f.top;f=a.getCurrentVal({left:k,top:e});"function"==typeof b.click&&b.click(f,g);return!1}};this.findPos=function(a){var b=curTop=0;if(a.offsetParent){do b+=a.offsetLeft,curTop+=a.offsetTop;while(a=a.offsetParent);return{left:b,top:curTop}}};this.startDragMouse=function(b){rspkr.log("[rspkr.ui.Slider] startDragMouse");if(!c){a.startDrag(this);var e=b||window.event;m=e.clientX;n=e.clientY;$rs.regEvent(document.body,"mousemove",a.dragMouse);$rs.regEvent(document.body,"mouseup",a.releaseElement)}k(b);
return!1};this.startDragKeys=function(b){rspkr.log("[rspkr.ui.Slider] startDragKeys "+(b||window.event).keyCode);a.startDrag(this.relatedElement);$rs.regEvent(document.body,"keydown",a.dragKeys);$rs.regEvent(document.body,"keypress",a.switchKeyEvents);$rs.addClass(this.relatedElement,"rskeycontrolled");k(b)};this.touchStart=function(b){b=b.originalEvent;rspkr.log("[rspkr.ui.Slider] touchStart");c||(a.startDrag(b.target),m=b.touches[0].pageX,n=b.touches[0].pageY,$rs.regEvent(b.target,"touchmove",a.touchMove),
$rs.regEvent(b.target,"touchend",a.releaseElement));return!1};this.startDrag=function(c){rspkr.log("[rspkr.ui.Slider] startDrag");f&&a.releaseElement();h=c.offsetLeft;l=c.offsetTop;f=c;$rs.addClass(f,"dragged");"function"==typeof b.start&&b.start(g)};this.dragMouse=function(b){b=b||window.event;a.setPosition(b.clientX-m,b.clientY-n);a.valueChanged=!0;return!1};this.touchMove=function(b){b=b.originalEvent?b.originalEvent:b;k(b);a.setPosition(b.touches[0].pageX-m,b.touches[0].pageY-n);a.valueChanged=
!0;return!1};this.dragKeys=function(c){switch((c||window.event).keyCode){case 37:case 63234:a.valueChanged=!0;e-=b.nudge;break;case 38:case 63232:a.valueChanged=!0;e+=b.nudge;break;case 39:case 63235:a.valueChanged=!0;e+=b.nudge;break;case 40:case 63233:a.valueChanged=!0;e-=b.nudge;break;case 13:case 27:return a.releaseElement(),!1;case 9:return a.releaseElement(),!0;default:return rspkr.log("[rspkr.ui.Slider] return TRUE"),!0}!0===a.valueChanged&&(rspkr.c.dispatchEvent("onUISliderMove"),"function"==
typeof b.dragging&&b.dragging(a.getCurrentVal({skipValueCalculation:!0}),g));k(c);rspkr.log("[rspkr.ui.Slider] ready to return!");return!1};this.setPosition=function(c,e){var k,m=!1;k=c;var n=h,w=b.left,t=b.width,u="left";"v"==b.dir&&(k=e,n=l,w=b.top,t=b.height,u="top");k=n+k;-1<b.stepsize&&((k+w)%b.stepsize?k=b.stepsize*Math.ceil(k/b.stepsize)+w:m=!0);k>t+w?k=t+w:k<w&&(k=w);m||(f.style[u]=k+"px","function"==typeof b.dragging&&b.dragging(a.getCurrentVal(),g))};this.switchKeyEvents=function(){$rs.unregEvent(document.body,
"keydown",a.dragKeys);$rs.unregEvent(document.body,"keypress",a.switchKeyEvents);$rs.regEvent(document.body,"keypress",a.dragKeys)};this.releaseElement=function(){rspkr.log("[rspkr.ui.Slider] releaseElement");$rs.unregEvent(document.body,"mousemove",a.dragMouse);$rs.unregEvent(document.body,"mouseup",a.releaseElement);$rs.unregEvent(document.body,"keypress",a.dragKeys);$rs.unregEvent(document.body,"keypress",a.switchKeyEvents);$rs.unregEvent(document.body,"keydown",a.dragKeys);$rs.unregEvent(f,"touchmove",
a.touchMove);$rs.unregEvent(f,"touchend",a.releaseElement);$rs.removeClass(f,"dragged");$rs.removeClass(f,"rskeycontrolled");$rs.removeClass(f,"rsmousecontrolled");var c=a.getCurrentVal();f=null;"function"==typeof b.drop&&!0===a.valueChanged&&b.drop(c,g);a.valueChanged=!1;rs.ui.getActivePlayer()&&rs.ui.getActivePlayer().setProgress();return!1};this.getCurrentVal=function(a){var c,f=b.width;c="left";var h=b.left;"v"==b.dir&&(f=b.height,c="top",h=b.top);var k=-1<b.steps?b.steps:100,f=-1<b.stepsize?
b.stepsize:f/k;a=a?a[c]:$rs.css(g.ref,c).replace(/px/i,"");pos=Math.round(a)-h;c=Math.round(pos/f);"v"==b.dir&&(c=k-c);rspkr.log("[rspkr.ui.Slider] currentval: "+c);return a&&a.skipValueCalculation||isNaN(c)?e=Math.max(Math.min(e,k),0):e=c};return{init:function(c,e){"string"==typeof c&&(c=document.getElementById(c));if(c){var f=c.id||"data-readspeaker-slider-id-"+Math.floor(2E4*Math.random());c.setAttribute&&c.setAttribute("data-readspeaker-slider-id-","data-readspeaker-slider-parent-"+f);var h={width:function(){return $rs.width(c)},
height:function(){return $rs.height(c)}};if("object"==typeof e)for(var k in e)e.hasOwnProperty(k)&&void 0!==b[k]&&(b[k]=e[k]);k=!1;var l;"rsbtn_volume_slider"===c.className&&"jquery"===rspkr.l.f.currentLib()&&1.5>parseFloat(jQuery.fn.jquery)&&(l=c.parentNode.style.display,c.parentNode.style.display="block",k=!0);b.width=h.width();b.height=h.height();k&&(c.parentNode.style.display=l);-1<b.steps&&(b.stepsize=("h"==b.dir?b.width:b.height)/b.steps);h=document.createElement("span");h.setAttribute("data-readspeaker-slider-id-",
f);h.className=b.handleClass||"rsbtn_progress_handle rsimg";c.appendChild(h);g.rsid=f;g.parent=c;g.ref=h;f=$rs.css(h,"left");null!==f&&(b.left=parseInt(f.replace(/px/i,"")));f=$rs.css(h,"top");null!==f&&(b.top=parseInt(f.replace(/px/i,"")));-1<b.initval&&this.jumpTo(b.initval);b.labelStart&&(f=document.createElement("span"),f.className="slider-label-start",f.innerHTML=b.labelStart,c.appendChild(f));b.labelEnd&&(f=document.createElement("span"),f.className="slider-label-end",f.innerHTML=b.labelEnd,
c.appendChild(f));a.initElement(h)}},jumpTo:function(a){if(isNaN(a))return!1;var c=101,e=a;-1<b.steps&&(a=Math.round(a),c=b.steps+1);if(-1<a&&a<c){var f=b.width,h=b.left,k="left";"v"==b.dir&&(f=b.height,h=b.top,k="top",a=c-1-a);g.ref.style[k]=f/(c-1)*a+h+"px";$rs.setAttr($rs.findIn(g.ref,"a.keyLink"),"aria-valuenow",e)}},setCurrentValue:function(a){e=a},getInstance:function(){return g},getContainer:function(){return g.parent},releaseElement:function(){a.releaseElement()},startDragKeys:function(b,
c){a.startDragKeys.call(b,c)},disabled:function(){if(arguments)c=arguments[0];else return c}}};
ReadSpeaker.ui.Player=function(a){var b=function(a){a=a||window.event;a.returnValue=!1;if(a=a.originalEvent)a.cancelBubble=!0,a.returnValue=!1;a&&a.preventDefault&&a.preventDefault();a&&a.stopPropagation&&a.stopPropagation()},g=function(b){b=b||a;b=$rs.clone(b,!0,!0);var c;b.id=rspkr.getID();document.body.appendChild(b);$rs.css(b,{position:"absolute",top:"0",left:"0",display:"block",width:"auto"});$rs.css(b,"float","none");$rs.addClass(b,"rsexpanded");c=$rs.outerWidth(b)+3;b.style.display="none";
document.body.removeChild(b);return c},m=rspkr.getID(),n=this,h=[],l=0,f=!1,c=null,e=!1,k={_play:null,_pause:null,_stop:null,_vol:null,_settings:null,_dl:null,_closer:null,_powered:null,_get:function(b,c){var e;b="_"+b;e=a?this[b]&&0<this[b].length?this[b]:this[b]=$rs.findIn(a,c):null;return e==[]?null:e},play:function(){return this._get("play",".rsbtn_play")},pause:function(){return this._get("pause",".rsbtn_pause")},stop:function(){return this._get("stop",".rsbtn_stop")},vol:function(){return this._get("vol",
".rsbtn_volume")},settings:function(){return this._get("settings",".rsbtn_settings")},dl:function(){return this._get("dl",".rsbtn_dl")},pin:function(){return this._get("pin",".rsbtn_pin")},powered:function(){return this._get("powered",".rsbtn_powered")},closer:function(){return this._get("closer",".rsbtn_closer")},nosound:function(){return this._get("nosound",".rsbtn_nosound")},setPlayPause:function(a){rspkr.log("[rspkr.ui.Player.setPlayPause("+a+")]");a=a?$rs.getAttr(this.pause(),"data-rsphrase-play"):
$rs.getAttr(this.pause(),"data-rsphrase-pause");$rs.setAttr(this.pause(),"title",rspkr.c.decodeEntities(a));$rs.findIn(this.pause(),".rsbtn_btnlabel").innerHTML=a}},p=!1,r=[],v=function(){var b=null,b=rspkr.cfg,c=rspkr.cfg.getPhrases(rspkr.c.data.getParam("lang"));if(0==$rs.findIn(a,".rsbtn_exp").length){var e=$rs.hasClass(a,"rspopup")?b.item("ui.popupplayer"):b.item("ui.player"),b=document.createElement("div");b.className="rsbtn_exp rsimg rspart";b.innerHTML+=e.join("\n");a.appendChild(b)}b=k.pin();
e="Explorer"==rspkr.c.data.browser.name&&8>rspkr.c.data.browser.version;$rs.isArray(b)&&0==b.length&&(b=void 0);b&&!e&&rspkr.cfg.item("ui.usePin")?$rs.removeClass(b,"turnedOff"):b&&b.parentElement.removeChild(b);if(c){b=function(a,b){var c=$rs.findIn(a,".rsbtn_btnlabel");$rs.isArray(c)||(c=[c]);0<c.length&&(c[0].innerHTML=b)};k.pause()&&($rs.setAttr(k.pause(),"data-rsphrase-pause",c.pause),$rs.setAttr(k.pause(),"data-rsphrase-play",c.play),$rs.setAttr(k.pause(),"title",rspkr.c.decodeEntities(c.pause)),
b(k.pause(),rspkr.c.decodeEntities(c.pause)));k.stop()&&($rs.setAttr(k.stop(),"title",rspkr.c.decodeEntities(c.stop)),b(k.stop(),rspkr.c.decodeEntities(c.stop)));k.vol()&&($rs.setAttr(k.vol(),"title",rspkr.c.decodeEntities(c.volume)),b(k.vol(),rspkr.c.decodeEntities(c.volume)));k.settings()&&($rs.setAttr(k.settings(),"title",rspkr.c.decodeEntities(c.settings)),b(k.settings(),rspkr.c.decodeEntities(c.settings)));k.dl()&&($rs.setAttr(k.dl(),"title",rspkr.c.decodeEntities(c.download)),b(k.dl(),rspkr.c.decodeEntities(c.download)));
if(k.powered()){var e=$rs.findIn(k.powered(),".rsbtn_btnlabel"),f=c.speechenabled.match(/.*href="([^"]*)"/i).pop(),g=c.newwindow,h=document.createElement("p");h.innerHTML=c.speechenabled;g=(h.innerText||h.textContent)+(g?" ("+g+")":"");e&&(e.innerHTML=c.speechenabled);$rs.setAttr(k.powered(),"title",g);$rs.setAttr(k.powered(),"data-readspeaker-href",f);e=$rs.getAttr(k.powered(),"data-rsevent-id");(!e||rs.l.f.eq.store[e]&&!rs.l.f.eq.store[e].click)&&$rs.regEvent(k.powered(),"click",function(){window.open($rs.getAttr(this,
"data-readspeaker-href"))})}k.closer()&&($rs.setAttr(k.closer(),"title",rspkr.c.decodeEntities(c.closeplayer)),b(k.closer(),rspkr.c.decodeEntities(c.closeplayer)))}c=rspkr.c.data.browser;/safari/i.test(c.name)&&/iphone|ipad|ios/i.test(c.OS)||$rs.addClass(a,"rs-no-touch")},q={play:function(){rspkr.c.dispatchEvent("onUIBeforePlay");rspkr.log("[rspkr.ui.handlers.play]");r.progress&&r.progress.disabled(!1);q.setStateClass(a,"rsplaying");rspkr.basicMode&&q.setStateClass($rs.findIn(a,".rsbtn_exp"),"rsplaying");
$rs.addClass($rs.findIn(a,".rsbtn_progress_container"),"rsloading");k.setPlayPause(!1);if(rspkr.ui.getActivePlayer()&&rspkr.ui.getActivePlayer().getContainer()==a)rspkr.pl.play(),e&&rspkr.pl.getProgress.apply(rspkr.pl,[!0,w,n]),rspkr.c.addEvent("onBeforeSyncInit",function(){e=!0;rspkr.pl.getProgress.apply(rspkr.pl,[!0,w,n])}),"flash"!==rspkr.pl.adapter||rspkr.displog.onVolumeAdjusted||rspkr.pl.setVolume(parseInt(rspkr.st.get("hlvol")||"100")),rspkr.c.dispatchEvent("onUIAfterPlay"),rspkr.cfg.execCallback("cb.ui.play",
a);else{rspkr.ui.getActivePlayer()&&rspkr.ui.getActivePlayer().close();var b=$rs.findIn(a,".rsbtn_play");window.readpage(b)}},pause:function(){rspkr.log("[rspkr.ui.handlers.pause]");q.setStateClass(a,"rspaused");rspkr.basicMode&&q.setStateClass($rs.findIn(a,".rsbtn_exp"),"rspaused");k.setPlayPause(!0);rspkr.pl.pause();rspkr.pl.getProgress(!1);rspkr.c.dispatchEvent("onUIPause");rspkr.cfg.execCallback("cb.ui.pause",a);rspkr.log("ReadSpeaker.ui.pause")},stop:function(){rspkr.log("[rspkr.ui.handlers.stop]");
r.progress&&r.progress.disabled(!0);q.setStateClass(a,"rsstopped");$rs.removeClass($rs.findIn(a,".rsbtn_progress_container"),"rsloading");rspkr.basicMode&&q.setStateClass($rs.findIn(a,".rsbtn_exp"),"rsstopped");k.setPlayPause(!0);$rs.setAttr(a,"data-readspeaker-current",0);r.progress&&(r.progress.jumpTo(0),x(0));rspkr.pl.stop();rspkr.pl.getProgress(!1);rspkr.c.dispatchEvent("onUIStop",a);rspkr.cfg.execCallback("cb.ui.stop",a);document.getElementById("rslightbox_contentcontainer")&&$rs.isVisible(document.getElementById("rslightbox_contentcontainer"))||
k.pause().focus();rspkr.HL.chunking&&1<rspkr.HL.chunking.currentChunkNumber&&(rspkr.HL.chunking.destroy(),rspkr.pl.hasOwnProperty("releaseAdapter")&&rspkr.pl.releaseAdapter());rspkr.log("ReadSpeaker.ui.stop")},setStateClass:function(a,b){a&&($rs.removeClass(a,"rspaused rsstopped rsplaying"),$rs.addClass(a,b))},vol:function(b){var c=$rs.findIn(a,".rsbtn_volume_container"),e=$rs.findIn(a,".rsbtn_volume");b=b.originalEvent;var f=function(a){var b=a.originalEvent,b=$rs.closest(b.srcElement||b.originalTarget,
".rsbtn_volume_container");if("click"===a.type){if(void 0===b||$rs.isArray(b)&&!b.length)$rs.css(c,"display","none"),$rs.unregEvent(document.body,"click",f),$rs.unregEvent(document.body,"keyup",f)}else"keyup"===a.type&&27===a.keyCode&&($rs.css(c,"display","none"),$rs.unregEvent(document.body,"click",f),$rs.unregEvent(document.body,"keyup",f))};$rs.css(c,"left",e.offsetLeft+"px");$rs.css(c,"display","none"==$rs.css(c,"display")?"block":"none");"block"===$rs.css(c,"display")?($rs.regEvent(document.body,
"click",f),$rs.regEvent(document.body,"keyup",f)):($rs.unregEvent(document.body,"click",f),$rs.unregEvent(document.body,"keyup",f));b&&b.stopPropagation&&b.stopPropagation();b.cancelBubble=!0;e={keyCode:13};b=$rs.findIn(c,".keyLink");try{r.vol.startDragKeys(b,e)}catch(g){rspkr.log("[rspkr.ui.handlers.vol] Error accessing object _sliders['vol']")}return!1},settings:function(){$rs.hasClass(a,"rsplaying")&&this.pause();rspkr.ui.Lightbox.show(rspkr.st.getHTML(),rspkr.st.getButtons(),!0,function(a){var b=
$rs.get("rslightbox_closer"),c=function(){document.removeEventListener?b.removeEventListener("click",c,!1):document.detachEvent&&document.detachEvent("onclick",c);rspkr.c.dispatchEvent("onSettingsClosed",window,[])};$rs.regEvent(b,"click",c);rspkr.ui.addClickEvents();rspkr.c.dispatchEvent("onSettingsLoaded",window,[]);rspkr.cfg.execCallback("cb.ui.settingsopened",a)})},close:function(b){q.pin(!0);b=b||!1;var c=rspkr.pl,e=!1;rspkr.HL.chunking.destroy();b||rspkr.cfg.execCallback("cb.ui.beforeclose",
a);c.hasOwnProperty("getProgress")&&rspkr.pl.getProgress(!1);c.hasOwnProperty("releaseAdapter")&&rspkr.pl.releaseAdapter();$rs.setAttr(a,"data-readspeaker-current",0);r.progress&&(r.progress.jumpTo(0),x(0));$rs.removeClass(a,"rsstopped rsplaying rspaused rsexpanded");if(rspkr.basicMode){var f;(f=$rs.findIn(a,".rsbtn_play"))&&$rs.removeClass(f,"rsexpanded")}$rs.hasClass(a,"rsfloating")&&($rs.removeClass(a,rspkr.ui.rsbtnClass),rspkr.basicMode&&($rs.removeClass(a,"rsvisible"),$rs.addClass(a,"rshidden")));
k.setPlayPause(!0);$rs.hasClass(a,"rspopup")&&(e=!0,$rs.removeClass(a,"rspopup"),$rs.css(a,"display","none"),a.parentNode.removeChild(a));$rs.css(a,"width","auto");delete rspkr.displog.onVolumeAdjusted;b||(rspkr.c.dispatchEvent("onUIClosePlayer",a,["userclick"]),rspkr.cfg.execCallback("cb.ui.close",a),rspkr.log("ReadSpeaker.ui.close: "+a));b||!1!==e||rspkr.ui.focus($rs.findIn($rs.get(a),".rsbtn_play"))},dl:function(c){$rs.hasClass(a,"rsplaying")&&this.pause();var e=(c=$rs.getAttr($rs.findIn(a,".rsbtn_play"),
"href"))?rspkr.c.data.getSaveData("dialog",c):rspkr.c.data.getSaveData("dialog"),f=!1;rspkr.log("[rspkr.ui.handlers.dl] Savelink: "+e);rspkr.u.Lightbox.show(this.getDlDialog(),this.getDlButtons(),!0,function(){var a=$rs.get("#rsdl_button_accept"),c=$rs.get("#rsdl_button_decline");a&&$rs.regEvent(a,"click",function(b){rspkr.u.Lightbox.hide(b);f="iOS"!==rspkr.c.data.browser.OS&&0<rspkr.c.data.selectedHTML.length?!0:"iOS"!==rspkr.c.data.browser.OS&&!0===rspkr.cfg.item("general.usePost")?!0:!1;if(!0===
f){b=null;if(document.getElementById("dliframe"))b=document.getElementById("dliframe");else{if(document.selection)try{b=document.createElement('<iframe name="dliframe">')}catch(c){b=document.createElement("iframe")}else b=document.createElement("iframe");b.name="dliframe";b.setAttribute("id","dliframe");b.setAttribute("style","display: none; position: absolute;");b.style.display="none";/Explorer/i.test(rspkr.c.data.browser.name)||b.setAttribute("sandbox","allow-same-origin allow-scripts allow-downloads allow-downloads-without-user-activation");
var g=document.getElementsByTagName("body"),h=null;0<g.length&&(h=g.item(0));if(h)h.appendChild(b);else return}b.src=e;return!1}$rs.setAttr(a,"href",e);return!0});c&&($rs.regEvent(c,"click",function(a){b(a);rspkr.u.Lightbox.hide(a)}),setTimeout(function(){rspkr.ui.focus(c)},200));rspkr.c.dispatchEvent("onDownloadLoaded",window,[])})},pin:function(b,c){var e=a.id+"_pinnedHome",f=document.getElementById(e);c=c?!0:!1;if(!$rs.hasClass(k.pin(),"pinned")&&!b){if($rs.addClass(k.pin(),"pinned"),!f){var g=
function(a,b){return window.getComputedStyle?window.getComputedStyle(a)[b]:a.currentStyle?a.currentStyle[b]:a.style[b]},f=$rs.clone(a,!1,!0),h=a.offsetLeft,l=a.offsetTop;if(!c){f.style.width=g(a,"width").replace(/[^-\d\.]/g,"")-2+"px";f.style.height=g(a,"height").replace(/[^-\d\.]/g,"")-2+"px";for(var m="position left right top bottom margin-left margin-right margin-top margin-bottom".split(" "),n=0,p;p=m[n];n++){var r=$rs.css(a,p);$rs.setAttr(a,"data-css-"+p,r);r=g(a,p);"auto"!=r&&(f.style[p]=r)}f.className=
"rsbtn_pinnedHome rsbtn";for(f.id=e;f.hasChildNodes();)f.removeChild(f.lastChild);a.parentElement.insertBefore(f,a)}a.style.position="fixed";a.style.top=l-$rs.scrollTop(document)+"px";a.style.left=h-$rs.scrollLeft(document)+"px"}}else if($rs.hasClass(k.pin(),"pinned")||b)if($rs.removeClass(k.pin(),"pinned"),f)for(f.parentNode.removeChild(f),m="position left right top bottom margin-left margin-right margin-top margin-bottom".split(" "),n=0;p=m[n];n++)r=$rs.getAttr(a,"data-css-"+p),$rs.css(a,p,r)},
getDlDialog:function(){var a=rspkr.cfg.item("ui.dldialog").join("\n"),b={};b.rsTERMS_OF_USE_HEADINGrs=rspkr.cfg.getPhrase("touheading");b.rsTERMS_OF_USE_BODYrs=rspkr.cfg.getPhrase("toubody");return rspkr.st.r().replaceTokens(a,b)},getDlButtons:function(){var a=rspkr.cfg.item("ui.dlbuttons").join("\n"),b={};b.rsTERMS_OF_USE_ACCEPTrs=rspkr.cfg.getPhrase("touaccept");b.rsTERMS_OF_USE_DECLINErs=rspkr.cfg.getPhrase("toudecline");return rspkr.st.r().replaceTokens(a,b)},nosound:function(){var a=rspkr.c.data.getSaveData("link");
$rs.setAttr(k.nosound(),"href",a);return!0}},x=function(b){b=100<b?100:b;var c=$rs.findIn(a,".rsbtn_progress_played");"object"===typeof c&&$rs.css(c,"width",b+"%");rspkr.cfg.execCallback("cb.ui.progresschanged",a,[b])},w=function(a){if(a.length){var b=parseInt(a[0]);a=parseInt(a[1]);rspkr.ui.getActivePlayer().updateProgressSlider(b,a)}},t=function(a){a/=1E3;var b=parseInt(a%60),c=parseInt(a/60%60);a=parseInt(a/60/60%60);return(10>a?"0"+a:a.toString())+":"+(10>c?"0"+c:c.toString())+":"+(10>b?"0"+b:
b.toString())},u=function(){p=!0},y=function(b,c){rspkr.log("_dropProgress ("+b+")",5);if(b){var e=b/100*$rs.getAttr(a,"data-readspeaker-buffered")/1E3;rspkr.pl.setProgress(e)}p=!1},z=function(a){y(a)},A=function(b,c){rspkr.log("_dropVolume, "+b,5);b=0>b?0:20*b;r.vol&&r.vol.jumpTo(b/20);rspkr.pl.setVolume(b);rspkr.st.set("hlvol",b);rspkr.cfg.execCallback("cb.ui.volumechanged",a,[b]);return!1},B=function(b,c){if("keyLink"===b.className){var e="";$rs.hasClass(c,"rsbtn_volume_handle")?e="vol":$rs.hasClass(c,
"rsbtn_progress_handle")&&(e="progress");var f={keyCode:13};r[e].startDragKeys(b,f)}else $rs.hasClass(c,"rsbtn_volume")&&(f={keyCode:13},e=$rs.findIn(a,".rsbtn_volume_container"),e=$rs.findIn(e,".keyLink"),r.vol.startDragKeys(e,f))},C=function(a,b){if("keyLink"===a.className){var c="";$rs.hasClass(b,"rsbtn_volume_handle")?c="vol":$rs.hasClass(b,"rsbtn_progress_handle")&&(c="progress");r[c].releaseElement();p=!1}};return{init:function(){h.push([this.show,[]])},initVolume:function(){if(!$rs.isArray($rs.findIn($rs.get(a),
".rsbtn_volume_slider"))){var b=rspkr.cfg,c=rspkr.st.get("hlvol")||"100",c=parseInt(c)/100*5;r.vol=new rspkr.ui.Slider;r.vol.init($rs.findIn(a,".rsbtn_volume_slider"),{handleClass:b.item("ui.volumeHandleClass")||"rsbtn_volume_handle rsimg",dir:b.item("ui.volumeDir")||"v",steps:5,nudge:1,initval:c,dragging:A,click:A,labelDragHandle:b.getPhrase("slidervolumedesc")});b=$rs.findIn($rs.get(a),".rsbtn_volume_handle a");ui.addFocusHandler(b,!1,b.parentNode)}},show:function(c){c=c?!0:!1;var e=$rs.hasClass(a,
"rsexpanded");$rs.rsid(a);a.id=m=a.id||rspkr.getID();ui=rspkr.ui;$rs.hasClass(a,rspkr.ui.rsbtnClass)||$rs.addClass(a,rspkr.ui.rsbtnClass);v();var h=$rs.findIn(a,".rsbtn_status_overlay");$rs.isArray(h)||$rs.css(h,"display","none");"fallback"===rspkr.pl.adapter&&(rspkr.ui.showOverlay("nosound",a),$rs.addClass(a,"rsstopped"));$rs.addClass(a,"rsexpanded");if(rspkr.basicMode){var n;(n=$rs.findIn(a,".rsbtn_play"))&&$rs.addClass(n,"rsexpanded")}f||e||(k.stop()&&($rs.regEvent(k.stop(),"click",function(a){b(a);
q.stop()}),ui.addFocusHandler(k.stop())),k.pause()&&($rs.regEvent(k.pause(),"click",function(c){b(c);$rs.hasClass(a,"rsplaying")?q.pause():($rs.hasClass(a,"rsstopped")||$rs.hasClass(a,"rspaused"))&&q.play()}),ui.addFocusHandler(k.pause())),k.closer()&&($rs.regEvent(k.closer(),"click",function(a){b(a);q.close()}),ui.addFocusHandler(k.closer())),k.vol()&&($rs.regEvent(k.vol(),"click",function(a){b(a);q.vol(a)}),ui.addFocusHandler(k.vol())),k.dl()&&($rs.regEvent(k.dl(),"click",function(a){b(a);return q.dl(a)}),
ui.addFocusHandler(k.dl())),k.settings()&&($rs.regEvent(k.settings(),"click",function(a){b(a);q.settings()}),ui.addFocusHandler(k.settings())),k.pin()&&($rs.regEvent(k.pin(),"click",function(a){b(a);q.pin()}),ui.addFocusHandler(k.pin())),n=rspkr.cfg,$rs.setAttr(a,"data-readspeaker-current",0),$rs.setAttr(a,"data-readspeaker-buffered",0),$rs.isArray($rs.findIn($rs.get(a),".rsbtn_progress_container"))||(r.progress=new rspkr.ui.Slider,r.progress.init($rs.findIn($rs.get(a),".rsbtn_progress_container"),
{handleClass:n.item("ui.progressHandleClass")||"rsbtn_progress_handle rsimg",dir:n.item("ui.progressDir")||"h",nudge:5,start:u,dragging:y,click:z,labelDragHandle:n.getPhrase("sliderseek")}),e=$rs.findIn($rs.get(a),".rsbtn_progress_handle a"),ui.addFocusHandler(e,!1,e.parentNode)),$rs.isArray($rs.findIn($rs.get(a),".rsbtn_volume_slider"))||(e=rspkr.st.get("hlvol")||"100",e=parseInt(e)/100*5,r.vol=new rspkr.ui.Slider,r.vol.init($rs.findIn(a,".rsbtn_volume_slider"),{handleClass:n.item("ui.volumeHandleClass")||
"rsbtn_volume_handle rsimg",dir:n.item("ui.volumeDir")||"v",steps:5,nudge:1,initval:e,dragging:A,click:A,labelDragHandle:n.getPhrase("slidervolumedesc")}),e=$rs.findIn($rs.get(a),".rsbtn_volume_handle a"),ui.addFocusHandler(e,!1,e.parentNode)),rspkr.Common.addEvent("onFocusIn",B),rspkr.Common.addEvent("onFocusOut",C),rspkr.cfg.execCallback("cb.ui.open",a),f=!0);$rs.findIn(a,".rsbtn_powered")&&(n=$rs.findIn(a,".rsbtn_powered .rsbtn_btnlabel a"))&&((/Chrome|Safari|Opera/gi.test(rs.c.data.browser.name)||
/Explorer/gi.test(rs.c.data.browser.name)&&8<=rs.c.data.browser.version)&&$rs.regEvent(n,"click",function(a){b(a)}),n.innerHTML='<span class="rsbtn_label_read">Read</span><span class="rsbtn_label_speaker">Speaker</span><span class="rsbtn_label_icon rsimg"></span>');"0"!=$rs.getAttr(a,"data-readspeaker-current")&&(rspkr.pl.releaseAdapter(),$rs.setAttr(a,"data-readspeaker-current",0));"fallback"===rspkr.pl.adapter||c?(r.progress&&r.progress.disabled(!0),q.setStateClass(a,"rsstopped"),$rs.removeClass($rs.findIn(a,
".rsbtn_progress_container"),"rsloading"),rspkr.basicMode&&q.setStateClass($rs.findIn(a,".rsbtn_exp"),"rsstopped")):(q.play(),rspkr.ui.focus(k.pause()));l=g(a);isNaN(l)||$rs.css(a,"width",l+(/[Ee]xplorer/.test(ReadSpeaker.c.data.browser.name)?1:0)+"px");!$rs.hasClass(a,"rspopup")||rspkr.cfg.item("ui.pinnedPopup")||rspkr.basicMode||q.pin(!1,!0)},close:function(a){q.close(a)},stop:function(){q.stop()},nosound:function(){return q.nosound()},pause:function(){q.pause()},play:function(){q.play()},dl:function(a){q.dl(a)},
settings:function(){q.settings()},vol:function(a){q.vol(a)},pin:function(a,b){q.pin(a,b)},restart:function(){rspkr.log("[rspkr.ui.restart]");q.stop();window.setTimeout(function(){q.play()},500);return!1},updateProgress:function(a){w(a)},setProgress:function(a){y(a)},getContainer:function(){return a},updateProgressSlider:function(b,c){var e=0===c?0:Math.round(b/c*100),f=$rs.findIn(a,".rsbtn_current_time"),g=$rs.findIn(a,".rsbtn_total_time"),h=t(b),k=t(c);r.progress&&(r.progress.setCurrentValue(e),
p||(r.progress.jumpTo(e),x(e),f&&(f.innerHTML=h),g&&(g.innerHTML=k),rspkr.cfg.execCallback("cb.ui.timeupdated",a,[h,k])));rspkr.log("[rspkr.player.updateProgress] current time: "+b+" total time: "+c);$rs.setAttr(a,"data-readspeaker-current",b);$rs.setAttr(a,"data-readspeaker-buffered",c);0<b&&$rs.removeClass($rs.findIn(a,".rsbtn_progress_container"),"rsloading")},getID:function(){return m},getWidth:function(){return l},setHref:function(a){c=a},getHref:function(){return c}}};
ReadSpeaker.ui.Lightbox=function(){var a=null,b=null,g=null,m=null,n=null,h=null,l,f=[],c=function(a){a=a||window.event;a.returnValue=!1;if(a=a.originalEvent)a.cancelBubble=!0,a.returnValue=!1;a&&a.preventDefault&&a.preventDefault();a&&a.stopPropagation&&a.stopPropagation()},e=function(){var a=$rs.css(h,"display");$rs.css(h,"display","none");var b=$rs.height(window),c=$rs.height(document),e=parseInt($rs.css(document.documentElement,"width")),f=$rs.width(document),g=$rs.absOffset(document.body),l=
0,m=0;isNaN(e)&&(e=$rs.width(window));g.left&&(m=g.left);g.top&&(l=g.top);$rs.css(n,{width:(f>e?f:e)+"px",height:(c>b?c:b)+"px",top:"-"+Math.abs(l)+"px",left:"-"+Math.abs(m)+"px"});$rs.css(h,"display",a);k()},k=function(){var a=$rs.outerWidth(h),b=$rs.outerHeight(h),c=$rs.width(window),e=$rs.height(window),b=l+80+50<e?l+80:e-50;h.style.height=b+"px";$rs.get("#rslightbox_content").style.height=b-80+"px";b>e?(h.style.top=$rs.scrollTop(document)+"px",h.style.marginTop="10px"):(h.style.top=e/2+"px",h.style.marginTop=
-(b/2-$rs.scrollTop(document))+"px");a>c?(h.style.left=$rs.scrollLeft(document)+"px",h.style.marginLeft="0"):(h.style.left="50%",h.style.marginLeft=-(a/2-$rs.scrollLeft(document))+"px")},p=function(a){27===a.keyCode&&rspkr.ui.Lightbox.hide()};return{init:function(){var c=rspkr.pub.Config;a=c.item("ui.overlay.overlayStyles");b=c.item("ui.overlay.contentStyles");g=c.item("ui.overlay.contentTemplate");document.querySelectorAll||(d=document,s=d.createStyleSheet(),d.querySelectorAll=function(a,b,c,e,f){f=
d.all;b=[];a=a.replace(/\[for\b/gi,"[htmlFor").split(",");for(c=a.length;c--;){s.addRule(a[c],"k:v");for(e=f.length;e--;)f[e].currentStyle.k&&b.push(f[e]);s.removeRule(0)}return b});rspkr.log("[rspkr.ui.Lightbox] Heartbeat!")},show:function(k,v,q,x,w){for(var t=0,u=document.body.getElementsByTagName("*"),y;y=u[t];t++)-1!=y.tabIndex&&(f.push([y,y.tabIndex]),y.tabIndex=-1);if("Explorer"!=rs.c.data.browser.name||6!=rs.c.data.browser.version)for(y=document.querySelectorAll("body > *"),t=0;u=y[t];t++)if("rslightbox_overlay"!=
u.id&&"rslightbox_contentcontainer"!=u.id&&"script"!=u.tagName.toLowerCase()){var z=u.getAttribute("aria-hidden");z&&u.setAttribute("data-original-aria-hidden",z);u.setAttribute("aria-hidden","true")}k=k||"";q=q||!1;n?(n.style.display="",h.style.display=""):(n=document.createElement("div"),n.id="rslightbox_overlay",h=document.createElement("div"),h.id="rslightbox_contentcontainer",h.innerHTML=rspkr.st.r().replaceTokens(g.join("\n"),{rsLIGHTBOX_CLOSE_LABELrs:rspkr.cfg.getPhrase("close")}),$rs.setAttr(n,
"style",a.join(";")),$rs.setAttr(h,"style",b.join(";")),document.body.appendChild(n),document.body.appendChild(h),rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.changed.addButtonEvents,context:rspkr.st.r().handlers.changed,params:[this]}));t=$rs.get("rslightbox_closer");rspkr.ui.addFocusHandler(t,!1);$rs.regEvent(t,"click",function(a){c(a);rspkr.ui.Lightbox.hide(a)});$rs.regEvent(n,"click",rspkr.ui.Lightbox.hide);$rs.regEvent(document.body,"keyup",p);(u=document.documentElement)&&document.all&&
(u.style.overflowX=u.style.overflowY="hidden");if(k!=m||q)q=rspkr.cfg.getPhrase("close"),$rs.setAttr(t,"title",q),$rs.findIn(t,".rsbtn_btnlabel").innerHTML=q,$rs.get("#rslightbox_content").innerHTML="",$rs.css("#rslightbox_content","height","auto"),/^http/i.test(k)?$rs.findIn("#rslightbox_content","iframe").length||(q=document.createElement("iframe"),q.src=k,q.className="rslightbox-iframe",q.setAttribute("sandbox",""),void 0===w&&(w=2E3),$rs.get("#rslightbox_content").appendChild(q)):"<"==k.substr(0,
1)&&($rs.get("#rslightbox_content").innerHTML=k),$rs.get("#rslightbox_buttons").innerHTML=v,m=k,"ar_ar"==rs.c.data.params.lang&&(-1==h.className.indexOf("rtl")&&(h.className=(h.className+" rtl").replace(/^\s+|\s+$/g,"")),$rs.setAttr($rs.findIn(h,"legend"),"align","right"));l=void 0===w||isNaN(w)?rspkr.basicMode?$rs.get("#rslightbox_content").scrollHeight:$rs.get("#rslightbox_content").clientHeight:w;k=$rs.findIn("#rslightbox_content",".rsform-row");for(t=0;t<k.length;t++)for(v=$rs.findIn(k[t],"input, a, select"),
$rs.isArray(v)||(v=[v]),u=0;u<v.length;u++)rspkr.ui.addFocusHandler(v[u],!1,k[t]);var A=$rs.findIn("#rslightbox_buttons",".rssettings-button-close");rspkr.ui.addFocusHandler(A,!1);$rs.regEvent(A,"click",function(a){c(a)});(k=$rs.findIn("#rsform_wrapper",".rssettings-button-gotobottom"))&&!$rs.isArray(k)&&rspkr.ui.addFocusHandler(k,!1);(k=$rs.findIn("#rslightbox_buttons",".rssettings-button-gototop"))&&!$rs.isArray(k)&&rspkr.ui.addFocusHandler(k,!1);var B=$rs.findIn("#rslightbox_content","input");
$rs.isArray(B)&&0<B.length?setTimeout(function(){rspkr.ui.focus(B[0]);rspkr.Common.addEvent("onFocusIn",function(a,b){a.className&&$rs.hasClass(a,"rssettings-button-gototop")?rspkr.ui.focus(B[0]):a.className&&$rs.hasClass(a,"rssettings-button-gotobottom")&&rspkr.ui.focus(A)})},200):$rs.isArray(B)||setTimeout(function(){rspkr.ui.focus(B)},200);e();$rs.regEvent(window.document.documentElement,"resize",e);"function"==typeof x&&x.apply(this,[h])},hide:function(a){for(;0<f.length;){var b=f.pop();b[0].tabIndex=
b[1]}if("Explorer"!=rs.c.data.browser.name||6!=rs.c.data.browser.version){a=document.querySelectorAll("body > *");for(var b=0,g;g=a[b];b++){var k=g.getAttribute("data-original-aria-hidden");k?(g.setAttribute("aria-hidden",k),g.removeAttribute("data-original-aria-hidden")):g.removeAttribute("aria-hidden")}}c(a);n.style.display="none";h.style.display="none";$rs.unregEvent(window,"resize",e);$rs.unregEvent($rs.get("#rslightbox_closer"),"click",rspkr.ui.Lightbox.hide);$rs.unregEvent(n,"click",rspkr.ui.Lightbox.hide);
$rs.unregEvent(document.body,"keyup",p);(a=document.documentElement)&&document.all&&(a.style.overflowX=a.style.overflowY="auto");rspkr.ui.updateFocus();rspkr.c.dispatchEvent("onSettingsClosed",window,[])},reposition:k}}();
ReadSpeaker.q(function(){ReadSpeaker.HL.customHL=function(){var a="Explorer"==ReadSpeaker.c.data.browser.name&&8>ReadSpeaker.c.data.browser.version,b=void 0,g=function(c){b||(b=document.createElement("div"),b.id="rs_enlargeHL_box",a&&(b.className="rs_enlargeHL_legacy"),m(),document.body.appendChild(b));b.style.display="block"},m=function(){b&&(b.style.backgroundColor=ReadSpeaker.Common.Settings.get("hlsent"),b.style.color=ReadSpeaker.Common.Settings.get("hltext"))},n=function(a,e){var f=a.text?a.text:
a.innerHTML;if(/\S/.test(f)){ReadSpeaker.log("_sentHL ("+e+"): "+f,5);g();var h,l="";a.previousSibling?h=a.previousSibling:a.parentElement&&a.parentElement.previousSibling&&(h=a.parentElement.previousSibling);h&&3===h.nodeType&&h.textContent&&h.textContent.length&&!/\S/.test(h.textContent)&&(l=" ");b.innerHTML=1==e?b.innerHTML+l+f:f;f=b.getElementsByTagName(ReadSpeaker.Common.data.browser.syncContainer);for(h=0;h<f.length;h++)/^custom_/.test(f[h].id)||(f[h].id="custom_"+f[h].id)}},h=function(a,e){var f=
a.text?a.text:a.innerHTML;if(/\S/.test(f)){ReadSpeaker.log("_wordHL ("+e+"): "+f,5);g();1!=e&&$rs.removeClass($rs.findIn(b,".sync_word_highlighted"),"sync_word_highlighted");var l=$rs.findIn(b,"#custom_"+a.id);if($rs.isArray(l))if(l=a,a.innerHTML){for(;l.parentNode;){if(/\bsync_sent|ffsent/.test(l.parentNode.className)){ReadSpeaker.log("---\x3e Remitting to _sentHL",5);n(l.parentNode);h(a,e);return}l=l.parentNode}b.innerHTML=a.innerHTML;$rs.findIn(b,a.id).id="custom_"+a.id;h(a,e)}else b.innerHTML=
f;else $rs.addClass(l,"sync_word_highlighted")}},l=function(){b&&(b.style.display="none",b.innerHTML="")};ReadSpeaker.c.addEvent("onSettingsChanged",function(){m();"enlargeoff"===rs.st.get("enlarge")&&l()});var f=rs.cfg.getSettingsConf();f.highlighting&&f.highlighting.items&&(f.highlighting.items.enlarge={phrase:"ph_hlenlarge",type:"radio",info:"ph_hlenlargeinfo",options:[{value:"enlargeon",phrase:"ph_on"},{value:"enlargeoff",phrase:"ph_off"}]});return{active:function(){return"enlargeon"===ReadSpeaker.st.get("enlarge")},
sentHL:n,wordHL:h,cleanUp:l}}()});
ReadSpeaker.q(function(){var a={en_us:{hlenlarge:"Enhanced text visibility",hlenlargeinfo:"Displays the current sentence at the bottom of the page, with a larger font size and simultaneous text highlighting."},en_uk:{hlenlarge:"Enhanced text visibility",hlenlargeinfo:"Displays the current sentence at the bottom of the page, with a larger font size and simultaneous text highlighting."},ar_ar:{hlenlarge:decodeURIComponent("%D8%AA%D8%B9%D8%B2%D9%8A%D8%B2%20%D8%B1%D8%A4%D9%8A%D8%A9%20%D8%A7%D9%84%D9%86%D8%B5"),hlenlargeinfo:decodeURIComponent("%D9%8A%D8%B9%D8%B1%D8%B6%20%D8%A7%D9%84%D8%AC%D9%85%D9%84%D8%A9%20%D8%A7%D9%84%D8%AD%D8%A7%D9%84%D9%8A%D8%A9%20%D8%A8%D8%AF%D8%A7%D8%AE%D9%84%20%D9%85%D8%B1%D8%A8%D8%B9%20%D9%81%D9%8A%20%D8%A7%D9%84%D8%AC%D8%B2%D8%A1%20%D8%A7%D9%84%D8%B3%D9%81%D9%84%D9%8A%20%D9%85%D9%86%20%D8%A7%D9%84%D8%B5%D9%81%D8%AD%D8%A9%D8%8C%20%D8%A8%D8%B9%D8%AF%20%D8%AA%D9%83%D8%A8%D9%8A%D8%B1%D8%AD%D8%AC%D9%85%20%D8%A7%D9%84%D8%AE%D8%B7%20%D9%88%D8%A3%D8%AB%D9%86%D8%A7%D8%A1%20%D8%A7%D8%A8%D8%B1%D8%A7%D8%B2%20%D8%A7%D9%84%D9%86%D8%B5%20%D9%88%D8%A8%D8%B4%D9%83%D9%84%20%D9%85%D8%AA%D8%B2%D8%A7%D9%85%D9%86.")},
ca_es:{hlenlarge:"Visibilitat de text millorat",hlenlargeinfo:decodeURIComponent("Mostra%20la%20frase%20actual%20en%20un%20quadre%20a%20la%20part%20inferior%20de%20la%20p%C3%A0gina%2C%20amb%20una%20mida%20de%20lletra%20m%C3%A9s%20gran%20i%20ressaltat%20de%20text%20simult%C3%A0nia")},cs_cz:{hlenlarge:decodeURIComponent("Zv%C4%9Bt%C5%A1en%C3%AD%20textu"),hlenlargeinfo:decodeURIComponent("Zobrazuje%20pr%C3%A1v%C4%9B%20%C4%8Dtenou%20v%C4%9Btu%20jako%20zv%C4%9Bt%C5%A1en%C3%BD%20text%20v%20samostatn%C3%A9m%20okn%C4%9B%20dole%20na%20str%C3%A1nce.")},
cy_cy:{hlenlarge:"Gwelededd testun gwell",hlenlargeinfo:decodeURIComponent("Dangos%20y%20frawddeg%20sy%E2%80%99n%20cael%20ei%20ddarllen%20yn%20gyfredol%20gyda%20thestun%20bras%20mewn%20blwch%20testun%20ar%20wah%C3%A2n%20wrth%20waelod%20y%20tudalen.")},da_dk:{hlenlarge:decodeURIComponent("Forst%C3%B8rret%20tekstvisning"),hlenlargeinfo:decodeURIComponent("Viser%20den%20aktuelt%20opl%C3%A6ste%20s%C3%A6tning%20med%20forst%C3%B8rret%20skrift%20i%20en%20separat%20tekstboks%20nederst%20p%C3%A5%20siden.")},
de_de:{hlenlarge:"Verbesserte Text-Sichtbarkeit",hlenlargeinfo:decodeURIComponent("Zeigt%20den%20aktuell%20vorgelesenen%20Satz%20in%20einer%20Textbox%20am%20unteren%20Ende%20der%20Seite%20an%2C%20mit%20vergr%C3%B6%C3%9Ferter%20Schrift%20und%20gleichzeitiger%20Texthervorhebung")},es_es:{hlenlarge:"Mejor visibilidad del texto",hlenlargeinfo:decodeURIComponent("Muestra%20la%20frase%20actual%20en%20un%20cuadro%20en%20la%20parte%20inferior%20de%20la%20p%C3%A1gina%2C%20con%20un%20tama%C3%B1o%20de%20letra%20m%C3%A1s%20grande%20y%20resaltado%20de%20texto%20simult%C3%A1nea")},
es_co:{hlenlarge:"Mejor visibilidad del texto",hlenlargeinfo:decodeURIComponent("Muestra%20la%20frase%20actual%20en%20un%20cuadro%20en%20la%20parte%20inferior%20de%20la%20p%C3%A1gina%2C%20con%20un%20tama%C3%B1o%20de%20letra%20m%C3%A1s%20grande%20y%20resaltado%20de%20texto%20simult%C3%A1nea")},es_mx:{hlenlarge:"Mejor visibilidad del texto",hlenlargeinfo:decodeURIComponent("Muestra%20la%20frase%20que%20se%20est%C3%A1%20leyendo%20actualmente%20con%20el%20texto%20ampliado%20en%20un%20cuadro%20de%20texto%20independiente%20en%20la%20parte%20inferior%20de%20la%20p%C3%A1gina.")},
es_us:{hlenlarge:"Mejor visibilidad del texto",hlenlargeinfo:decodeURIComponent("Muestra%20la%20frase%20que%20se%20est%C3%A1%20leyendo%20actualmente%20con%20el%20texto%20ampliado%20en%20un%20cuadro%20de%20texto%20independiente%20en%20la%20parte%20inferior%20de%20la%20p%C3%A1gina.")},eu_es:{hlenlarge:"Hobetutako testu ikuspena",hlenlargeinfo:"Erakusten du gaur egun, orrialdeko behealdeko testu independenteko koadro batean handitutako testuaz irakurtzen ari den resalida."},fi_fi:{hlenlarge:decodeURIComponent("Parannettu%20tekstin%20n%C3%A4kyvyys"),
hlenlargeinfo:decodeURIComponent("N%C3%A4ytt%C3%A4%C3%A4%20lauseen%20suurennettuna%20ja%20samanaikaisesti%20korostettuna%2C%20sivun%20alaosassa%20olevassa%20ruudussa")},fo_fo:{hlenlarge:decodeURIComponent("St%C3%B8rri%20tekstv%C3%ADsing"),hlenlargeinfo:decodeURIComponent("V%C3%ADsir%20upplisna%20setningin%20vi%C3%B0%20st%C3%B8rri%20skriftst%C3%B8dd%20%C3%AD%20serligum%20r%C3%BAti%20ni%C3%B0ast%20%C3%A1%20s%C3%AD%C3%B0uni.")},fr_fr:{hlenlarge:decodeURIComponent("Visibilit%C3%A9%20du%20texte%20renforc%C3%A9e"),
hlenlargeinfo:decodeURIComponent("Affiche%20la%20phrase%20courante%20au%20bas%20de%20la%20page%2C%20avec%20une%20police%20de%20plus%20grande%20taille%20et%20le%20texte%20en%20surbrillance%20simultan%C3%A9e")},fr_be:{hlenlarge:decodeURIComponent("Visibilit%C3%A9%20du%20texte%20renforc%C3%A9e"),hlenlargeinfo:decodeURIComponent("Affiche%20la%20phrase%20courante%20au%20bas%20de%20la%20page%2C%20avec%20une%20police%20de%20plus%20grande%20taille%20et%20le%20texte%20en%20surbrillance%20simultan%C3%A9e")},
fr_ca:{hlenlarge:decodeURIComponent("Visibilit%C3%A9%20du%20texte%20renforc%C3%A9e"),hlenlargeinfo:decodeURIComponent("Affiche%20la%20phrase%20courante%20au%20bas%20de%20la%20page%2C%20avec%20une%20police%20de%20plus%20grande%20taille%20et%20le%20texte%20en%20surbrillance%20simultan%C3%A9e")},gl_es:{hlenlarge:"Mellora da visibilidade do texto",hlenlargeinfo:decodeURIComponent("Amosa%20a%20frase%20actual%20nun%20recadro%20na%20parte%20inferior%20da%20p%C3%A1xina%2C%20cunha%20letra%20m%C3%A1is%20grande%20e%20%C3%A1%20vez%20resaltando%20o%20texto.")},
hu_hu:{hlenlarge:decodeURIComponent("Megjelen%C3%ADt%C3%A9s%20l%C3%A1that%C3%B3bb%C3%A1%20t%C3%A9tele"),hlenlargeinfo:decodeURIComponent("A%20felolvas%C3%A1ssal%20egy%20id%C5%91ben%20nagyobb%20bet%C5%B1m%C3%A9ret%C5%B1%2C%20kiemelt%20sz%C3%B6veg%20jelenik%20meg%20az%20oldal%20alj%C3%A1n%20egy%20k%C3%BCl%C3%B6n%20ablakban.")},it_it:{hlenlarge:decodeURIComponent("Visibilit%C3%A0%20testo%20accentuata"),hlenlargeinfo:"Visualizza la frase corrente in un box di grandi dimensioni a fondo pagina utilizzando un font molto grande ed evidenziando il testo in sincrono con la lettura"},
ja_jp:{hlenlarge:decodeURIComponent("%E6%96%87%E5%AD%97%E3%81%AE%E6%8B%A1%E5%A4%A7%E8%A1%A8%E7%A4%BA"),hlenlargeinfo:decodeURIComponent("%E8%AA%AD%E3%81%BF%E4%B8%8A%E3%81%92%E3%82%8B%E6%96%87%E7%AB%A0%E3%82%92%E3%83%9A%E3%83%BC%E3%82%B8%E4%B8%8B%E9%83%A8%E3%81%AB%E3%83%8F%E3%82%A4%E3%83%A9%E3%82%A4%E3%83%88%E3%81%97%E3%81%AA%E3%81%8C%E3%82%89%E6%8B%A1%E5%A4%A7%E6%96%87%E5%AD%97%E3%81%A7%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B")},ko_kr:{hlenlarge:decodeURIComponent("%ED%96%A5%EC%83%81%EB%90%9C%20%EA%B8%80%EC%9E%90%20%ED%91%9C%EC%8B%9C"),
hlenlargeinfo:decodeURIComponent("%ED%8E%98%EC%9D%B4%EC%A7%80%20%ED%95%98%EB%8B%A8%EC%9D%98%20%EB%B0%95%EC%8A%A4%20%EC%95%88%EC%97%90%20%EC%9E%88%EB%8A%94%20%ED%98%84%EC%9E%AC%20%EB%AC%B8%EC%9E%A5%EC%9D%84%20%EB%B3%B4%EB%8B%A4%20%ED%81%B0%20%ED%8F%B0%ED%8A%B8%20%EC%82%AC%EC%9D%B4%EC%A6%88%EC%99%80%20%EB%8F%99%EC%8B%9C%20%EA%B8%80%EC%9E%90%20%EA%B0%95%EC%A1%B0%ED%95%98%EA%B8%B0%EB%A1%9C%20%ED%91%9C%EC%8B%9C%ED%95%A9%EB%8B%88%EB%8B%A4.")},nl_nl:{hlenlarge:"Tekstvergroting",hlenlargeinfo:"Toont de zin die voorgelezen wordt in een apart venster onderaan de pagina, met een grotere lettergrootte en gelijktijdige tekstmarkering."},
nl_be:{hlenlarge:"Tekstvergroting",hlenlargeinfo:"Toont de zin die voorgelezen wordt in een apart venster onderaan de pagina, met een grotere lettergrootte en gelijktijdige tekstmarkering."},fy_nl:{hlenlarge:"Ferbettere sichtberheid fan de tekst",hlenlargeinfo:decodeURIComponent("Lit%20de%20sin%20dy%E2%80%99t%20jo%20op%20dit%20stuit%20l%C3%AAze%20%C3%BAtfergrutte%20sjen%20yn%20in%20aparte%20tekst%20%C3%BBnder%20oan%20de%20side.")},is_is:{hlenlarge:decodeURIComponent("Aukin%20texta%20st%C3%A6kkun"),
hlenlargeinfo:decodeURIComponent("S%C3%BDna%20einnig%20ne%C3%B0st%20%C3%A1%20s%C3%AD%C3%B0unni%20setninguna%20sem%20veri%C3%B0%20er%20a%C3%B0%20lesa%2C%20me%C3%B0%20st%C3%A6rra%20letri%20og%20upplitun%20me%C3%B0%20lestrinum.")},no_nb:{hlenlarge:decodeURIComponent("%C3%98kt%20tekstsynlighet"),hlenlargeinfo:decodeURIComponent("Viser%20setningen%20nederst%20p%C3%A5%20siden%2C%20med%20st%C3%B8rre%20skriftst%C3%B8rrelse%20og%20tekstmerking%20mens%20den%20leses%20opp")},no_nn:{hlenlarge:"Auka tekstsynlegheit",
hlenlargeinfo:decodeURIComponent("Setninga%20som%20vert%20lese%20visast%20nederst%20p%C3%A5%20sida%20i%20ein%20eigen%20tekstboks%20med%20forst%C3%B8rra%20skrift.")},pl_pl:{hlenlarge:decodeURIComponent("Widoczno%C5%9B%C4%87%20wyr%C3%B3%C5%BCnionego%20tekstu"),hlenlargeinfo:decodeURIComponent("Wy%C5%9Bwietlaj%20zdanie%2C%20kt%C3%B3re%20jest%20aktualnie%20czytane%20z%20powi%C4%99kszonym%20tekstem%20w%20osobnym%20polu%20na%20dole%20strony.")},pt_pt:{hlenlarge:"Melhorar a visibilidade",hlenlargeinfo:decodeURIComponent("A%20frase%20%C3%A9%20exibida%20numa%20caixa%2C%20na%20parte%20inferior%20da%20p%C3%A1gina%2C%20com%20um%20tamanho%20maior%20de%20fonte%20e%20o%20texto%20a%20ser%20destacado%20em%20simult%C3%A2neo%20com%20a%20leitura")},
pt_br:{hlenlarge:"Melhorar a visibilidade",hlenlargeinfo:decodeURIComponent("A%20frase%20%C3%A9%20exibida%20numa%20caixa%2C%20na%20parte%20inferior%20da%20p%C3%A1gina%2C%20com%20um%20tamanho%20maior%20de%20fonte%20e%20o%20texto%20a%20ser%20destacado%20em%20simult%C3%A2neo%20com%20a%20leitura")},ru_ru:{hlenlarge:decodeURIComponent("%D0%A3%D0%B2%D0%B5%D0%BB%D0%B8%D1%87%D0%B8%D1%82%D1%8C%20%D1%82%D0%B5%D0%BA%D1%81%D1%82"),hlenlargeinfo:decodeURIComponent("%D0%9F%D1%80%D0%BE%D0%B8%D0%B7%D0%BD%D0%BE%D1%81%D0%B8%D0%BC%D0%BE%D0%B5%20%D0%BF%D1%80%D0%B5%D0%B4%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5%20%D0%BF%D0%BE%D0%BA%D0%B0%D0%B7%D1%8B%D0%B2%D0%B0%D0%B5%D1%82%D1%81%D1%8F%20%D1%83%D0%B2%D0%B5%D0%BB%D0%B8%D1%87%D0%B5%D0%BD%D0%BD%D1%8B%D0%BC%20%D1%82%D0%B5%D0%BA%D1%81%D1%82%D0%BE%D0%BC%20%D0%B2%20%D0%BE%D1%82%D0%B4%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%D0%BC%20%D0%BE%D0%BA%D0%BD%D0%B5%20%D0%B2%20%D0%BD%D0%B8%D0%B6%D0%BD%D0%B5%D0%B9%20%D1%87%D0%B0%D1%81%D1%82%D0%B8%20%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D1%8B.")},
sv_se:{hlenlarge:decodeURIComponent("F%C3%B6rstorad%20text"),hlenlargeinfo:decodeURIComponent("Visar%20meningen%20som%20l%C3%A4ses%20l%C3%A4ngst%20ner%20p%C3%A5%20sidan%2C%20med%20st%C3%B6rre%20typsnitt%20och%20textmarkering.")},sv_fi:{hlenlarge:decodeURIComponent("F%C3%B6rstorad%20text"),hlenlargeinfo:decodeURIComponent("Visar%20meningen%20som%20l%C3%A4ses%20l%C3%A4ngst%20ner%20p%C3%A5%20sidan%2C%20med%20st%C3%B6rre%20typsnitt%20och%20textmarkering.")},tr_tr:{hlenlarge:decodeURIComponent("Geli%C5%9Fmi%C5%9F%20metin%20g%C3%B6r%C3%BCn%C3%BCrl%C3%BC%C4%9F%C3%BC"),
hlenlargeinfo:decodeURIComponent("Ge%C3%A7erli%20c%C3%BCmleyi%20sayfan%C4%B1n%20alt%C4%B1nda%20bir%20kutuda%20daha%20b%C3%BCy%C3%BCk%20yaz%C4%B1%20tipi%20boyutuyla%20ve%20e%C5%9Fzamanl%C4%B1%20metin%20vurgulama%20ile%20g%C3%B6r%C3%BCnt%C3%BCler.")},zh_cn:{hlenlarge:decodeURIComponent("%E5%A2%9E%E5%BC%BA%E6%96%87%E6%9C%AC%E5%8F%AF%E8%A7%81%E6%80%A7"),hlenlargeinfo:decodeURIComponent("%E5%9C%A8%E9%A1%B5%E9%9D%A2%E5%BA%95%E9%83%A8%E6%98%BE%E7%A4%BA%E5%BD%93%E5%89%8D%E5%8F%A5%E5%AD%90%EF%BC%8C%E5%8F%A5%E5%AD%90%E5%AD%97%E4%BD%93%E7%A8%8D%E5%A4%A7%E4%B8%94%E5%90%8C%E6%AD%A5%E7%AA%81%E5%87%BA%E6%98%BE%E7%A4%BA%E6%96%87%E6%9C%AC%E3%80%82")},
zh_hk:{hlenlarge:decodeURIComponent("%E6%8F%90%E9%AB%98%E6%96%87%E5%AD%97%E5%8F%AF%E8%A6%96%E5%BA%A6"),hlenlargeinfo:decodeURIComponent("%E8%AB%8B%E5%9C%A8%E9%A0%81%E9%9D%A2%E5%BA%95%E9%83%A8%E6%96%B9%E6%A1%86%E4%B8%AD%E9%A1%AF%E7%A4%BA%E7%95%B6%E5%89%8D%E5%8F%A5%E5%AD%90%EF%BC%8C%E6%96%87%E5%AD%97%E5%B0%87%E4%BB%A5%E5%A4%A7%E8%99%9F%E5%AD%97%E9%AB%94%E4%BB%A5%E5%8F%8A%E5%90%8C%E6%AD%A5%E6%96%87%E5%AD%97%E7%AA%81%E5%87%BA%E9%A1%AF%E7%A4%BA%E3%80%82")}};ReadSpeaker.cfg.extendPhrases(a);rs.st.get("enlarge")||
ReadSpeaker.cfg.item("settings.enlarge","enlargeoff");rs.cfg.defaultsettings&&(rs.cfg.defaultsettings.enlarge="enlargeoff")});
